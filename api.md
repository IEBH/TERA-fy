<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

*   [ProjectFile][1]
    *   [id][2]
    *   [sbId][3]
    *   [name][4]
    *   [icon][5]
    *   [path][6]
    *   [url][7]
    *   [teraUrl][8]
    *   [parsedName][9]
        *   [Properties][10]
    *   [created][11]
    *   [createdFormatted][12]
    *   [modified][13]
    *   [modifiedFormatted][14]
    *   [accessed][15]
    *   [accessedFormatted][16]
    *   [size][17]
    *   [sizeFormatted][18]
    *   [mime][19]
    *   [meta][20]
    *   [isFolder][21]
    *   [files][22]
    *   [getContents][23]
        *   [Parameters][24]
    *   [setContents][25]
        *   [Parameters][26]
    *   [getRefs][27]
    *   [setRefs][28]
        *   [Parameters][29]
    *   [serialize][30]
    *   [deserialize][31]
        *   [Parameters][32]
*   [TeraFy][33]
    *   [settings][34]
        *   [Properties][35]
    *   [events][36]
    *   [dom][37]
        *   [Properties][38]
    *   [methods][39]
    *   [plugins][40]
    *   [namespaces][41]
    *   [send][42]
        *   [Parameters][43]
    *   [sendRaw][44]
        *   [Parameters][45]
    *   [rpc][46]
        *   [Parameters][47]
    *   [acceptMessage][48]
        *   [Parameters][49]
    *   [acceptPostboxes][50]
    *   [init][51]
        *   [Parameters][52]
    *   [detectMode][53]
    *   [injectComms][54]
    *   [handshakeLoop][55]
        *   [Parameters][56]
        *   [Properties][57]
    *   [injectStylesheet][58]
    *   [injectMethods][59]
    *   [debug][60]
        *   [Parameters][61]
    *   [set][62]
        *   [Parameters][63]
    *   [setIfDev][64]
        *   [Parameters][65]
    *   [use][66]
        *   [Parameters][67]
    *   [mixin][68]
        *   [Parameters][69]
    *   [toggleDevMode][70]
        *   [Parameters][71]
    *   [toggleFocus][72]
        *   [Parameters][73]
    *   [getEntropicString][74]
        *   [Parameters][75]
    *   [selectProjectFile][76]
        *   [Parameters][77]
*   [mountNamespace][78]
    *   [Parameters][79]
*   [Actual namespace mounting function designed to be overriden by plugins][80]
    *   [Parameters][81]
*   [unmountNamespace][82]
    *   [Parameters][83]
*   [Actual namespace unmounting function designed to be overriden by plugins][84]
    *   [Parameters][85]
*   [handshake][86]
    *   [Properties][87]
*   [setServerVerbosity][88]
    *   [Parameters][89]
*   [User][90]
    *   [Properties][91]
*   [getUser][92]
*   [getCredentials][93]
*   [requireUser][94]
    *   [Parameters][95]
*   [Project][96]
*   [getProject][97]
*   [getProjects][98]
*   [setActiveProject][99]
    *   [Parameters][100]
*   [requireProject][101]
    *   [Parameters][102]
*   [selectProject][103]
    *   [Parameters][104]
*   [getNamespace][105]
    *   [Parameters][106]
*   [setNamespace][107]
    *   [Parameters][108]
*   [listNamespaces][109]
    *   [Properties][110]
*   [getProjectState][111]
    *   [Parameters][112]
*   [setProjectState][113]
    *   [Parameters][114]
*   [setProjectStateDefaults][115]
    *   [Parameters][116]
*   [setProjectStateRefresh][117]
*   [FileFilters][118]
    *   [Properties][119]
*   [selectProjectFile][120]
    *   [Parameters][121]
*   [getProjectFiles][122]
    *   [Parameters][123]
*   [getProjectFileContents][124]
    *   [Parameters][125]
*   [getProjectFile][126]
    *   [Parameters][127]
*   [createProjectFile][128]
    *   [Parameters][129]
*   [moveProjectFile][130]
    *   [Parameters][131]
*   [deleteProjectFile][132]
    *   [Parameters][133]
*   [setProjectFileContents][134]
    *   [Parameters][135]
*   [createProjectFolder][136]
    *   [Parameters][137]
*   [deleteProjectFolder][138]
    *   [Parameters][139]
*   [selectProjectLibrary][140]
    *   [Parameters][141]
*   [getProjectLibrary][142]
    *   [Parameters][143]
*   [setProjectLibrary][144]
    *   [Parameters][145]
*   [projectLog][146]
    *   [Parameters][147]
*   [setPage][148]
    *   [Parameters][149]
*   [uiAlert][150]
    *   [Parameters][151]
*   [uiConfirm][152]
    *   [Parameters][153]
*   [uiPanic][154]
    *   [Parameters][155]
*   [uiProgress][156]
    *   [Parameters][157]
*   [uiPrompt][158]
    *   [Parameters][159]
*   [uiThrow][160]
    *   [Parameters][161]
*   [uiWindow][162]
    *   [Parameters][163]
*   [uiSplat][164]
    *   [Parameters][165]

## ProjectFile

A project file fetched from TERA

### id

The TERA compatible unique ID of the file
NOTE: This is computed each time from the Base64 of the file path

Type: [String][166]

### sbId

The raw Supabase UUID of the file

Type: [String][166]

### name

Relative name path (can contain prefix directories) for the human readable file name

Type: [String][166]

### icon

CSS class to use as the file icon

Type: [String][166]

### path

Full path to the file
This is also used as the unique identifier within the project

Type: [String][166]

### url

Fully qualified URL to view / access / download the file from TERA
This will usually open an edit UI within the TERA site

Type: [String][166]

### teraUrl

Rewrite of the URL where the absolute URL has been removed in place of a relative path, assuming the owner project is active
This is used to direct to the edit/view/download UI when the files project is active and is usually used in place of URL for TERA related operations

Type: [String][166]

### parsedName

An object representing meta file parts of a file name

Type: [Object][167]

#### Properties

*   `basename` **[String][166]** The filename + extention (i.e. everything without directory name)
*   `filename` **[String][166]** The file portion of the name (basename without the extension)
*   `ext` **[String][166]** The extension portion of the name (always lower case)
*   `dirName` **[String][166]** The directory path portion of the name

### created

A date representing when the file was created

Type: [Date][168]

### createdFormatted

A human readable, formatted version of "created"

Type: [String][166]

### modified

A date representing when the file was created

Type: [Date][168]

### modifiedFormatted

A human readable, formatted version of "modified"

Type: [String][166]

### accessed

A date representing when the file was last accessed

Type: [Date][168]

### accessedFormatted

A human readable, formatted version of "accessed"

Type: [String][166]

### size

Size, in bytes, of the file

Type: [Number][169]

### sizeFormatted

A human readable, formatted version of the file size

Type: [String][166]

### mime

The associated mime type for the file

Type: [String][166]

### meta

Additional meta information for the file

Type: [Object][167]

### isFolder

Whether this is a folder or not

Type: [boolean][170]

### files

If it is a folder, it will have an array of files in the folder

Type: [Array][171]<[ProjectFile][1]>

### getContents

*   **See**: getProjectFile()

Fetch the raw file contents as a Blob

#### Parameters

*   `options` **[Object][167]?** Additioanl options to mutate behaviour

Returns **[Promise][172]<[Blob][173]>** The eventual raw file contents as a Blob

### setContents

*   **See**: setProjectFileContents()

Overwrite the contents of a file with new content

#### Parameters

*   `contents` **(File | [Blob][173] | [FormData][174] | [Object][167] | [Array][171])** The new file contents

Returns **[Promise][172]\<void>** A promise which resolves when the operation has completed

### getRefs

*   **See**: getProjectLibrary()

Fetch the file contents as an array of Reflib refs

Returns **[Promise][172]<[Array][171]\<RefLibRef>>** An eventual array of RefLib references

### setRefs

*   **See**: setProjectLibrary()

Overwrite the contents of a file with a new collection of Reflib refs

#### Parameters

*   `refs` **[Array][171]\<RefLibRef>** Collection of references for the selected library

Returns **[Promise][172]\<void>** A promise which resolves when the operation has completed

### serialize

*   **See**: [https://developer.mozilla.org/en-US/docs/Web/API/Web\_Workers\_API/Structured\_clone\_algorithm][175]

Compress a file state down into a serializable entity
By default this computes a Structured Clone which can be stringified

Returns **[Object][167]** A Structured Clone compatible representation of this ProjectFile instance

### deserialize

Restore an entity created with serialize
NOTE: This requires the 'tera' instance to be manually added to the 'data' object before calling deserialize,
as it's not included in the serialized output.

#### Parameters

*   `data` **[Object][167]** An input object created via `ProjectFiles.serialize()` (MUST include a 'tera' property added manually)

Returns **[ProjectFile][1]** A ProjectFile instance setup against the deserializzed data

## TeraFy

Main Tera-Fy Client (class singleton) to be used in a frontend browser

### settings

Various settings to configure behaviour

Type: [Object][167]

#### Properties

*   `session` **[String][166]** Unique session signature for this instance of TeraFy, used to sign server messages, if falsy `getEntropicString(16)` is used to populate
*   `devMode` **[Boolean][170]** Operate in Dev-Mode - i.e. force outer refresh when encountering an existing TeraFy instance + be more tolerent of weird iframe origins
*   `verbosity` **[Number][169]** Verbosity level, the higher the more chatty TeraFY will be. Set to zero to disable all `debug()` call output
*   `mode` **(`"detect"` | `"parent"` | `"child"` | `"popup"`)** How to communicate with TERA. 'parent' assumes that the parent of the current document is TERA, 'child' spawns an iFrame and uses TERA there, 'detect' tries parent and switches to `modeFallback` if communication fails
*   `modeFallback` **[String][166]** Method to use when all method detection fails
*   `modeOverrides` **[Object][167]<[Object][167]<[Function][176]>>** Functions to run when switching to specific modes, these are typically used to augment config. Called as `(config:Object)`
*   `modeTimeout` **[Number][169]** How long entities have in 'detect' mode to identify themselves
*   `siteUrl` **[String][166]** The TERA URL to connect to
*   `restrictOrigin` **[String][166]** URL to restrict communications to
*   `List` **[Array][171]<[String][166]>** of sandbox allowables for the embedded if in embed mode
*   `handshakeInterval` **[Number][169]** Interval in milliseconds when sanning for a handshake
*   `handshakeTimeout` **[Number][169]** Interval in milliseconds for when to give up trying to handshake
*   `debugPaths` **[Array][171]<([String][166] | [Array][171]<[String][166]>)>?** List of paths (in either dotted or array notation) to enter debugging mode if a change is detected in dev mode e.g. `{debugPaths: ['foo.bar.baz']}`. This really slows down state writes so should only be used for debugging

### events

Event emitter subscription endpoint

Type: Mitt

### dom

DOMElements for this TeraFy instance

Type: [Object][167]

#### Properties

*   `el` **DOMElement** The main tera-fy div wrapper
*   `iframe` **DOMElement** The internal iFrame element  (if `settings.mode == 'child'`)
*   `popup` **[Window][177]** The popup window context (if `settings.mode == 'popup'`)
*   `stylesheet` **DOMElement** The corresponding stylesheet

### methods

List of function stubs mapped from the server to here
This array is forms the reference of `TeraFy.METHOD()` objects to provide locally which will be mapped via `TeraFy.rpc(METHOD, ...args)`

Type: [Array][171]<[String][166]>

### plugins

Loaded plugins via Use()

Type: [Array][171]\<TeraFyPlugin>

### namespaces

Active namespaces we are subscribed to
Each key is the namespace name with the value as the local reactive \ observer \ object equivelent
The key string is always of the form `${ENTITY}::${ID}` e.g. `projects:1234`

Type: [Object][167]<[Object][167]>

### send

Send a message + wait for a response object

#### Parameters

*   `message` **[Object][167]** Message object to send

Returns **[Promise][172]\<any>** A promise which resolves when the operation has completed with the remote reply

### sendRaw

Send raw message content to the server
This function does not return or wait for a reply - use `send()` for that

#### Parameters

*   `message` **[Object][167]** Message object to send

### rpc

Call an RPC function in the server instance

#### Parameters

*   `method` **[String][166]** The method name to call
*   `args` **...any?** Optional arguments to pass to the function

Returns **[Promise][172]\<any>** The resolved output of the server function

### acceptMessage

Accept an incoming message

#### Parameters

*   `rawMessage` **[MessageEvent][178]** Raw message event to process

Returns **[Promise][172]** A promise which will resolve when the message has been processed

### acceptPostboxes

Listening postboxes, these correspond to outgoing message IDs that expect a response

### init

Initalize the TERA client singleton
This function can only be called once and will return the existing init() worker Promise if its called againt

#### Parameters

*   `options` **[Object][167]?** Additional options to merge into `settings` via `set`

Returns **[Promise][172]<[TeraFy][33]>** An eventual promise which will resovle with this terafy instance

### detectMode

Populate `settings.mode`
Try to communicate with a parent frame, if none assume we need to fallback to child mode

Returns **[Promise][172]<[String][166]>** A promise which will resolve with the detected mode to use

### injectComms

Find an existing active TERA server OR initalize one

Returns **[Promise][172]** A promise which will resolve when the loading has completed and we have found a parent TERA instance or initiallized a child

### handshakeLoop

Keep trying to handshake until the target responds

#### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

#### Properties

*   `handshakeInterval` **[Number][169]?** Interval in milliseconds when sanning for a handshake, defaults to global setting
*   `handshakeTimeout` **[Number][169]?** Interval in milliseconds for when to give up trying to handshake, defaults to global setting

Returns **[Promise][172]** A promise which will either resolve when the handshake is successful OR fail with 'TIMEOUT'

### injectStylesheet

Inject a local stylesheet to handle TERA server functionality

Returns **[Promise][172]** A promise which will resolve when the loading has completed and we have found a parent TERA instance or initiallized a child

### injectMethods

Inject all server methods defined in `methods` as local functions wrapped in the `rpc` function

### debug

Debugging output function
This function will only act if `settings.devMode` is truthy

#### Parameters

*   `msg` **...any?** Output to show
*   `method` **(`"INFO"` | `"LOG"` | `"WARN"` | `"ERROR"`)** Logging method to use (optional, default `'LOG'`)
*   `verboseLevel` **[Number][169]** The verbosity level to trigger at. If `settings.verbosity` is lower than this, the message is ignored (optional, default `1`)

### set

Set or merge settings
This function also routes 'special' keys like `devMode` to their internal handlers

#### Parameters

*   `key` **([String][166] | [Object][167])** Either a single setting key to set or an object to merge
*   `value` **any** The value to set if `key` is a string
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.ignoreNullish` **[Boolean][170]** If falsy, this forces the setting of undefined or null values rather than ignoring them when specifying values by string (optional, default `true`)

Returns **[TeraFy][33]** This chainable terafy instance

### setIfDev

*   **See**: set()

Set or merge settings - but only in dev mode and only if the value is not undefined

#### Parameters

*   `key` **([String][166] | [Object][167])** Either a single setting key to set or an object to merge
*   `value` **any** The value to set if `key` is a string
*   `options` **[Object][167]?** Additional options to mutate behaviour

Returns **[TeraFy][33]** This chainable terafy instance

### use

Include a TeraFy client plugin

#### Parameters

*   `source` **([Function][176] | [Object][167] | [String][166])** Either the JS module class, singleton object or URL to fetch it from. Eventually constructed as invoked as `(teraClient:TeraFy, options:Object)`
*   `options` **[Object][167]?** Additional options to mutate behaviour during construction (pass options to init() to intialize later options)

Returns **[TeraFy][33]** This chainable terafy instance

### mixin

Internal function used by use() to merge an external declared singleton against this object

#### Parameters

*   `target` **[Object][167]** Initalied class instance to extend
*   `source` **[Object][167]** Initalized source object to extend from

### toggleDevMode

Set or toggle devMode
This function also accepts meta values:

    'toggle' - Set dev mode to whatever the opposing value of the current mode
    'proxy'  - Optimize for using a loopback proxy

#### Parameters

*   `devModeEnabled` **(`"toggle"` | `"proxy"` | [Boolean][170])** Optional boolean to force dev mode or specify other behaviour (optional, default `'toggle'`)

Returns **[TeraFy][33]** This chainable terafy instance

### toggleFocus

Fit the nested TERA server to a full-screen
This is usually because the server component wants to perform some user activity like calling $prompt

#### Parameters

*   `isFocused` **([String][166] | [Boolean][170])** Whether to fullscreen the embedded component (optional, default `'toggle'`)

### getEntropicString

Generate random entropic character string in Base64

#### Parameters

*   `maxLength` **[Number][169]** Maximum lengh of the genrated string (optional, default `32`)

Returns **[String][166]**&#x20;

### selectProjectFile

Require a user login to TERA
If there is no user OR they are not logged in a prompt is shown to go and do so
This is an pre-requisite step for requireProject()

#### Parameters

*   `options` **any?**&#x20;

Returns **[Promise][172]** A promise which will resolve if the there is a user and they are logged in

## mountNamespace

Make a namespace available locally
This generally creates whatever framework flavoured reactive/observer/object is supported locally - generally with writes automatically synced with the master state

### Parameters

*   `name` **[String][166]** The alias of the namespace, this should be alphanumeric + hyphens + underscores

Returns **[Promise][172]\<Reactive>** A promise which resolves to the reactive object

## Actual namespace mounting function designed to be overriden by plugins

### Parameters

*   `name` **[String][166]** The alias of the namespace, this should be alphanumeric + hyphens + underscores

Returns **[Promise][172]** A promise which resolves when the mount operation has completed

## unmountNamespace

Release a locally mounted namespace
This function will remove the namespace from `namespaces`, cleaning up any memory / subscription hooks

### Parameters

*   `name` **[String][166]** The name of the namespace to unmount

Returns **[Promise][172]** A promise which resolves when the operation has completed

## Actual namespace unmounting function designed to be overriden by plugins

### Parameters

*   `name` **[String][166]** The name of the namespace to unmount

Returns **[Promise][172]** A promise which resolves when the operation has completed

## handshake

Return basic server information as a form of validation

### Properties

*   `date` **[Date][168]** Server date

Returns **[Promise][172]<[Object][167]>** Basic promise result

## setServerVerbosity

RPC callback to set the server verbostiy level

### Parameters

*   `verbosity` **[Number][169]** The desired server verbosity level

## User

User / active session within TERA

### Properties

*   `id` **[String][166]** Unique identifier of the user
*   `email` **[String][166]** The email address of the current user
*   `name` **[String][166]** The provided full name of the user
*   `isSubscribed` **[Boolean][170]** Whether the active user has a TERA subscription

## getUser

Fetch the current session user

Returns **[Promise][172]<[User][90]>** The current logged in user or null if none

## getCredentials

Provide an object of credentials for 3rd party services like Firebase/Supabase

Returns **[Object][167]** An object containing 3rd party service credentials

## requireUser

Require a user login to TERA
If there is no user OR they are not logged in a prompt is shown to go and do so
This is an pre-requisite step for requireProject()

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.forceRetry` **[Boolean][170]** Forcabily try to refresh the user state (optional, default `false`)

Returns **[Promise][172]<[User][90]>** The current logged in user or null if none

## Project

Project entry within TERA

## getProject

Get the currently active project, if any

Returns **[Promise][172]<([Project][96] | null)>** The currently active project, if any

## getProjects

Get a list of projects the current session user has access to

Returns **[Promise][172]<[Array][171]<[Project][96]>>** Collection of projects the user has access to

## setActiveProject

Set the currently active project within TERA

### Parameters

*   `project` **([Object][167] | [String][166])** The project to set as active - either the full Project object or its ID

## requireProject

Ask the user to select a project from those available - if one isn't already active
Note that this function will percist in asking the uesr even if they try to cancel

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.autoSetActiveProject` **[Boolean][170]** After selecting a project set that project as active in TERA (optional, default `true`)
    *   `options.title` **[String][166]** The title of the dialog to display (optional, default `"Select a project to work with"`)
    *   `options.noSelectTitle` **[String][166]** Dialog title when warning the user they need to select something (optional, default `'Select project'`)
    *   `options.noSelectBody` **[String][166]** Dialog body when warning the user they need to select something (optional, default `'A project needs to be selected to continue'`)

Returns **[Promise][172]<[Project][96]>** The active project

## selectProject

Prompt the user to select a project from those available

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.title` **[String][166]** The title of the dialog to display (optional, default `"Select a project to work with"`)
    *   `options.allowCancel` **[Boolean][170]** Advertise cancelling the operation, the dialog can still be cancelled by closing it (optional, default `true`)
    *   `options.setActive` **[Boolean][170]** Also set the project as active when selected (optional, default `false`)

Returns **[Promise][172]<[Project][96]>** The active project

## getNamespace

Get a one-off snapshot of a namespace without mounting it
This can be used for simpler apps which don't have their own reactive / observer equivelent

### Parameters

*   `name` **[String][166]** The alias of the namespace, this should be alphanumeric + hyphens + underscores

Returns **[Promise][172]<[Object][167]>** A promise which resolves to the namespace POJO state

## setNamespace

Set (or merge by default) a one-off snapshot over an existing namespace
This can be used for simpler apps which don't have their own reactive / observer equivelent and just want to quickly set something

### Parameters

*   `name` **[String][166]** The name of the namespace
*   `state` **[Object][167]** The state to merge
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.method` **(`"merge"` | `"set"`)** How to handle the state. 'merge' (merge a partial state over the existing namespace state), 'set' (completely overwrite the existing namespace) (optional, default `'merge'`)

Returns **[Promise][172]<[Object][167]>** A promise which resolves to the namespace POJO state

## listNamespaces

Return a list of namespaces available to the current project

### Properties

*   `name` **[String][166]** The name of the namespace

Returns **[Promise][172]<[Array][171]<[Object][167]>>** Collection of available namespaces for the current project

## getProjectState

Return the current, full snapshot state of the active project

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
*   `Paths` **[Array][171]<[String][166]>** to subscribe to e.g. \['/users/'],

Returns **[Promise][172]<[Object][167]>** The current project state snapshot

## setProjectState

Set a nested value within the project state
Paths can be any valid Lodash.set() value such as:

    - Dotted notation - e.g. `foo.bar.1.baz`
    - Array path segments e.g. `['foo', 'bar', 1, 'baz']`

### Parameters

*   `path` **([String][166] | [Array][171]<[String][166]>)** The sub-path within the project state to set
*   `value` **any** The value to set
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.save` **[Boolean][170]** Save the changes to the server immediately, disable to queue up multiple writes (optional, default `true`)

Returns **[Promise][172]** A promise which resolves when the operation has been dispatched to the server

## setProjectStateDefaults

*   **See**: setProjectState()

Set a nested value within the project state - just like `setProjectState()` - but only if no value for that path exists

### Parameters

*   `path` **([String][166] | [Array][171]<[String][166]>)** The sub-path within the project state to set
*   `value` **any** The value to set
*   `options` **[Object][167]?** Additional options to mutate behaviour, see setProjectState() for the full list of supported options

Returns **[Promise][172]<[Boolean][170]>** A promise which resolves to whether any changes were made - True if defaults were applied, false otherwise

## setProjectStateRefresh

Force refetching the remote project state into local
This is only ever needed when saving large quantities of data that need to be immediately available

Returns **[Promise][172]** A promise which resolves when the operation has completed

## FileFilters

Data structure for a file filter

### Properties

*   `library` **[Boolean][170]?** Restrict to library files only
*   `filename` **[String][166]?** CSV of @momsfriendlydevco/match expressions to filter the filename by (filenames are the basename sans extension)
*   `basename` **[String][166]?** CSV of @momsfriendlydevco/match expressions to filter the basename by
*   `ext` **[String][166]?** CSV of @momsfriendlydevco/match expressions to filter the file extension by

## selectProjectFile

Prompt the user to select a library to operate on

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.title` **[String][166]** The title of the dialog to display (optional, default `"Select a file"`)
    *   `options.hint` **([String][166] | [Array][171]<[String][166]>)?** Hints to identify the file to select in array order of preference
    *   `options.save` **[Boolean][170]** Set to truthy if saving a new file, UI will adjust to allowing overwrite OR new file name input (optional, default `false`)
    *   `options.saveFilename` **[String][166]?** File name to save as, if omitted the hinting system is used otherwise 'My File.unknown' is assumed
    *   `options.filters` **[FileFilters][118]?** Optional file filters
    *   `options.allowUpload` **[Boolean][170]** Allow uploading new files (optional, default `true`)
    *   `options.allowRefresh` **[Boolean][170]** Allow the user to manually refresh the file list (optional, default `true`)
    *   `options.allowDownloadZip` **[Boolean][170]** Allow the user to download a Zip of all files (optional, default `true`)
    *   `options.allowCancel` **[Boolean][170]** Allow cancelling the operation. Will throw `'CANCEL'` as the promise rejection if acationed (optional, default `true`)
    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.showHiddenFiles` **[Boolean][170]** Whether hidden data.json files should be shown (optional, default `false`)
    *   `options.filter` **[FileFilters][118]?** Optional file filters

Returns **[Promise][172]<[ProjectFile][1]>** The eventually selected file, if in save mode new files are created as stubs

## getProjectFiles

Fetch the files associated with a given project

### Parameters

*   `options` **[Object][167]** Options which mutate behaviour

    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.lazy` **[Boolean][170]** If true, use the fastest method to retrieve the file list such as the cache. If false, force a refresh each time (optional, default `true`)
    *   `options.meta` **[Boolean][170]** Pull meta information for each file entity (optional, default `true`)

Returns **[Promise][172]<[Array][171]<[ProjectFile][1]>>** A collection of project files for the given project

## getProjectFileContents

Fetch the raw contents of a file by its ID

### Parameters

*   `id` **[String][166]?** File ID to retrieve the contents of
*   `options` **[Object][167]?** Additioanl options to mutate behaviour

    *   `options.format` **(`"blob"` | `"json"`)** The format to retrieve the file in (optional, default `'blob'`)

Returns **any** The file contents in the requested format

## getProjectFile

Fetch a project file by its name

### Parameters

*   `id` **[String][166]** The name + relative directory path component
*   `options` **([Object][167] | [String][166])?** Additional options to mutate behaviour, if a string is given `options.subkey` is assumed

    *   `options.subkey` **[String][166]?** If specified only the extracted subkey is returned rather than the full object
    *   `options.cache` **[Boolean][170]** Use the existing file cache if possible, set to false to force a refresh of files from the server first (optional, default `true`)

Returns **[Promise][172]<[ProjectFile][1]>** The eventual fetched ProjectFile (or requested subkey)

## createProjectFile

Create a new file
This creates an empty file which can then be written to

### Parameters

*   `name` **[String][166]** The name + relative directory path component

Returns **[Promise][172]<[ProjectFile][1]>** The eventual ProjectFile created

## moveProjectFile

Moves a project file to a new name/path.
The file's unique ID (UUID) remains the same, but its 'name' (relative path) and associated properties will be updated.

### Parameters

*   `sourceId` **[String][166]** The unique ID (UUID) of the file to move.
*   `newName` **[String][166]** The new relative name for the file (e.g., "documents/report-final.pdf" or "image.png").
    This path is relative to the project's root file directory.
*   `options` **[Object][167]?** Additional options to mutate behaviour.

    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing. (optional, default `true`)
    *   `options.overwrite` **[Boolean][170]** If true (default), moving a file to a `newName` that already exists will overwrite the existing file.
        This aligns with the default behavior of the underlying Supabase storage `move` operation.
        If set to false, the function would ideally check and prevent overwrite, but current implementation relies on underlying storage behavior. (optional, default `true`)

Returns **[Promise][172]<([ProjectFile][1] | null)>** A promise which resolves to the updated ProjectFile object for the moved file if found after the operation,
or null if the file could not be located post-move (e.g., if its ID changed unexpectedly or it was deleted).

## deleteProjectFile

Remove a project file by its ID

### Parameters

*   `id` **[String][166]** The File ID to remove

Returns **[Promise][172]** A promise which resolves when the operation has completed

## setProjectFileContents

Save (or overwrite) a file within a project

### Parameters

*   `id` **([String][166] | [ProjectFile][1])?** ProjectFile or ID of the same to overwrite, if omitted a file is prompted for
*   `contents` **(File | [Blob][173] | [FormData][174] | [Object][167] | [Array][171])** The new file contents
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.id` **([String][166] | [ProjectFile][1])?** Alternate method to specify the file ID to save as, if omitted one will be prompted for
    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.hint` **([String][166] | [Array][171]<[String][166]>)?** Hint(s) to store against the library. Generally corresponds to the current operation being performed - e.g. 'deduped'
    *   `options.filename` **[String][166]?** Suggested filename if `id` is unspecified
    *   `options.title` **[String][166]** Dialog title if `id` is unspecified and a prompt is necessary (optional, default `'Save citation library'`)
    *   `options.meta` **[Object][167]?** Optional meta data to merge into the file data

Returns **[Promise][172]** A promise which will resolve when the write operation has completed

## createProjectFolder

Creates a new "folder" within the project's file storage.
Folders in Supabase storage are typically represented by creating a placeholder file (e.g., .emptyFolderPlaceholder) within the desired path.
This operation is idempotent: if the folder (via its placeholder) already exists, it will not error.

### Parameters

*   `folderPath` **[String][166]** The relative path of the folder to create (e.g., "myDocuments/reports").
*   `options` **[Object][167]?** Additional options.

    *   `options.autoRequire` **[Boolean][170]** Automatically run `requireProject()` to ensure an active project context. (optional, default `true`)

<!---->

*   Throws **[Error][179]** If no project is active (and autoRequire is false), or if folderPath is invalid, or if the creation fails.

Returns **[Promise][172]\<void>** A promise that resolves when the folder is created or ensured.

## deleteProjectFolder

Deletes a "folder" and all its contents from the project's file storage.
This involves listing all files under the given folder path (prefix) and removing them.

### Parameters

*   `folderPath` **[String][166]** The relative path of the folder to delete (e.g., "myDocuments/reports").
*   `options` **[Object][167]?** Additional options.

    *   `options.autoRequire` **[Boolean][170]** Automatically run `requireProject()` to ensure an active project context. (optional, default `true`)

<!---->

*   Throws **[Error][179]** If no project is active (and autoRequire is false), or if folderPath is invalid, or if deletion fails.

Returns **[Promise][172]\<null>** A promise that resolves with null when the folder and its contents are deleted.

## selectProjectLibrary

Prompt the user to select a library to operate on and return a array of references in a given format

### Parameters

*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.title` **[String][166]** The title of the dialog to display (optional, default `"Select a citation library"`)
    *   `options.hint` **([String][166] | [Array][171]<[String][166]>)?** Hints to identify the library to select in array order of preference. Generally corresponds to the previous stage - e.g. 'deduped', 'review1', 'review2', 'dedisputed'
    *   `options.allowUpload` **[Boolean][170]** Allow uploading new files (optional, default `true`)
    *   `options.allowRefresh` **[Boolean][170]** Allow the user to manually refresh the file list (optional, default `true`)
    *   `options.allowDownloadZip` **[Boolean][170]** Allow the user to download a Zip of all files (optional, default `true`)
    *   `options.allowCancel` **[Boolean][170]** Allow cancelling the operation. Will throw `'CANCEL'` as the promise rejection if acationed (optional, default `true`)
    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.filters` **[FileFilters][118]?** Optional file filters, defaults to citation library selection only
*   `options` **...any?** Additional options - see `getProjectLibrary()`

Returns **[Promise][172]<[Array][171]\<Ref>>** A collection of references from the selected file

## getProjectLibrary

Fetch + convert a project file into a library of citations

### Parameters

*   `id` **[String][166]** File ID to read
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.format` **[String][166]** Format for the file. ENUM: 'pojo' (return a parsed JS collection), 'blob' (raw JS Blob object), 'file' (named JS File object) (optional, default `'json'`)
    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.filter` **[Function][176]?** Optional async file filter, called each time as `(File:ProjectFile)`
    *   `options.find` **[Function][176]?** Optional async final stage file filter to reduce all candidates down to one subject file

Returns **([Promise][172]<[Array][171]\<Ref>> | [Promise][172]\<any>)** A collection of references (default bevahiour) or a whatever format was requested

## setProjectLibrary

Save back a citation library from some input

### Parameters

*   `id` **[String][166]?** File ID to save back to, if omitted a file will be prompted for
*   `refs` **([Array][171]\<RefLibRef> | [Blob][173] | File)?** Collection of references for the selected library or the raw Blob/File
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.id` **[String][166]?** Alternate method to specify the file ID to save as, if omitted one will be prompted for
    *   `options.refs` **([Array][171]\<RefLibRef> | [Blob][173] | File)?** Alternate method to specify the refs to save as an array or raw Blob/File
    *   `options.format` **[String][166]** Input format used. ENUM: 'pojo' (return a parsed JS collection), 'blob' (raw JS Blob object), 'file' (named JS File object) (optional, default `'json'`)
    *   `options.autoRequire` **[Boolean][170]** Run `requireProject()` automatically before continuing (optional, default `true`)
    *   `options.hint` **[String][166]?** Hint to store against the library. Generally corresponds to the current operation being performed - e.g. 'deduped'
    *   `options.filename` **[String][166]?** Suggested filename if `id` is unspecified
    *   `options.title` **[String][166]** Dialog title if `id` is unspecified and a prompt is necessary (optional, default `'Save citation library'`)
    *   `options.overwrite` **[Boolean][170]** Allow existing file upsert (optional, default `true`)
    *   `options.meta` **[Object][167]?** Optional meta data to merge into the file data

Returns **[Promise][172]** A promise which resolves when the save operation has completed

## projectLog

Create a log entry for the currently active project

The required log object can be of various forms. See [https://tera-tools.com/api/logs.json][180] for the full list

### Parameters

*   `log` **[Object][167]** The log entry to create

Returns **[Promise][172]** A promise which resolves when the operation has completed

## setPage

Set the active page title
This is usually called by a tool nested within the tera-tools.com embed

### Parameters

*   `options` **([Object][167] | [String][166])** Context information about the page, if this is a string, its assumed to popupate `url`

    *   `options.path` **[String][166]?** The URL path segment to restore on next refresh
    *   `options.title` **[String][166]?** The page title associated with the path

## uiAlert

Display simple text within TERA

### Parameters

*   `text` **[String][166]?** Text to display, if specified this populates `options.body`
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.body` **[String][166]** The body text to display (optional, default `"Alert!"`)
    *   `options.isHtml` **[Boolean][170]** If falsy the text is rendered as plain-text otherwise it will be assumed as HTML content (optional, default `false`)
    *   `options.title` **[String][166]** The title of the alert box (optional, default `'TERA'`)
    *   `options.buttons` **(`"ok"` | `false`)** Button set to use or falsy to disable (optional, default `'ok'`)

Returns **[Promise][172]** A promise which resolves when the alert has been dismissed

## uiConfirm

Present a simple ok/cancel dialog to the user

### Parameters

*   `text` **[String][166]?** Text to display, if specified this populates `options.body`
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.body` **[String][166]** The body text to display (optional, default `"Confirm?"`)
    *   `options.isHtml` **[Boolean][170]** If falsy the text is rendered as plain-text otherwise it will be assumed as HTML content (optional, default `false`)
    *   `options.title` **[String][166]** The title of the confirmation box (optional, default `'TERA'`)

Returns **[Promise][172]** A promise which resolves with `Promise.resolve('OK')` or rejects with `Promise.reject('CANCEL')`

## uiPanic

Trigger a fatal error, killing the outer TERA site

### Parameters

*   `text` **[String][166]?** Text to display

## uiProgress

Display, update or dispose of windows for long running tasks
All options are cumulative - i.e. they are merged with other options previously provided

### Parameters

*   `options` **([Object][167] | [Boolean][170])?** Additional options to mutate behaviour, if boolean false `{close: true}` is assumed

    *   `options.title` **[String][166]** Window title, can only be set on the initial call (optional, default `'TERA'`)
    *   `options.backdrop` **[String][166]** Set to `'static'` to prevent user being able to click outside the modal to close (optional, default `true`)
    *   `options.body` **[String][166]** Window body text, can only be set on the initial call (optional, default `''`)
    *   `options.bodyHtml` **[Boolean][170]** Treat body text as HTML (optional, default `false`)
    *   `options.close` **[Boolean][170]** Close the existing dialog, if true the dialog is disposed and options reset (optional, default `false`)
    *   `options.text` **[String][166]?** The text of the task being conducted
    *   `options.progress` **[Number][169]?** The current progress of the task being conducted, this is assumed to be a value less than `maxProgress`
    *   `options.maxProgress` **[Number][169]?** The maximum value that the progress can be

Returns **[Promise][172]** A promise which resolves when the dialog has been updated

## uiPrompt

Prompt the user for an input, responding with a Promisable value

### Parameters

*   `text` **[String][166]?** Text to display, if specified this populates `options.body`
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.body` **[String][166]?** Optional additional body text
    *   `options.isHtml` **[Boolean][170]** If truthy, treat the body as HTML (optional, default `false`)
    *   `options.value` **[String][166]?** Current or default value to display pre-filled
    *   `options.title` **[String][166]** The dialog title to display (optional, default `'Input required'`)
    *   `options.placeholder` **[String][166]?** Optional placeholder text
    *   `options.required` **[Boolean][170]** Treat nullish or empty inputs as a cancel operation (optional, default `true`)

Returns **[Promise][172]\<any>** Either the eventual user value or a throw with `Promise.reject('CANCEL')`

## uiThrow

Catch an error using the TERA error handler

### Parameters

*   `error` **([Error][179] | [Object][167] | [String][166])** Error to handle, generally an Error object but can be a POJO or a scalar string

Returns **Void** This function is fatal

## uiWindow

Open a popup window containing a new site

### Parameters

*   `url` **[String][166]** The URL to open
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.width` **[Number][169]** The desired width of the window (optional, default `500`)
    *   `options.height` **[Number][169]** The desired height of the window (optional, default `600`)
    *   `options.center` **[Boolean][170]** Attempt to center the window on the screen (optional, default `true`)
    *   `options.permissions` **[Object][167]?** Additional permissions to set on opening, defaults to a suitable set of permission for popups (see code)

Returns **WindowProxy** The opened window object (if `noopener` is not set in permissions)

## uiSplat

Display HTML content full-screen within TERA
This function is ideally called within a requestFocus() wrapper

### Parameters

*   `content` **(DOMElement | [String][166] | `false`)** Either a prepared DOM element or string to compile, set to falsy to remove existing content
*   `options` **[Object][167]?** Additional options to mutate behaviour

    *   `options.logo` **([Boolean][170] | [String][166])** Add a logo to the output, if boolean true the Tera-tools logo is used otherwise specify a path or URL (optional, default `false`)

[1]: #projectfile

[2]: #id

[3]: #sbid

[4]: #name

[5]: #icon

[6]: #path

[7]: #url

[8]: #teraurl

[9]: #parsedname

[10]: #properties

[11]: #created

[12]: #createdformatted

[13]: #modified

[14]: #modifiedformatted

[15]: #accessed

[16]: #accessedformatted

[17]: #size

[18]: #sizeformatted

[19]: #mime

[20]: #meta

[21]: #isfolder

[22]: #files

[23]: #getcontents

[24]: #parameters

[25]: #setcontents

[26]: #parameters-1

[27]: #getrefs

[28]: #setrefs

[29]: #parameters-2

[30]: #serialize

[31]: #deserialize

[32]: #parameters-3

[33]: #terafy

[34]: #settings

[35]: #properties-1

[36]: #events

[37]: #dom

[38]: #properties-2

[39]: #methods

[40]: #plugins

[41]: #namespaces

[42]: #send

[43]: #parameters-4

[44]: #sendraw

[45]: #parameters-5

[46]: #rpc

[47]: #parameters-6

[48]: #acceptmessage

[49]: #parameters-7

[50]: #acceptpostboxes

[51]: #init

[52]: #parameters-8

[53]: #detectmode

[54]: #injectcomms

[55]: #handshakeloop

[56]: #parameters-9

[57]: #properties-3

[58]: #injectstylesheet

[59]: #injectmethods

[60]: #debug

[61]: #parameters-10

[62]: #set

[63]: #parameters-11

[64]: #setifdev

[65]: #parameters-12

[66]: #use

[67]: #parameters-13

[68]: #mixin

[69]: #parameters-14

[70]: #toggledevmode

[71]: #parameters-15

[72]: #togglefocus

[73]: #parameters-16

[74]: #getentropicstring

[75]: #parameters-17

[76]: #selectprojectfile

[77]: #parameters-18

[78]: #mountnamespace

[79]: #parameters-19

[80]: #actual-namespace-mounting-function-designed-to-be-overriden-by-plugins

[81]: #parameters-20

[82]: #unmountnamespace

[83]: #parameters-21

[84]: #actual-namespace-unmounting-function-designed-to-be-overriden-by-plugins

[85]: #parameters-22

[86]: #handshake

[87]: #properties-4

[88]: #setserververbosity

[89]: #parameters-23

[90]: #user

[91]: #properties-5

[92]: #getuser

[93]: #getcredentials

[94]: #requireuser

[95]: #parameters-24

[96]: #project

[97]: #getproject

[98]: #getprojects

[99]: #setactiveproject

[100]: #parameters-25

[101]: #requireproject

[102]: #parameters-26

[103]: #selectproject

[104]: #parameters-27

[105]: #getnamespace

[106]: #parameters-28

[107]: #setnamespace

[108]: #parameters-29

[109]: #listnamespaces

[110]: #properties-6

[111]: #getprojectstate

[112]: #parameters-30

[113]: #setprojectstate

[114]: #parameters-31

[115]: #setprojectstatedefaults

[116]: #parameters-32

[117]: #setprojectstaterefresh

[118]: #filefilters

[119]: #properties-7

[120]: #selectprojectfile-1

[121]: #parameters-33

[122]: #getprojectfiles

[123]: #parameters-34

[124]: #getprojectfilecontents

[125]: #parameters-35

[126]: #getprojectfile

[127]: #parameters-36

[128]: #createprojectfile

[129]: #parameters-37

[130]: #moveprojectfile

[131]: #parameters-38

[132]: #deleteprojectfile

[133]: #parameters-39

[134]: #setprojectfilecontents

[135]: #parameters-40

[136]: #createprojectfolder

[137]: #parameters-41

[138]: #deleteprojectfolder

[139]: #parameters-42

[140]: #selectprojectlibrary

[141]: #parameters-43

[142]: #getprojectlibrary

[143]: #parameters-44

[144]: #setprojectlibrary

[145]: #parameters-45

[146]: #projectlog

[147]: #parameters-46

[148]: #setpage

[149]: #parameters-47

[150]: #uialert

[151]: #parameters-48

[152]: #uiconfirm

[153]: #parameters-49

[154]: #uipanic

[155]: #parameters-50

[156]: #uiprogress

[157]: #parameters-51

[158]: #uiprompt

[159]: #parameters-52

[160]: #uithrow

[161]: #parameters-53

[162]: #uiwindow

[163]: #parameters-54

[164]: #uisplat

[165]: #parameters-55

[166]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[167]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[168]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date

[169]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[170]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[171]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[172]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[173]: https://developer.mozilla.org/docs/Web/API/Blob

[174]: https://developer.mozilla.org/docs/Web/API/FormData

[175]: https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm

[176]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[177]: https://developer.mozilla.org/docs/Web/API/Window

[178]: https://developer.mozilla.org/docs/Web/API/MessageEvent

[179]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error

[180]: https://tera-tools.com/api/logs.json
