var uo=Object.defineProperty;var co=(t,e,r)=>e in t?uo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var p=(t,e,r)=>co(t,typeof e!="symbol"?e+"":e,r);var ho=typeof global=="object"&&global&&global.Object===Object&&global,dt=ho;var xo=typeof self=="object"&&self&&self.Object===Object&&self,go=dt||xo||Function("return this")(),c=go;var bo=c.Symbol,b=bo;var Yt=Object.prototype,yo=Yt.hasOwnProperty,vo=Yt.toString,st=b?b.toStringTag:void 0;function wo(t){var e=yo.call(t,st),r=t[st];try{t[st]=void 0;var o=!0}catch{}var a=vo.call(t);return o&&(e?t[st]=r:delete t[st]),a}var Zt=wo;var To=Object.prototype,Oo=To.toString;function jo(t){return Oo.call(t)}var Jt=jo;var Ao="[object Null]",Po="[object Undefined]",Xt=b?b.toStringTag:void 0;function So(t){return t==null?t===void 0?Po:Ao:Xt&&Xt in Object(t)?Zt(t):Jt(t)}var O=So;function Io(t){return t!=null&&typeof t=="object"}var T=Io;var _o="[object Symbol]";function Eo(t){return typeof t=="symbol"||T(t)&&O(t)==_o}var k=Eo;function Co(t,e){for(var r=-1,o=t==null?0:t.length,a=Array(o);++r<o;)a[r]=e(t[r],r,t);return a}var Qt=Co;var Fo=Array.isArray,g=Fo;var No=1/0,te=b?b.prototype:void 0,ee=te?te.toString:void 0;function re(t){if(typeof t=="string")return t;if(g(t))return Qt(t,re)+"";if(k(t))return ee?ee.call(t):"";var e=t+"";return e=="0"&&1/t==-No?"-0":e}var oe=re;function Mo(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var w=Mo;function Ro(t){return t}var ae=Ro;var Bo="[object AsyncFunction]",Lo="[object Function]",ko="[object GeneratorFunction]",Uo="[object Proxy]";function Do(t){if(!w(t))return!1;var e=O(t);return e==Lo||e==ko||e==Bo||e==Uo}var ct=Do;var zo=c["__core-js_shared__"],ht=zo;var ie=function(){var t=/[^.]+$/.exec(ht&&ht.keys&&ht.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Go(t){return!!ie&&ie in t}var se=Go;var Wo=Function.prototype,Ko=Wo.toString;function $o(t){if(t!=null){try{return Ko.call(t)}catch{}try{return t+""}catch{}}return""}var A=$o;var Ho=/[\\^$.*+?()[\]{}|]/g,Vo=/^\[object .+?Constructor\]$/,qo=Function.prototype,Yo=Object.prototype,Zo=qo.toString,Jo=Yo.hasOwnProperty,Xo=RegExp("^"+Zo.call(Jo).replace(Ho,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qo(t){if(!w(t)||se(t))return!1;var e=ct(t)?Xo:Vo;return e.test(A(t))}var ne=Qo;function ta(t,e){return t==null?void 0:t[e]}var fe=ta;function ea(t,e){var r=fe(t,e);return ne(r)?r:void 0}var y=ea;var ra=y(c,"WeakMap"),xt=ra;var pe=Object.create,oa=function(){function t(){}return function(e){if(!w(e))return{};if(pe)return pe(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),le=oa;function aa(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var me=aa;function ia(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var ue=ia;var sa=800,na=16,fa=Date.now;function pa(t){var e=0,r=0;return function(){var o=fa(),a=na-(o-r);if(r=o,a>0){if(++e>=sa)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var de=pa;function la(t){return function(){return t}}var ce=la;var ma=function(){try{var t=y(Object,"defineProperty");return t({},"",{}),t}catch{}}(),U=ma;var ua=U?function(t,e){return U(t,"toString",{configurable:!0,enumerable:!1,value:ce(e),writable:!0})}:ae,he=ua;var da=de(he),xe=da;function ca(t,e){for(var r=-1,o=t==null?0:t.length;++r<o&&e(t[r],r,t)!==!1;);return t}var ge=ca;var ha=9007199254740991,xa=/^(?:0|[1-9]\d*)$/;function ga(t,e){var r=typeof t;return e=e==null?ha:e,!!e&&(r=="number"||r!="symbol"&&xa.test(t))&&t>-1&&t%1==0&&t<e}var D=ga;function ba(t,e,r){e=="__proto__"&&U?U(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var gt=ba;function ya(t,e){return t===e||t!==t&&e!==e}var bt=ya;var va=Object.prototype,wa=va.hasOwnProperty;function Ta(t,e,r){var o=t[e];(!(wa.call(t,e)&&bt(o,r))||r===void 0&&!(e in t))&&gt(t,e,r)}var z=Ta;function Oa(t,e,r,o){var a=!r;r||(r={});for(var s=-1,i=e.length;++s<i;){var n=e[s],d=o?o(r[n],t[n],n,r,t):void 0;d===void 0&&(d=t[n]),a?gt(r,n,d):z(r,n,d)}return r}var I=Oa;var be=Math.max;function ja(t,e,r){return e=be(e===void 0?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=be(o.length-e,0),i=Array(s);++a<s;)i[a]=o[e+a];a=-1;for(var n=Array(e+1);++a<e;)n[a]=o[a];return n[e]=r(i),me(t,this,n)}}var ye=ja;var Aa=9007199254740991;function Pa(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Aa}var G=Pa;function Sa(t){return t!=null&&G(t.length)&&!ct(t)}var yt=Sa;var Ia=Object.prototype;function _a(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Ia;return t===r}var W=_a;function Ea(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var ve=Ea;var Ca="[object Arguments]";function Fa(t){return T(t)&&O(t)==Ca}var Nt=Fa;var we=Object.prototype,Na=we.hasOwnProperty,Ma=we.propertyIsEnumerable,Ra=Nt(function(){return arguments}())?Nt:function(t){return T(t)&&Na.call(t,"callee")&&!Ma.call(t,"callee")},K=Ra;function Ba(){return!1}var Te=Ba;var Ae=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Oe=Ae&&typeof module=="object"&&module&&!module.nodeType&&module,La=Oe&&Oe.exports===Ae,je=La?c.Buffer:void 0,ka=je?je.isBuffer:void 0,Ua=ka||Te,vt=Ua;var Da="[object Arguments]",za="[object Array]",Ga="[object Boolean]",Wa="[object Date]",Ka="[object Error]",$a="[object Function]",Ha="[object Map]",Va="[object Number]",qa="[object Object]",Ya="[object RegExp]",Za="[object Set]",Ja="[object String]",Xa="[object WeakMap]",Qa="[object ArrayBuffer]",ti="[object DataView]",ei="[object Float32Array]",ri="[object Float64Array]",oi="[object Int8Array]",ai="[object Int16Array]",ii="[object Int32Array]",si="[object Uint8Array]",ni="[object Uint8ClampedArray]",fi="[object Uint16Array]",pi="[object Uint32Array]",u={};u[ei]=u[ri]=u[oi]=u[ai]=u[ii]=u[si]=u[ni]=u[fi]=u[pi]=!0;u[Da]=u[za]=u[Qa]=u[Ga]=u[ti]=u[Wa]=u[Ka]=u[$a]=u[Ha]=u[Va]=u[qa]=u[Ya]=u[Za]=u[Ja]=u[Xa]=!1;function li(t){return T(t)&&G(t.length)&&!!u[O(t)]}var Pe=li;function mi(t){return function(e){return t(e)}}var $=mi;var Se=typeof exports=="object"&&exports&&!exports.nodeType&&exports,nt=Se&&typeof module=="object"&&module&&!module.nodeType&&module,ui=nt&&nt.exports===Se,Mt=ui&&dt.process,di=function(){try{var t=nt&&nt.require&&nt.require("util").types;return t||Mt&&Mt.binding&&Mt.binding("util")}catch{}}(),P=di;var Ie=P&&P.isTypedArray,ci=Ie?$(Ie):Pe,_e=ci;var hi=Object.prototype,xi=hi.hasOwnProperty;function gi(t,e){var r=g(t),o=!r&&K(t),a=!r&&!o&&vt(t),s=!r&&!o&&!a&&_e(t),i=r||o||a||s,n=i?ve(t.length,String):[],d=n.length;for(var h in t)(e||xi.call(t,h))&&!(i&&(h=="length"||a&&(h=="offset"||h=="parent")||s&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||D(h,d)))&&n.push(h);return n}var wt=gi;function bi(t,e){return function(r){return t(e(r))}}var Tt=bi;var yi=Tt(Object.keys,Object),Ee=yi;var vi=Object.prototype,wi=vi.hasOwnProperty;function Ti(t){if(!W(t))return Ee(t);var e=[];for(var r in Object(t))wi.call(t,r)&&r!="constructor"&&e.push(r);return e}var Ce=Ti;function Oi(t){return yt(t)?wt(t):Ce(t)}var H=Oi;function ji(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Fe=ji;var Ai=Object.prototype,Pi=Ai.hasOwnProperty;function Si(t){if(!w(t))return Fe(t);var e=W(t),r=[];for(var o in t)o=="constructor"&&(e||!Pi.call(t,o))||r.push(o);return r}var Ne=Si;function Ii(t){return yt(t)?wt(t,!0):Ne(t)}var V=Ii;var _i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ei=/^\w*$/;function Ci(t,e){if(g(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||k(t)?!0:Ei.test(t)||!_i.test(t)||e!=null&&t in Object(e)}var Me=Ci;var Fi=y(Object,"create"),S=Fi;function Ni(){this.__data__=S?S(null):{},this.size=0}var Re=Ni;function Mi(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Be=Mi;var Ri="__lodash_hash_undefined__",Bi=Object.prototype,Li=Bi.hasOwnProperty;function ki(t){var e=this.__data__;if(S){var r=e[t];return r===Ri?void 0:r}return Li.call(e,t)?e[t]:void 0}var Le=ki;var Ui=Object.prototype,Di=Ui.hasOwnProperty;function zi(t){var e=this.__data__;return S?e[t]!==void 0:Di.call(e,t)}var ke=zi;var Gi="__lodash_hash_undefined__";function Wi(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=S&&e===void 0?Gi:e,this}var Ue=Wi;function q(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}q.prototype.clear=Re;q.prototype.delete=Be;q.prototype.get=Le;q.prototype.has=ke;q.prototype.set=Ue;var Rt=q;function Ki(){this.__data__=[],this.size=0}var De=Ki;function $i(t,e){for(var r=t.length;r--;)if(bt(t[r][0],e))return r;return-1}var _=$i;var Hi=Array.prototype,Vi=Hi.splice;function qi(t){var e=this.__data__,r=_(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():Vi.call(e,r,1),--this.size,!0}var ze=qi;function Yi(t){var e=this.__data__,r=_(e,t);return r<0?void 0:e[r][1]}var Ge=Yi;function Zi(t){return _(this.__data__,t)>-1}var We=Zi;function Ji(t,e){var r=this.__data__,o=_(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var Ke=Ji;function Y(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}Y.prototype.clear=De;Y.prototype.delete=ze;Y.prototype.get=Ge;Y.prototype.has=We;Y.prototype.set=Ke;var E=Y;var Xi=y(c,"Map"),C=Xi;function Qi(){this.size=0,this.__data__={hash:new Rt,map:new(C||E),string:new Rt}}var $e=Qi;function ts(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var He=ts;function es(t,e){var r=t.__data__;return He(e)?r[typeof e=="string"?"string":"hash"]:r.map}var F=es;function rs(t){var e=F(this,t).delete(t);return this.size-=e?1:0,e}var Ve=rs;function os(t){return F(this,t).get(t)}var qe=os;function as(t){return F(this,t).has(t)}var Ye=as;function is(t,e){var r=F(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var Ze=is;function Z(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}Z.prototype.clear=$e;Z.prototype.delete=Ve;Z.prototype.get=qe;Z.prototype.has=Ye;Z.prototype.set=Ze;var ft=Z;var ss="Expected a function";function Bt(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(ss);var r=function(){var o=arguments,a=e?e.apply(this,o):o[0],s=r.cache;if(s.has(a))return s.get(a);var i=t.apply(this,o);return r.cache=s.set(a,i)||s,i};return r.cache=new(Bt.Cache||ft),r}Bt.Cache=ft;var Je=Bt;var ns=500;function fs(t){var e=Je(t,function(o){return r.size===ns&&r.clear(),o}),r=e.cache;return e}var Xe=fs;var ps=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ls=/\\(\\)?/g,ms=Xe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(ps,function(r,o,a,s){e.push(a?s.replace(ls,"$1"):o||r)}),e}),Qe=ms;function us(t){return t==null?"":oe(t)}var tr=us;function ds(t,e){return g(t)?t:Me(t,e)?[t]:Qe(tr(t))}var N=ds;var cs=1/0;function hs(t){if(typeof t=="string"||k(t))return t;var e=t+"";return e=="0"&&1/t==-cs?"-0":e}var J=hs;function xs(t,e){e=N(e,t);for(var r=0,o=e.length;t!=null&&r<o;)t=t[J(e[r++])];return r&&r==o?t:void 0}var er=xs;function gs(t,e){for(var r=-1,o=e.length,a=t.length;++r<o;)t[a+r]=e[r];return t}var X=gs;var rr=b?b.isConcatSpreadable:void 0;function bs(t){return g(t)||K(t)||!!(rr&&t&&t[rr])}var or=bs;function ar(t,e,r,o,a){var s=-1,i=t.length;for(r||(r=or),a||(a=[]);++s<i;){var n=t[s];e>0&&r(n)?e>1?ar(n,e-1,r,o,a):X(a,n):o||(a[a.length]=n)}return a}var ir=ar;function ys(t){var e=t==null?0:t.length;return e?ir(t,1):[]}var sr=ys;function vs(t){return xe(ye(t,void 0,sr),t+"")}var nr=vs;var ws=Tt(Object.getPrototypeOf,Object),Ot=ws;function Ts(){this.__data__=new E,this.size=0}var fr=Ts;function Os(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var pr=Os;function js(t){return this.__data__.get(t)}var lr=js;function As(t){return this.__data__.has(t)}var mr=As;var Ps=200;function Ss(t,e){var r=this.__data__;if(r instanceof E){var o=r.__data__;if(!C||o.length<Ps-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new ft(o)}return r.set(t,e),this.size=r.size,this}var ur=Ss;function Q(t){var e=this.__data__=new E(t);this.size=e.size}Q.prototype.clear=fr;Q.prototype.delete=pr;Q.prototype.get=lr;Q.prototype.has=mr;Q.prototype.set=ur;var dr=Q;function Is(t,e){return t&&I(e,H(e),t)}var cr=Is;function _s(t,e){return t&&I(e,V(e),t)}var hr=_s;var yr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xr=yr&&typeof module=="object"&&module&&!module.nodeType&&module,Es=xr&&xr.exports===yr,gr=Es?c.Buffer:void 0,br=gr?gr.allocUnsafe:void 0;function Cs(t,e){if(e)return t.slice();var r=t.length,o=br?br(r):new t.constructor(r);return t.copy(o),o}var vr=Cs;function Fs(t,e){for(var r=-1,o=t==null?0:t.length,a=0,s=[];++r<o;){var i=t[r];e(i,r,t)&&(s[a++]=i)}return s}var wr=Fs;function Ns(){return[]}var jt=Ns;var Ms=Object.prototype,Rs=Ms.propertyIsEnumerable,Tr=Object.getOwnPropertySymbols,Bs=Tr?function(t){return t==null?[]:(t=Object(t),wr(Tr(t),function(e){return Rs.call(t,e)}))}:jt,tt=Bs;function Ls(t,e){return I(t,tt(t),e)}var Or=Ls;var ks=Object.getOwnPropertySymbols,Us=ks?function(t){for(var e=[];t;)X(e,tt(t)),t=Ot(t);return e}:jt,At=Us;function Ds(t,e){return I(t,At(t),e)}var jr=Ds;function zs(t,e,r){var o=e(t);return g(t)?o:X(o,r(t))}var Pt=zs;function Gs(t){return Pt(t,H,tt)}var Ar=Gs;function Ws(t){return Pt(t,V,At)}var Pr=Ws;var Ks=y(c,"DataView"),St=Ks;var $s=y(c,"Promise"),It=$s;var Hs=y(c,"Set"),_t=Hs;var Sr="[object Map]",Vs="[object Object]",Ir="[object Promise]",_r="[object Set]",Er="[object WeakMap]",Cr="[object DataView]",qs=A(St),Ys=A(C),Zs=A(It),Js=A(_t),Xs=A(xt),B=O;(St&&B(new St(new ArrayBuffer(1)))!=Cr||C&&B(new C)!=Sr||It&&B(It.resolve())!=Ir||_t&&B(new _t)!=_r||xt&&B(new xt)!=Er)&&(B=function(t){var e=O(t),r=e==Vs?t.constructor:void 0,o=r?A(r):"";if(o)switch(o){case qs:return Cr;case Ys:return Sr;case Zs:return Ir;case Js:return _r;case Xs:return Er}return e});var et=B;var Qs=Object.prototype,tn=Qs.hasOwnProperty;function en(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&tn.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Fr=en;var rn=c.Uint8Array,Lt=rn;function on(t){var e=new t.constructor(t.byteLength);return new Lt(e).set(new Lt(t)),e}var rt=on;function an(t,e){var r=e?rt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Nr=an;var sn=/\w*$/;function nn(t){var e=new t.constructor(t.source,sn.exec(t));return e.lastIndex=t.lastIndex,e}var Mr=nn;var Rr=b?b.prototype:void 0,Br=Rr?Rr.valueOf:void 0;function fn(t){return Br?Object(Br.call(t)):{}}var Lr=fn;function pn(t,e){var r=e?rt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var kr=pn;var ln="[object Boolean]",mn="[object Date]",un="[object Map]",dn="[object Number]",cn="[object RegExp]",hn="[object Set]",xn="[object String]",gn="[object Symbol]",bn="[object ArrayBuffer]",yn="[object DataView]",vn="[object Float32Array]",wn="[object Float64Array]",Tn="[object Int8Array]",On="[object Int16Array]",jn="[object Int32Array]",An="[object Uint8Array]",Pn="[object Uint8ClampedArray]",Sn="[object Uint16Array]",In="[object Uint32Array]";function _n(t,e,r){var o=t.constructor;switch(e){case bn:return rt(t);case ln:case mn:return new o(+t);case yn:return Nr(t,r);case vn:case wn:case Tn:case On:case jn:case An:case Pn:case Sn:case In:return kr(t,r);case un:return new o;case dn:case xn:return new o(t);case cn:return Mr(t);case hn:return new o;case gn:return Lr(t)}}var Ur=_n;function En(t){return typeof t.constructor=="function"&&!W(t)?le(Ot(t)):{}}var Dr=En;var Cn="[object Map]";function Fn(t){return T(t)&&et(t)==Cn}var zr=Fn;var Gr=P&&P.isMap,Nn=Gr?$(Gr):zr,Wr=Nn;var Mn="[object Set]";function Rn(t){return T(t)&&et(t)==Mn}var Kr=Rn;var $r=P&&P.isSet,Bn=$r?$($r):Kr,Hr=Bn;var Ln=1,kn=2,Un=4,Vr="[object Arguments]",Dn="[object Array]",zn="[object Boolean]",Gn="[object Date]",Wn="[object Error]",qr="[object Function]",Kn="[object GeneratorFunction]",$n="[object Map]",Hn="[object Number]",Yr="[object Object]",Vn="[object RegExp]",qn="[object Set]",Yn="[object String]",Zn="[object Symbol]",Jn="[object WeakMap]",Xn="[object ArrayBuffer]",Qn="[object DataView]",tf="[object Float32Array]",ef="[object Float64Array]",rf="[object Int8Array]",of="[object Int16Array]",af="[object Int32Array]",sf="[object Uint8Array]",nf="[object Uint8ClampedArray]",ff="[object Uint16Array]",pf="[object Uint32Array]",m={};m[Vr]=m[Dn]=m[Xn]=m[Qn]=m[zn]=m[Gn]=m[tf]=m[ef]=m[rf]=m[of]=m[af]=m[$n]=m[Hn]=m[Yr]=m[Vn]=m[qn]=m[Yn]=m[Zn]=m[sf]=m[nf]=m[ff]=m[pf]=!0;m[Wn]=m[qr]=m[Jn]=!1;function Et(t,e,r,o,a,s){var i,n=e&Ln,d=e&kn,h=e&Un;if(r&&(i=a?r(t,o,a,s):r(t)),i!==void 0)return i;if(!w(t))return t;var x=g(t);if(x){if(i=Fr(t),!n)return ue(t,i)}else{var j=et(t),pt=j==qr||j==Kn;if(vt(t))return vr(t,n);if(j==Yr||j==Vr||pt&&!a){if(i=d||pt?{}:Dr(t),!n)return d?jr(t,hr(i,t)):Or(t,cr(i,t))}else{if(!m[j])return a?t:{};i=Ur(t,j,n)}}s||(s=new dr);var at=s.get(t);if(at)return at;s.set(t,i),Hr(t)?t.forEach(function(v){i.add(Et(v,e,r,v,t,s))}):Wr(t)&&t.forEach(function(v,f){i.set(f,Et(v,e,r,f,t,s))});var lt=h?d?Pr:Ar:d?V:H,mt=x?void 0:lt(t);return ge(mt||t,function(v,f){mt&&(f=v,v=t[f]),z(i,f,Et(v,e,r,f,t,s))}),i}var Zr=Et;var lf=1,mf=4;function uf(t){return Zr(t,lf|mf)}var kt=uf;function df(t,e){return t!=null&&e in Object(t)}var Jr=df;function cf(t,e,r){e=N(e,t);for(var o=-1,a=e.length,s=!1;++o<a;){var i=J(e[o]);if(!(s=t!=null&&r(t,i)))break;t=t[i]}return s||++o!=a?s:(a=t==null?0:t.length,!!a&&G(a)&&D(i,a)&&(g(t)||K(t)))}var Xr=cf;function hf(t,e){return t!=null&&Xr(t,e,Jr)}var Qr=hf;function xf(t,e,r,o){if(!w(t))return t;e=N(e,t);for(var a=-1,s=e.length,i=s-1,n=t;n!=null&&++a<s;){var d=J(e[a]),h=r;if(d==="__proto__"||d==="constructor"||d==="prototype")return t;if(a!=i){var x=n[d];h=o?o(x,d,n):void 0,h===void 0&&(h=w(x)?x:D(e[a+1])?[]:{})}z(n,d,h),n=n[d]}return t}var to=xf;function gf(t,e,r){for(var o=-1,a=e.length,s={};++o<a;){var i=e[o],n=er(t,i);r(n,i)&&to(s,N(i,t),n)}return s}var eo=gf;function bf(t,e){return eo(t,e,function(r,o){return Qr(t,o)})}var ro=bf;var yf=nr(function(t,e){return t==null?{}:ro(t,e)}),Ct=yf;function oo(t){return{all:t=t||new Map,on:function(e,r){var o=t.get(e);o?o.push(r):t.set(e,[r])},off:function(e,r){var o=t.get(e);o&&(r?o.splice(o.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var o=t.get(e);o&&o.slice().map(function(a){a(r)}),(o=t.get("*"))&&o.slice().map(function(a){a(e,r)})}}}var ao="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Ut=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=ao[r[t]&63];return e};var vf="array",wf="bit",io="bits",Tf="byte",so="bytes",ot="",Of="exponent",jf="function",no="iec",Af="Invalid number",Pf="Invalid rounding method",Dt="jedec",Sf="object",fo=".",If="round",_f="s",Ef="si",Cf="kbit",Ff="kB",Nf=" ",Mf="string",Rf="0",zt={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function po(t,{bits:e=!1,pad:r=!1,base:o=-1,round:a=2,locale:s=ot,localeOptions:i={},separator:n=ot,spacer:d=Nf,symbols:h={},standard:x=ot,output:j=Mf,fullform:pt=!1,fullforms:at=[],exponent:lt=-1,roundingMethod:mt=If,precision:v=0}={}){let f=lt,L=Number(t),l=[],R=0,Ft=ot;x===Ef?(o=10,x=Dt):x===no||x===Dt?o=2:o===2?x=no:(o=10,x=Dt);let ut=o===10?1e3:1024,lo=pt===!0,Wt=L<0,Kt=Math[mt];if(typeof t!="bigint"&&isNaN(t))throw new TypeError(Af);if(typeof Kt!==jf)throw new TypeError(Pf);if(Wt&&(L=-L),(f===-1||isNaN(f))&&(f=Math.floor(Math.log(L)/Math.log(ut)),f<0&&(f=0)),f>8&&(v>0&&(v+=8-f),f=8),j===Of)return f;if(L===0)l[0]=0,Ft=l[1]=zt.symbol[x][e?io:so][f];else{R=L/(o===2?Math.pow(2,f*10):Math.pow(1e3,f)),e&&(R=R*8,R>=ut&&f<8&&(R=R/ut,f++));let it=Math.pow(10,f>0?a:0);l[0]=Kt(R*it)/it,l[0]===ut&&f<8&&lt===-1&&(l[0]=1,f++),Ft=l[1]=o===10&&f===1?e?Cf:Ff:zt.symbol[x][e?io:so][f]}if(Wt&&(l[0]=-l[0]),v>0&&(l[0]=l[0].toPrecision(v)),l[1]=h[l[1]]||l[1],s===!0?l[0]=l[0].toLocaleString():s.length>0?l[0]=l[0].toLocaleString(s,i):n.length>0&&(l[0]=l[0].toString().replace(fo,n)),r&&a>0){let it=l[0].toString(),$t=n||(it.match(/(\D)/g)||[]).pop()||fo,Ht=it.toString().split($t),Vt=Ht[1]||ot,qt=Vt.length,mo=a-qt;l[0]=`${Ht[0]}${$t}${Vt.padEnd(qt+mo,Rf)}`}return lo&&(l[1]=at[f]?at[f]:zt.fullform[x][f]+(e?wf:Tf)+(l[0]===1?ot:_f)),j===vf?l:j===Sf?{value:l[0],symbol:l[1],exponent:f,unit:Ft}:l.join(d)}var M=class t{constructor(e){p(this,"_tera");p(this,"id");p(this,"sbId");p(this,"name");p(this,"icon");p(this,"path");p(this,"url");p(this,"teraUrl");p(this,"parsedName");p(this,"created");p(this,"createdFormatted");p(this,"modified");p(this,"modifiedFormatted");p(this,"accessed");p(this,"accessedFormatted");p(this,"size");p(this,"sizeFormatted");p(this,"mime");p(this,"meta",{});if(!e.tera)throw new Error("Basic file requires a `tera` key to access the Tera instance");Object.assign(this,e);let r=this.tera;Object.defineProperty(this,"_tera",{enumerable:!1,configurable:!1,get(){return r}}),delete this.tera,this.teraUrl=this.url.replace(/^https?:\/\/(?:.+?)\/projects\/(?:.+?)\/project\/(.+)$/,"/project/$1"),this.sizeFormatted=po(this.size||0,{spacer:""}),this.createdFormatted=this.created?this.created.toLocaleDateString():"Unknown created date",this.modifiedFormatted=this.modified?this.modified.toLocaleDateString():"Unknown modified date",this.accessedFormatted=this.accessed?this.accessed.toLocaleDateString():"Unknown access date"}getContents(e){return this._tera.getProjectFileContents(this.id,e)}setContents(e){return this._tera.setProjectFileContents(this.id,e,{})}getRefs(){return this._tera.getProjectLibrary(this.id)}setRefs(e){return this._tera.setProjectLibrary(this.id,e)}serialize(){return Ct(this,["id","sbId","name","icon","path","url","parsedName","created","modified","accessed","size","mime","meta"])}static deserialize(e){return new t(Ct(e,["tera","id","sbId","name","icon","path","url","parsedName","created","modified","accessed","size","mime","meta"]))}};var Gt=class{constructor(e){p(this,"settings",{session:null,devMode:!1,verbosity:1,mode:"detect",modeTimeout:300,modeFallback:"child",modeOverrides:{child(e){e.siteUrl=="https://tera-tools.com/embed"&&(e.siteUrl="https://dev.tera-tools.com/embed")}},siteUrl:"https://tera-tools.com/embed",restrictOrigin:"*",frameSandbox:["allow-forms","allow-modals","allow-orientation-lock","allow-pointer-lock","allow-popups","allow-popups-to-escape-sandbox","allow-presentation","allow-same-origin","allow-scripts","allow-top-navigation"],handshakeInterval:1e3,handshakeTimeout:1e4,debugPaths:null});p(this,"events",oo());p(this,"dom",{el:null,iframe:null,popup:null,stylesheet:null});p(this,"methods",["handshake","setServerVerbosity","getUser","requireUser","getCredentials","bindProject","getProject","getProjects","setActiveProject","requireProject","selectProject","getNamespace","setNamespace","listNamespaces","getProjectState","setProjectState","setProjectStateDefaults","setProjectStateRefresh","getProjectFileContents","deleteProjectFile","setProjectFileContents","selectProjectLibrary","getProjectLibrary","setProjectLibrary","projectLog","setPage","uiAlert","uiConfirm","uiPanic","uiProgress","uiPrompt","uiThrow","uiSplat","uiWindow"]);p(this,"plugins",[]);p(this,"namespaces",{});p(this,"acceptPostboxes",{});e&&this.set(e)}send(e){let r=Ut();return this.acceptPostboxes[r]={},this.acceptPostboxes[r].promise=new Promise((o,a)=>{Object.assign(this.acceptPostboxes[r],{resolve:o,reject:a}),this.sendRaw({id:r,...e})}),this.acceptPostboxes[r].promise}sendRaw(e){let r;try{if(r={TERA:1,id:e.id||Ut(),...kt(e)},this.settings.mode=="parent")window.parent.postMessage(r,this.settings.restrictOrigin);else if(this.settings.mode=="child")this.dom.iframe.contentWindow.postMessage(r,this.settings.restrictOrigin);else if(this.settings.mode=="popup")this.dom.popup.postMessage(r,this.settings.restrictOrigin);else throw this.settings.mode=="detect"?new Error("Call init() or detectMode() before trying to send data to determine the mode"):new Error(`Unknown TERA communication mode "${this.settings.mode}"`)}catch(o){throw this.debug("ERROR",1,"Message compose client->server:",o),this.debug("ERROR",1,"Attempted to dispatch payload client->server",r),o}}rpc(e,...r){return this.send({action:"rpc",method:e,args:r})}acceptMessage(e){if(e.origin==window.location.origin)return Promise.resolve();let r=e.data;return!r.TERA||!r.id?Promise.resolve():(this.debug("INFO",3,"Recieved message",r),(r==null?void 0:r.action)=="response"&&this.acceptPostboxes[r.id]?(r.isError===!0?this.acceptPostboxes[r.id].reject(r.response):this.acceptPostboxes[r.id].resolve(r.response),Promise.resolve()):(r==null?void 0:r.action)=="rpc"?Promise.resolve().then(()=>this[r.method].apply(this,r.args)).then(o=>this.sendRaw({id:r.id,action:"response",response:o})).catch(o=>{console.warn(`TERA-FY client threw on RPC:${r.method}:`,o),this.sendRaw({id:r.id,action:"response",isError:!0,response:o&&o.toString()})}):(r==null?void 0:r.action)=="event"?Promise.resolve().then(()=>this.events.emit(r.event,...r.payload)).catch(o=>{throw console.warn(`TERA-FY client threw while handling emitted event "${r.event}"`,{message:r}),o}):r!=null&&r.id?(this.debug("INFO",3,`Ignoring message ID ${r.id} - was meant for someone else?`),Promise.resolve()):(this.debug("INFO",3,"Unexpected incoming TERA-FY CLIENT message",{message:r}),Promise.resolve()))}mountNamespace(e){if(!/^[\w-]+$/.test(e))throw new Error("Namespaces must be alphanumeric + hyphens + underscores");return this.namespaces[e]?Promise.resolve(this.namespaces[e]):Promise.resolve().then(()=>this._mountNamespace(e)).then(()=>this.namespaces[e]||Promise.reject(`teraFy.mountNamespace('${e}') resolved but no namespace has been mounted`))}_mountNamespace(e){throw console.warn("teraFy._mountNamespace() has not been overriden by a TERA-fy plugin, load one to add this functionality for your preferred framework"),new Error("teraFy._mountNamespace() is not supported")}unmountNamespace(e){return this.namespaces[e]?this._unmountNamespace(e):Promise.resolve()}_unmountNamespace(e){console.warn("teraFy.unbindNamespace() has not been overriden by a TERA-fy plugin, load one to add this functionality for your preferred framework")}init(e){if(e&&this.set(e),this.init.promise)return this.init.promise;window.addEventListener("message",this.acceptMessage.bind(this));let r=this;return this.init.promise=Promise.resolve().then(()=>{var o;return(o=this.settings).session||(o.session="tfy-"+this.getEntropicString(16))}).then(()=>this.debug("INFO",4,"[0/6] Init","Session",this.settings.session,"against",this.settings.siteUrl)).then(()=>{this.settings.devMode&&(this.settings.debugPaths=this.settings.debugPaths?Array.isArray(this.settings.debugPaths)?this.settings.debugPaths.map(o=>Array.isArray(o)?o.join("."):typeof o=="string"?o:(()=>{throw new Error("Unknown path type - should be an array or string in dotted notation")})()):(()=>{throw new Error("Unknown terafyClient.settings.debugPaths type")})():null,this.debug("INFO",0,"Watching state paths",this.settings.debugPaths))}).then(()=>this.detectMode()).then(o=>{if(this.debug("INFO",4,"[1/6] Setting client mode to",o),this.settings.mode=o,this.settings.modeOverrides[o])return this.debug("INFO",4,"[1/6] Applying specific config overrides for mode",o),this.settings.modeOverrides[o](this.settings)}).then(()=>this.debug("INFO",4,"[2/6] Injecting comms + styles + methods")).then(()=>Promise.all([this.injectComms(),this.injectStylesheet(),this.injectMethods()])).then(()=>{if(this.settings.verbosity<=1){this.debug("INFO",4,"[3/6] Skip - Server verbosity is already at 1");return}else return this.debug("INFO",4,`[3/6] Set server verbosity to ${this.settings.verbosity}`),this.rpc("setServerVerbosity",this.settings.verbosity)}).then(()=>this.debug("INFO",4,`[4/6] Set server mode to "${this.settings.mode}"`)).then(()=>this.rpc("setServerMode",this.settings.mode=="child"?"embedded":this.settings.mode=="parent"?"frame":this.settings.mode=="popup"?"popup":(()=>{throw`Unknown server mode "${this.settings.mode}"`})())).then(()=>this.debug("INFO",4,"[5/6] Run client plugins")).then(()=>Promise.all(this.plugins.map(o=>o.init.call(r,this.settings)))).then(()=>this.debug("INFO",4,"[6/6] Init complete")).catch(o=>this.debug("WARN",0,"Init process fault",o))}detectMode(){return this.settings.mode!="detect"?Promise.resolve(this.settings.mode):window.self===window.parent?Promise.resolve(this.settings.modeFallback):Promise.resolve().then(()=>this.settings.mode="parent").then(()=>new Promise((e,r)=>{let o=setTimeout(()=>r(),this.settings.modeTimeout);this.rpc("handshake").then(()=>clearTimeout(o)).then(()=>e())})).then(()=>"parent").catch(()=>this.settings.modeFallback)}injectComms(){switch(this.settings.mode){case"child":return Promise.resolve().then(()=>new Promise(e=>{this.debug("INFO",2,"Injecting TERA site as iFrame child"),this.dom.el=document.createElement("div"),this.dom.el.id="tera-fy",this.dom.el.classList.toggle("dev-mode",this.settings.devMode),this.dom.el.classList.add("minimized"),document.body.append(this.dom.el),this.dom.el.addEventListener("click",()=>this.dom.el.classList.toggle("minimized")),this.dom.iframe=document.createElement("iframe"),this.dom.iframe.setAttribute("sandbox",this.settings.frameSandbox.join(" ")),this.dom.iframe.addEventListener("load",()=>{this.debug("INFO",3,"Embeded iframe ready"),e()}),this.dom.iframe.src=this.settings.siteUrl,this.dom.el.append(this.dom.iframe)})).then(()=>this.handshakeLoop());case"parent":return this.debug("INFO",2,"Using TERA window parent"),Promise.resolve();case"popup":return this.debug("INFO",2,"Injecting TERA site as a popup window"),this.dom.popup=window.open(this.settings.siteUrl,"_blank","popup=1, location=0, menubar=0, status=0, scrollbars=0, width=500, height=600"),this.handshakeLoop().then(()=>this.debug("INFO",3,"Popup window accepted handshake"));default:throw new Error(`Unsupported mode "${this.settings.mode}" when calling injectComms()`)}}handshakeLoop(e){let r={handshakeInterval:this.settings.handshakeInterval,handshakeTimeout:this.settings.handshakeTimeout,...e};return new Promise((o,a)=>{let s=0,i,n=setTimeout(()=>{clearTimeout(i),a("TIMEOUT")},r.handshakeTimeout),d=()=>{this.debug("INFO",4,"Trying handshake",++s),clearTimeout(i),i=setTimeout(d,r.handshakeInterval),this.rpc("handshake").then(()=>{clearTimeout(n),clearTimeout(i)}).then(()=>o()).catch(a)};d()})}injectStylesheet(){switch(this.settings.mode){case"child":this.dom.stylesheet=document.createElement("style"),this.dom.stylesheet.innerHTML=[":root {","--TERA-accent: #4d659c;","}","#tera-fy {","display: none;","position: fixed;","right: 50px;","bottom: 50px;","width: 300px;","height: 150px;","background: transparent;","body:not(.tera-fy-focus) &.minimized.dev-mode {","background: var(--TERA-accent) !important;","opacity: 0.5;","right: 0px;","bottom: 0px;","width: 30px;","height: 30px;","transition: opacity 0.2s ease-out;","cursor: pointer;","border: none;","border-top-left-radius: 30px;","border-top: 2px solid var(--TERA-accent);","border-left: 2px solid var(--TERA-accent);","display: flex;","justify-content: center;","align-items: center;","&::before {","margin: 2px 0 0 0;",'content: "\u{1F300}";',"color: #FFF;","}","&:hover {","opacity: 1;","}","& > iframe {","display: none;","}","}","body:not(.tera-fy-focus) &:not(.minimized) {","&::before {","display: flex;","align-items: center;","justify-content: center;","cursor: pointer;","background: var(--TERA-accent) !important;","opacity: 0.5;","transition: opacity 0.2s ease-out;","position: absolute;","right: 0px;","bottom: 0px;","width: 20px;","height: 20px;","margin: 2px 0 0 0;",'content: "\u2B68";',"color: #FFF;","border: none;","border-top-left-radius: 30px;","border-top: 2px solid var(--TERA-accent);","border-left: 2px solid var(--TERA-accent);","}","&:hover::before {","opacity: 1;","}","}","&.dev-mode {","display: flex;","border: 5px solid var(--TERA-accent);","background: #FFF;","}","& > iframe {","width: 100%;","height: 100%;","}","}","body.tera-fy-focus {","overflow: hidden;","& #tera-fy {","display: flex !important;","position: fixed !important;","top: 0px !important;","width: 100vw !important;","height: 100vh !important;","left: 0px !important;","z-index: 10000 !important;","}","}"].join(`
`),document.head.appendChild(this.dom.stylesheet);break;case"parent":case"popup":break;default:throw new Error(`Unsupported mode "${this.settings.mode}" when injectStylesheet()`)}return Promise.resolve()}injectMethods(){this.methods.forEach(e=>this[e]=this.rpc.bind(this,e))}debug(...e){if(!this.settings.devMode||this.settings.verbosity<1)return;let r="log",o=1;typeof e[0]=="string"&&["INFO","LOG","WARN","ERROR"].includes(e[0])&&(r=e.shift().toLowerCase()),typeof e[0]=="number"&&(o=e[0],e.shift()),!(this.settings.verbosity<o)&&console[r]("%c[TERA-FY CLIENT]","font-weight: bold; color: #ff5722;",...e)}set(e,r,o){let a={ignoreNullish:!0,...o};return typeof e=="string"?(!a.ignoreNullish||r!=null)&&(this.settings[e]=r):Object.assign(this.settings,e),this.toggleDevMode(this.settings.devMode)}setIfDev(e,r,o){return!this.settings.devMode||r===void 0?this:this.set(e,r,o)}use(e,r){let o=typeof e=="function"?new e(this,r):typeof e=="object"?e:typeof e=="string"?(()=>{throw new Error("use(String) is not yet supported")})():(()=>{throw new Error("Expected use() call to be provided with a class initalizer")})();return this.mixin(this,o),this.plugins.push(o),this}mixin(e,r){let o=[],a=r;do o.unshift(a);while(a=Object.getPrototypeOf(a));o.forEach(s=>Object.getOwnPropertyNames(s).filter(i=>!["constructor","init","prototype","name"].includes(i)&&!i.startsWith("__")).forEach(i=>{typeof r[i]=="function"?Object.defineProperty(e,i,{enumerable:!1,value:r[i].bind(e)}):e[i]=r[i]}))}toggleDevMode(e="toggle"){var r;return e==="toggle"?this.settings.devMode=!this.settings.devMode:e==="proxy"?Object.assign(this.settings,{devMode:!0,siteUrl:"http://localhost:7334/embed",mode:"child"}):this.settings.devMode=!!e,this.settings.devMode&&(this.settings.restrictOrigin="*"),(r=this.dom)!=null&&r.el&&this.dom.el.classList.toggle("dev-mode",this.settings.devMode),this}toggleFocus(e="toggle"){this.debug("INFO",2,"Request focus",{isFocused:e}),globalThis.document.body.classList.toggle("tera-fy-focus",e==="toggle"?void 0:e)}getEntropicString(e=32){let r=new Uint32Array(4);return window.crypto.getRandomValues(r),btoa(String.fromCharCode(...new Uint8Array(r.buffer))).replace(/[+/]/g,"").slice(0,e)}selectProjectFile(e){return this.rpc("selectProjectFile",e).then(r=>r&&new M({tera:this,...r}))}getProjectFiles(e){return this.rpc("getProjectFiles",e).then(r=>r.map(o=>new M({tera:this,...o})))}getProjectFile(e,r){return this.rpc("getProjectFile",e,r).then(o=>o&&new M({tera:this,...o}))}createProjectFile(e){return this.rpc("createProjectFile",e).then(r=>r&&new M({tera:this,...r}))}};export{Gt as default};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

filesize/dist/filesize.esm.js:
  (**
   * filesize
   *
   * @copyright 2024 Jason Mulligan <jason.mulligan@avoidwork.com>
   * @license BSD-3-Clause
   * @version 10.1.6
   *)
*/
