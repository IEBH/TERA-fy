var Pe=typeof global=="object"&&global&&global.Object===Object&&global,N=Pe;var Se=typeof self=="object"&&self&&self.Object===Object&&self,Ee=N||Se||Function("return this")(),d=Ee;var Me=d.Symbol,O=Me;var ft=Object.prototype,De=ft.hasOwnProperty,Re=ft.toString,M=O?O.toStringTag:void 0;function Be(t){var e=De.call(t,M),r=t[M];try{t[M]=void 0;var o=!0}catch{}var a=Re.call(t);return o&&(e?t[M]=r:delete t[M]),a}var st=Be;var Le=Object.prototype,Fe=Le.toString;function Ne(t){return Fe.call(t)}var it=Ne;var ze="[object Null]",We="[object Undefined]",pt=O?O.toStringTag:void 0;function Ue(t){return t==null?t===void 0?We:ze:pt&&pt in Object(t)?st(t):it(t)}var g=Ue;function Ge(t){return t!=null&&typeof t=="object"}var x=Ge;var He=Array.isArray,D=He;function qe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var l=qe;function $e(t){return t}var z=$e;var Ke="[object AsyncFunction]",Ve="[object Function]",ke="[object GeneratorFunction]",Ye="[object Proxy]";function Je(t){if(!l(t))return!1;var e=g(t);return e==Ve||e==ke||e==Ke||e==Ye}var T=Je;var Xe=d["__core-js_shared__"],W=Xe;var nt=function(){var t=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ze(t){return!!nt&&nt in t}var ut=Ze;var Qe=Function.prototype,tr=Qe.toString;function er(t){if(t!=null){try{return tr.call(t)}catch{}try{return t+""}catch{}}return""}var lt=er;var rr=/[\\^$.*+?()[\]{}|]/g,or=/^\[object .+?Constructor\]$/,ar=Function.prototype,fr=Object.prototype,sr=ar.toString,ir=fr.hasOwnProperty,pr=RegExp("^"+sr.call(ir).replace(rr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function nr(t){if(!l(t)||ut(t))return!1;var e=T(t)?pr:or;return e.test(lt(t))}var mt=nr;function ur(t,e){return t==null?void 0:t[e]}var dt=ur;function lr(t,e){var r=dt(t,e);return mt(r)?r:void 0}var j=lr;var xt=Object.create,mr=function(){function t(){}return function(e){if(!l(e))return{};if(xt)return xt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),ct=mr;function dr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var ht=dr;function xr(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var gt=xr;var cr=800,hr=16,gr=Date.now;function yr(t){var e=0,r=0;return function(){var o=gr(),a=hr-(o-r);if(r=o,a>0){if(++e>=cr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var yt=yr;function br(t){return function(){return t}}var bt=br;var vr=function(){try{var t=j(Object,"defineProperty");return t({},"",{}),t}catch{}}(),w=vr;var _r=w?function(t,e){return w(t,"toString",{configurable:!0,enumerable:!1,value:bt(e),writable:!0})}:z,vt=_r;var Or=yt(vt),_t=Or;var Tr=9007199254740991,jr=/^(?:0|[1-9]\d*)$/;function wr(t,e){var r=typeof t;return e=e==null?Tr:e,!!e&&(r=="number"||r!="symbol"&&jr.test(t))&&t>-1&&t%1==0&&t<e}var U=wr;function Ar(t,e,r){e=="__proto__"&&w?w(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var A=Ar;function Cr(t,e){return t===e||t!==t&&e!==e}var y=Cr;var Ir=Object.prototype,Pr=Ir.hasOwnProperty;function Sr(t,e,r){var o=t[e];(!(Pr.call(t,e)&&y(o,r))||r===void 0&&!(e in t))&&A(t,e,r)}var Ot=Sr;function Er(t,e,r,o){var a=!r;r||(r={});for(var f=-1,i=e.length;++f<i;){var s=e[f],p=o?o(r[s],t[s],s,r,t):void 0;p===void 0&&(p=t[s]),a?A(r,s,p):Ot(r,s,p)}return r}var Tt=Er;var jt=Math.max;function Mr(t,e,r){return e=jt(e===void 0?t.length-1:e,0),function(){for(var o=arguments,a=-1,f=jt(o.length-e,0),i=Array(f);++a<f;)i[a]=o[e+a];a=-1;for(var s=Array(e+1);++a<e;)s[a]=o[a];return s[e]=r(i),ht(t,this,s)}}var wt=Mr;function Dr(t,e){return _t(wt(t,e,z),t+"")}var At=Dr;var Rr=9007199254740991;function Br(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Rr}var G=Br;function Lr(t){return t!=null&&G(t.length)&&!T(t)}var C=Lr;function Fr(t,e,r){if(!l(r))return!1;var o=typeof e;return(o=="number"?C(r)&&U(e,r.length):o=="string"&&e in r)?y(r[e],t):!1}var Ct=Fr;function Nr(t){return At(function(e,r){var o=-1,a=r.length,f=a>1?r[a-1]:void 0,i=a>2?r[2]:void 0;for(f=t.length>3&&typeof f=="function"?(a--,f):void 0,i&&Ct(r[0],r[1],i)&&(f=a<3?void 0:f,a=1),e=Object(e);++o<a;){var s=r[o];s&&t(e,s,o,f)}return e})}var It=Nr;var zr=Object.prototype;function Wr(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||zr;return t===r}var H=Wr;function Ur(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var Pt=Ur;var Gr="[object Arguments]";function Hr(t){return x(t)&&g(t)==Gr}var Z=Hr;var St=Object.prototype,qr=St.hasOwnProperty,$r=St.propertyIsEnumerable,Kr=Z(function(){return arguments}())?Z:function(t){return x(t)&&qr.call(t,"callee")&&!$r.call(t,"callee")},R=Kr;function Vr(){return!1}var Et=Vr;var Rt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mt=Rt&&typeof module=="object"&&module&&!module.nodeType&&module,kr=Mt&&Mt.exports===Rt,Dt=kr?d.Buffer:void 0,Yr=Dt?Dt.isBuffer:void 0,Jr=Yr||Et,q=Jr;var Xr="[object Arguments]",Zr="[object Array]",Qr="[object Boolean]",to="[object Date]",eo="[object Error]",ro="[object Function]",oo="[object Map]",ao="[object Number]",fo="[object Object]",so="[object RegExp]",io="[object Set]",po="[object String]",no="[object WeakMap]",uo="[object ArrayBuffer]",lo="[object DataView]",mo="[object Float32Array]",xo="[object Float64Array]",co="[object Int8Array]",ho="[object Int16Array]",go="[object Int32Array]",yo="[object Uint8Array]",bo="[object Uint8ClampedArray]",vo="[object Uint16Array]",_o="[object Uint32Array]",n={};n[mo]=n[xo]=n[co]=n[ho]=n[go]=n[yo]=n[bo]=n[vo]=n[_o]=!0;n[Xr]=n[Zr]=n[uo]=n[Qr]=n[lo]=n[to]=n[eo]=n[ro]=n[oo]=n[ao]=n[fo]=n[so]=n[io]=n[po]=n[no]=!1;function Oo(t){return x(t)&&G(t.length)&&!!n[g(t)]}var Bt=Oo;function To(t){return function(e){return t(e)}}var Lt=To;var Ft=typeof exports=="object"&&exports&&!exports.nodeType&&exports,B=Ft&&typeof module=="object"&&module&&!module.nodeType&&module,jo=B&&B.exports===Ft,Q=jo&&N.process,wo=function(){try{var t=B&&B.require&&B.require("util").types;return t||Q&&Q.binding&&Q.binding("util")}catch{}}(),tt=wo;var Nt=tt&&tt.isTypedArray,Ao=Nt?Lt(Nt):Bt,$=Ao;var Co=Object.prototype,Io=Co.hasOwnProperty;function Po(t,e){var r=D(t),o=!r&&R(t),a=!r&&!o&&q(t),f=!r&&!o&&!a&&$(t),i=r||o||a||f,s=i?Pt(t.length,String):[],p=s.length;for(var m in t)(e||Io.call(t,m))&&!(i&&(m=="length"||a&&(m=="offset"||m=="parent")||f&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||U(m,p)))&&s.push(m);return s}var zt=Po;function So(t,e){return function(r){return t(e(r))}}var Wt=So;function Eo(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Ut=Eo;var Mo=Object.prototype,Do=Mo.hasOwnProperty;function Ro(t){if(!l(t))return Ut(t);var e=H(t),r=[];for(var o in t)o=="constructor"&&(e||!Do.call(t,o))||r.push(o);return r}var Gt=Ro;function Bo(t){return C(t)?zt(t,!0):Gt(t)}var K=Bo;var Lo=j(Object,"create"),c=Lo;function Fo(){this.__data__=c?c(null):{},this.size=0}var Ht=Fo;function No(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var qt=No;var zo="__lodash_hash_undefined__",Wo=Object.prototype,Uo=Wo.hasOwnProperty;function Go(t){var e=this.__data__;if(c){var r=e[t];return r===zo?void 0:r}return Uo.call(e,t)?e[t]:void 0}var $t=Go;var Ho=Object.prototype,qo=Ho.hasOwnProperty;function $o(t){var e=this.__data__;return c?e[t]!==void 0:qo.call(e,t)}var Kt=$o;var Ko="__lodash_hash_undefined__";function Vo(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=c&&e===void 0?Ko:e,this}var Vt=Vo;function I(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}I.prototype.clear=Ht;I.prototype.delete=qt;I.prototype.get=$t;I.prototype.has=Kt;I.prototype.set=Vt;var et=I;function ko(){this.__data__=[],this.size=0}var kt=ko;function Yo(t,e){for(var r=t.length;r--;)if(y(t[r][0],e))return r;return-1}var b=Yo;var Jo=Array.prototype,Xo=Jo.splice;function Zo(t){var e=this.__data__,r=b(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():Xo.call(e,r,1),--this.size,!0}var Yt=Zo;function Qo(t){var e=this.__data__,r=b(e,t);return r<0?void 0:e[r][1]}var Jt=Qo;function ta(t){return b(this.__data__,t)>-1}var Xt=ta;function ea(t,e){var r=this.__data__,o=b(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var Zt=ea;function P(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}P.prototype.clear=kt;P.prototype.delete=Yt;P.prototype.get=Jt;P.prototype.has=Xt;P.prototype.set=Zt;var v=P;var ra=j(d,"Map"),V=ra;function oa(){this.size=0,this.__data__={hash:new et,map:new(V||v),string:new et}}var Qt=oa;function aa(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var te=aa;function fa(t,e){var r=t.__data__;return te(e)?r[typeof e=="string"?"string":"hash"]:r.map}var _=fa;function sa(t){var e=_(this,t).delete(t);return this.size-=e?1:0,e}var ee=sa;function ia(t){return _(this,t).get(t)}var re=ia;function pa(t){return _(this,t).has(t)}var oe=pa;function na(t,e){var r=_(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var ae=na;function S(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}S.prototype.clear=Qt;S.prototype.delete=ee;S.prototype.get=re;S.prototype.has=oe;S.prototype.set=ae;var fe=S;var ua=Wt(Object.getPrototypeOf,Object),k=ua;var la="[object Object]",ma=Function.prototype,da=Object.prototype,se=ma.toString,xa=da.hasOwnProperty,ca=se.call(Object);function ha(t){if(!x(t)||g(t)!=la)return!1;var e=k(t);if(e===null)return!0;var r=xa.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&se.call(r)==ca}var ie=ha;function ga(){this.__data__=new v,this.size=0}var pe=ga;function ya(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ne=ya;function ba(t){return this.__data__.get(t)}var ue=ba;function va(t){return this.__data__.has(t)}var le=va;var _a=200;function Oa(t,e){var r=this.__data__;if(r instanceof v){var o=r.__data__;if(!V||o.length<_a-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new fe(o)}return r.set(t,e),this.size=r.size,this}var me=Oa;function E(t){var e=this.__data__=new v(t);this.size=e.size}E.prototype.clear=pe;E.prototype.delete=ne;E.prototype.get=ue;E.prototype.has=le;E.prototype.set=me;var de=E;var ge=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xe=ge&&typeof module=="object"&&module&&!module.nodeType&&module,Ta=xe&&xe.exports===ge,ce=Ta?d.Buffer:void 0,he=ce?ce.allocUnsafe:void 0;function ja(t,e){if(e)return t.slice();var r=t.length,o=he?he(r):new t.constructor(r);return t.copy(o),o}var ye=ja;var wa=d.Uint8Array,rt=wa;function Aa(t){var e=new t.constructor(t.byteLength);return new rt(e).set(new rt(t)),e}var be=Aa;function Ca(t,e){var r=e?be(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var ve=Ca;function Ia(t){return typeof t.constructor=="function"&&!H(t)?ct(k(t)):{}}var _e=Ia;function Pa(t){return function(e,r,o){for(var a=-1,f=Object(e),i=o(e),s=i.length;s--;){var p=i[t?s:++a];if(r(f[p],p,f)===!1)break}return e}}var Oe=Pa;var Sa=Oe(),Te=Sa;function Ea(t,e,r){(r!==void 0&&!y(t[e],r)||r===void 0&&!(e in t))&&A(t,e,r)}var L=Ea;function Ma(t){return x(t)&&C(t)}var je=Ma;function Da(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var F=Da;function Ra(t){return Tt(t,K(t))}var we=Ra;function Ba(t,e,r,o,a,f,i){var s=F(t,r),p=F(e,r),m=i.get(p);if(m){L(t,r,m);return}var u=f?f(s,p,r+"",t,e,i):void 0,h=u===void 0;if(h){var J=D(p),X=!J&&q(p),at=!J&&!X&&$(p);u=p,J||X||at?D(s)?u=s:je(s)?u=gt(s):X?(h=!1,u=ye(p,!0)):at?(h=!1,u=ve(p,!0)):u=[]:ie(p)||R(p)?(u=s,R(s)?u=we(s):(!l(s)||T(s))&&(u=_e(p))):h=!1}h&&(i.set(p,u),a(u,p,o,f,i),i.delete(p)),L(t,r,u)}var Ae=Ba;function Ce(t,e,r,o,a){t!==e&&Te(e,function(f,i){if(a||(a=new de),l(f))Ae(t,e,i,r,Ce,o,a);else{var s=o?o(F(t,i),f,i+"",t,e,a):void 0;s===void 0&&(s=f),L(t,i,s)}},K)}var Ie=Ce;var La=It(function(t,e,r){Ie(t,e,r)}),Y=La;var ot=class{constructor(e){this.settings={client:"tera-fy",clientType:"esm"};this.bootstrapperDeferredMethods=[];e&&Y(this.settings,e),["set","setIfDev","use"].forEach(r=>{this[r]=(...o)=>(this.bootstrapperDeferredMethods.push({method:r,args:o}),this)})}init(e){let r=o=>`https://dev.tera-tools.com/api/tera-fy/${o}.js`;return Promise.resolve().then(()=>this.settings.clientType=="esm"?this.bootstrapperImport(r(this.settings.client)).then(o=>typeof o=="function"?o:Promise.reject("Tera-fy import didn't return a class")):Promise.reject(`Unsupported TERA-fy clientType "${this.settings.clientType}"`)).then(o=>{let a=new o;if(!a.mixin)throw new Error("TERA-fy client doesnt expose a mixin() method");a.mixin(this,a),Y(this.settings,a.settings,e||{})}).then(()=>{if(console.log("IAM",this),!this.init||typeof this.init!="function")throw new Error("Newly mixed-in TERA-fy client doesnt expose a init() method");if(!this.detectMode||typeof this.detectMode!="function")throw new Error("Newly mixed-in TERA-fy client doesnt expose a detectMode() method")}).then(()=>this.bootstrapperDeferredMethods.reduce((o,a)=>o.then(()=>a.method=="use"&&typeof a.args[0]=="string"?(console.log("TERA-FY DEFERRED-USE",a.args[0]),this.bootstrapperImport(r(a.args[0])).then(f=>typeof f=="function"?f:Promise.reject("Tera-fy plugin import didn't return a class")).then(f=>this.use(f,...a.args.slice(1)))):(console.log("TERA-FY DEFERRED-METHOD",a),Promise.resolve(this[a.method].apply(this,a.args)))),Promise.resolve(void 0))).then(()=>{delete this.bootstrapperDeferredMethods}).then(()=>console.log("TYBS","Init")).then(()=>this.init.call(this,e)).then(()=>this)}bootstrapperImport(e){return new Promise((r,o)=>{let a=`installTFyBS${Math.random().toString(36).slice(2)}`,f=document.createElement("script");f.type="module",f.textContent=`
				import mod from '${e}';
				window['installMod${a}'](mod);
			`;let i=()=>{delete window[`installMod${a}`],f.parentNode&&f.parentNode.removeChild(f)};window[`installMod${a}`]=s=>{console.log("Accept module from",e,"=",s),r(s),i()},f.onerror=(s,p,m,u,h)=>{o(new Error(`Failed to load module from ${e} - ${h?h.toString():s}`)),i()},document.head.appendChild(f)})}};export{ot as default};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
