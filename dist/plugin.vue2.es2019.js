var vv=Object.create;var Ei=Object.defineProperty;var bv=Object.getOwnPropertyDescriptor;var Tv=Object.getOwnPropertyNames;var Ev=Object.getPrototypeOf,Iv=Object.prototype.hasOwnProperty;var Av=(r,e,t)=>e in r?Ei(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var xv=(r,e)=>()=>(r&&(e=r(r=0)),e);var rt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Wr=(r,e)=>{for(var t in e)Ei(r,t,{get:e[t],enumerable:!0})},rf=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Tv(e))!Iv.call(r,i)&&i!==t&&Ei(r,i,{get:()=>e[i],enumerable:!(n=bv(e,i))||n.enumerable});return r};var nf=(r,e,t)=>(t=r!=null?vv(Ev(r)):{},rf(e||!r||!r.__esModule?Ei(t,"default",{value:r,enumerable:!0}):t,r)),Sv=r=>rf(Ei({},"__esModule",{value:!0}),r);var oe=(r,e,t)=>Av(r,typeof e!="symbol"?e+"":e,t);var Cr={};Wr(Cr,{Headers:()=>gh,Request:()=>pP,Response:()=>mP,default:()=>mh,fetch:()=>fP});var dP,qn,fP,mh,gh,pP,mP,ur=xv(()=>{"use strict";dP=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},qn=dP(),fP=qn.fetch,mh=qn.fetch.bind(qn),gh=qn.Headers,pP=qn.Request,mP=qn.Response});var wh=rt(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});var yh=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};_h.default=yh});var bh=rt(is=>{"use strict";var v_=is&&is.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(is,"__esModule",{value:!0});var yP=v_((ur(),Sv(Cr))),_P=v_(wh()),vh=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch=="undefined"?this.fetch=yP.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let n=this.fetch,i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,l,u;let h=null,f=null,m=null,g=s.status,E=s.statusText;if(s.ok){if(this.method!=="HEAD"){let N=await s.text();N===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=N:f=JSON.parse(N))}let C=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),R=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");C&&R&&R.length>1&&(m=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(h={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,g=406,E="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{let C=await s.text();try{h=JSON.parse(C),Array.isArray(h)&&s.status===404&&(f=[],h=null,g=200,E="OK")}catch{s.status===404&&C===""?(g=204,E="No Content"):h={message:C}}if(h&&this.isMaybeSingle&&(!((u=h==null?void 0:h.details)===null||u===void 0)&&u.includes("0 rows"))&&(h=null,g=200,E="OK"),h&&this.shouldThrowOnError)throw new _P.default(h)}return{error:h,data:f,count:m,status:g,statusText:E}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,l,u;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}};is.default=vh});var Eh=rt(ss=>{"use strict";var wP=ss&&ss.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ss,"__esModule",{value:!0});var vP=wP(bh()),Th=class extends vP.default{select(e){let t=!1,n=(e!=null?e:"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){let a=s?`${s}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){let i=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:i=n}={}){let s=typeof i=="undefined"?"offset":`${i}.offset`,a=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var l;let u=[e?"analyze":null,t?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${h}"; options=${u};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ss.default=Th});var Ca=rt(os=>{"use strict";var bP=os&&os.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(os,"__esModule",{value:!0});var TP=bP(Eh()),Ih=class extends TP.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let n=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");let a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){let i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};os.default=Ih});var xh=rt(ls=>{"use strict";var EP=ls&&ls.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ls,"__esModule",{value:!0});var as=EP(Ca()),Ah=class{constructor(e,{headers:t={},schema:n,fetch:i}){this.url=e,this.headers=t,this.schema=n,this.fetch=i}select(e,{head:t=!1,count:n}={}){let i=t?"HEAD":"GET",s=!1,a=(e!=null?e:"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new as.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){let i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let a=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){let l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new as.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){let a="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){let u=e.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(u.length>0){let h=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new as.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new as.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new as.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ls.default=Ah});var b_=rt(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.version=void 0;ka.version="0.0.0-automated"});var T_=rt(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.DEFAULT_HEADERS=void 0;var IP=b_();Da.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${IP.version}`}});var I_=rt(us=>{"use strict";var E_=us&&us.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(us,"__esModule",{value:!0});var AP=E_(xh()),xP=E_(Ca()),SP=T_(),Sh=class r{constructor(e,{headers:t={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},SP.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=i}from(e){let t=new URL(`${this.url}/${e}`);return new AP.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new r(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:i=!1,count:s}={}){let a,l=new URL(`${this.url}/rpc/${e}`),u;n||i?(a=n?"HEAD":"GET",Object.entries(t).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{l.searchParams.append(f,m)})):(a="POST",u=t);let h=Object.assign({},this.headers);return s&&(h.Prefer=`count=${s}`),new xP.default({method:a,url:l,headers:h,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};us.default=Sh});var k_=rt(Ee=>{"use strict";var zn=Ee&&Ee.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.PostgrestError=Ee.PostgrestBuilder=Ee.PostgrestTransformBuilder=Ee.PostgrestFilterBuilder=Ee.PostgrestQueryBuilder=Ee.PostgrestClient=void 0;var A_=zn(I_());Ee.PostgrestClient=A_.default;var x_=zn(xh());Ee.PostgrestQueryBuilder=x_.default;var S_=zn(Ca());Ee.PostgrestFilterBuilder=S_.default;var R_=zn(Eh());Ee.PostgrestTransformBuilder=R_.default;var P_=zn(bh());Ee.PostgrestBuilder=P_.default;var C_=zn(wh());Ee.PostgrestError=C_.default;Ee.default={PostgrestClient:A_.default,PostgrestQueryBuilder:x_.default,PostgrestFilterBuilder:S_.default,PostgrestTransformBuilder:R_.default,PostgrestBuilder:P_.default,PostgrestError:C_.default}});var U_=rt((Xj,j_)=>{"use strict";j_.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var Rv=typeof global=="object"&&global&&global.Object===Object&&global,Qs=Rv;var Pv=typeof self=="object"&&self&&self.Object===Object&&self,Cv=Qs||Pv||Function("return this")(),ce=Cv;var kv=ce.Symbol,Ne=kv;var sf=Object.prototype,Dv=sf.hasOwnProperty,Ov=sf.toString,Ii=Ne?Ne.toStringTag:void 0;function Nv(r){var e=Dv.call(r,Ii),t=r[Ii];try{r[Ii]=void 0;var n=!0}catch{}var i=Ov.call(r);return n&&(e?r[Ii]=t:delete r[Ii]),i}var of=Nv;var Vv=Object.prototype,Lv=Vv.toString;function Mv(r){return Lv.call(r)}var af=Mv;var Fv="[object Null]",jv="[object Undefined]",lf=Ne?Ne.toStringTag:void 0;function Uv(r){return r==null?r===void 0?jv:Fv:lf&&lf in Object(r)?of(r):af(r)}var Xe=Uv;function Bv(r){return r!=null&&typeof r=="object"}var Ve=Bv;var $v="[object Symbol]";function qv(r){return typeof r=="symbol"||Ve(r)&&Xe(r)==$v}var $t=qv;function zv(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var uf=zv;var Gv=Array.isArray,de=Gv;var Kv=1/0,cf=Ne?Ne.prototype:void 0,hf=cf?cf.toString:void 0;function df(r){if(typeof r=="string")return r;if(de(r))return uf(r,df)+"";if($t(r))return hf?hf.call(r):"";var e=r+"";return e=="0"&&1/r==-Kv?"-0":e}var ff=df;var Hv=/\s/;function Wv(r){for(var e=r.length;e--&&Hv.test(r.charAt(e)););return e}var pf=Wv;var Qv=/^\s+/;function Jv(r){return r&&r.slice(0,pf(r)+1).replace(Qv,"")}var mf=Jv;function Yv(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Z=Yv;var gf=NaN,Xv=/^[-+]0x[0-9a-f]+$/i,Zv=/^0b[01]+$/i,eb=/^0o[0-7]+$/i,tb=parseInt;function rb(r){if(typeof r=="number")return r;if($t(r))return gf;if(Z(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Z(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=mf(r);var t=Zv.test(r);return t||eb.test(r)?tb(r.slice(2),t?2:8):Xv.test(r)?gf:+r}var Al=rb;function nb(r){return r}var Qr=nb;var ib="[object AsyncFunction]",sb="[object Function]",ob="[object GeneratorFunction]",ab="[object Proxy]";function lb(r){if(!Z(r))return!1;var e=Xe(r);return e==sb||e==ob||e==ib||e==ab}var Js=lb;var ub=ce["__core-js_shared__"],Ys=ub;var yf=function(){var r=/[^.]+$/.exec(Ys&&Ys.keys&&Ys.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function cb(r){return!!yf&&yf in r}var _f=cb;var hb=Function.prototype,db=hb.toString;function fb(r){if(r!=null){try{return db.call(r)}catch{}try{return r+""}catch{}}return""}var vt=fb;var pb=/[\\^$.*+?()[\]{}|]/g,mb=/^\[object .+?Constructor\]$/,gb=Function.prototype,yb=Object.prototype,_b=gb.toString,wb=yb.hasOwnProperty,vb=RegExp("^"+_b.call(wb).replace(pb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bb(r){if(!Z(r)||_f(r))return!1;var e=Js(r)?vb:mb;return e.test(vt(r))}var wf=bb;function Tb(r,e){return r==null?void 0:r[e]}var vf=Tb;function Eb(r,e){var t=vf(r,e);return wf(t)?t:void 0}var Fe=Eb;var Ib=Fe(ce,"WeakMap"),Xs=Ib;var bf=Object.create,Ab=function(){function r(){}return function(e){if(!Z(e))return{};if(bf)return bf(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}(),Tf=Ab;function xb(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var Ef=xb;function Sb(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var If=Sb;var Rb=800,Pb=16,Cb=Date.now;function kb(r){var e=0,t=0;return function(){var n=Cb(),i=Pb-(n-t);if(t=n,i>0){if(++e>=Rb)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var Af=kb;function Db(r){return function(){return r}}var xf=Db;var Ob=function(){try{var r=Fe(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Jr=Ob;var Nb=Jr?function(r,e){return Jr(r,"toString",{configurable:!0,enumerable:!1,value:xf(e),writable:!0})}:Qr,Sf=Nb;var Vb=Af(Sf),Rf=Vb;function Lb(r,e){for(var t=-1,n=r==null?0:r.length;++t<n&&e(r[t],t,r)!==!1;);return r}var Pf=Lb;var Mb=9007199254740991,Fb=/^(?:0|[1-9]\d*)$/;function jb(r,e){var t=typeof r;return e=e==null?Mb:e,!!e&&(t=="number"||t!="symbol"&&Fb.test(r))&&r>-1&&r%1==0&&r<e}var qt=jb;function Ub(r,e,t){e=="__proto__"&&Jr?Jr(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var Yr=Ub;function Bb(r,e){return r===e||r!==r&&e!==e}var nt=Bb;var $b=Object.prototype,qb=$b.hasOwnProperty;function zb(r,e,t){var n=r[e];(!(qb.call(r,e)&&nt(n,t))||t===void 0&&!(e in r))&&Yr(r,e,t)}var Xr=zb;function Gb(r,e,t,n){var i=!t;t||(t={});for(var s=-1,a=e.length;++s<a;){var l=e[s],u=n?n(t[l],r[l],l,t,r):void 0;u===void 0&&(u=r[l]),i?Yr(t,l,u):Xr(t,l,u)}return t}var zt=Gb;var Cf=Math.max;function Kb(r,e,t){return e=Cf(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,s=Cf(n.length-e,0),a=Array(s);++i<s;)a[i]=n[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=n[i];return l[e]=t(a),Ef(r,this,l)}}var kf=Kb;function Hb(r,e){return Rf(kf(r,e,Qr),r+"")}var Df=Hb;var Wb=9007199254740991;function Qb(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Wb}var Zr=Qb;function Jb(r){return r!=null&&Zr(r.length)&&!Js(r)}var Gt=Jb;function Yb(r,e,t){if(!Z(t))return!1;var n=typeof e;return(n=="number"?Gt(t)&&qt(e,t.length):n=="string"&&e in t)?nt(t[e],r):!1}var Of=Yb;var Xb=Object.prototype;function Zb(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Xb;return r===t}var Kt=Zb;function eT(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var Nf=eT;var tT="[object Arguments]";function rT(r){return Ve(r)&&Xe(r)==tT}var xl=rT;var Vf=Object.prototype,nT=Vf.hasOwnProperty,iT=Vf.propertyIsEnumerable,sT=xl(function(){return arguments}())?xl:function(r){return Ve(r)&&nT.call(r,"callee")&&!iT.call(r,"callee")},en=sT;function oT(){return!1}var Lf=oT;var jf=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mf=jf&&typeof module=="object"&&module&&!module.nodeType&&module,aT=Mf&&Mf.exports===jf,Ff=aT?ce.Buffer:void 0,lT=Ff?Ff.isBuffer:void 0,uT=lT||Lf,bt=uT;var cT="[object Arguments]",hT="[object Array]",dT="[object Boolean]",fT="[object Date]",pT="[object Error]",mT="[object Function]",gT="[object Map]",yT="[object Number]",_T="[object Object]",wT="[object RegExp]",vT="[object Set]",bT="[object String]",TT="[object WeakMap]",ET="[object ArrayBuffer]",IT="[object DataView]",AT="[object Float32Array]",xT="[object Float64Array]",ST="[object Int8Array]",RT="[object Int16Array]",PT="[object Int32Array]",CT="[object Uint8Array]",kT="[object Uint8ClampedArray]",DT="[object Uint16Array]",OT="[object Uint32Array]",se={};se[AT]=se[xT]=se[ST]=se[RT]=se[PT]=se[CT]=se[kT]=se[DT]=se[OT]=!0;se[cT]=se[hT]=se[ET]=se[dT]=se[IT]=se[fT]=se[pT]=se[mT]=se[gT]=se[yT]=se[_T]=se[wT]=se[vT]=se[bT]=se[TT]=!1;function NT(r){return Ve(r)&&Zr(r.length)&&!!se[Xe(r)]}var Uf=NT;function VT(r){return function(e){return r(e)}}var tn=VT;var Bf=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ai=Bf&&typeof module=="object"&&module&&!module.nodeType&&module,LT=Ai&&Ai.exports===Bf,Sl=LT&&Qs.process,MT=function(){try{var r=Ai&&Ai.require&&Ai.require("util").types;return r||Sl&&Sl.binding&&Sl.binding("util")}catch{}}(),Tt=MT;var $f=Tt&&Tt.isTypedArray,FT=$f?tn($f):Uf,rn=FT;var jT=Object.prototype,UT=jT.hasOwnProperty;function BT(r,e){var t=de(r),n=!t&&en(r),i=!t&&!n&&bt(r),s=!t&&!n&&!i&&rn(r),a=t||n||i||s,l=a?Nf(r.length,String):[],u=l.length;for(var h in r)(e||UT.call(r,h))&&!(a&&(h=="length"||i&&(h=="offset"||h=="parent")||s&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||qt(h,u)))&&l.push(h);return l}var Zs=BT;function $T(r,e){return function(t){return r(e(t))}}var eo=$T;var qT=eo(Object.keys,Object),qf=qT;var zT=Object.prototype,GT=zT.hasOwnProperty;function KT(r){if(!Kt(r))return qf(r);var e=[];for(var t in Object(r))GT.call(r,t)&&t!="constructor"&&e.push(t);return e}var to=KT;function HT(r){return Gt(r)?Zs(r):to(r)}var Pe=HT;function WT(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}var zf=WT;var QT=Object.prototype,JT=QT.hasOwnProperty;function YT(r){if(!Z(r))return zf(r);var e=Kt(r),t=[];for(var n in r)n=="constructor"&&(e||!JT.call(r,n))||t.push(n);return t}var Gf=YT;function XT(r){return Gt(r)?Zs(r,!0):Gf(r)}var Ht=XT;var ZT=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eE=/^\w*$/;function tE(r,e){if(de(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||$t(r)?!0:eE.test(r)||!ZT.test(r)||e!=null&&r in Object(e)}var nn=tE;var rE=Fe(Object,"create"),Et=rE;function nE(){this.__data__=Et?Et(null):{},this.size=0}var Kf=nE;function iE(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var Hf=iE;var sE="__lodash_hash_undefined__",oE=Object.prototype,aE=oE.hasOwnProperty;function lE(r){var e=this.__data__;if(Et){var t=e[r];return t===sE?void 0:t}return aE.call(e,r)?e[r]:void 0}var Wf=lE;var uE=Object.prototype,cE=uE.hasOwnProperty;function hE(r){var e=this.__data__;return Et?e[r]!==void 0:cE.call(e,r)}var Qf=hE;var dE="__lodash_hash_undefined__";function fE(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Et&&e===void 0?dE:e,this}var Jf=fE;function sn(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}sn.prototype.clear=Kf;sn.prototype.delete=Hf;sn.prototype.get=Wf;sn.prototype.has=Qf;sn.prototype.set=Jf;var Rl=sn;function pE(){this.__data__=[],this.size=0}var Yf=pE;function mE(r,e){for(var t=r.length;t--;)if(nt(r[t][0],e))return t;return-1}var Wt=mE;var gE=Array.prototype,yE=gE.splice;function _E(r){var e=this.__data__,t=Wt(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():yE.call(e,t,1),--this.size,!0}var Xf=_E;function wE(r){var e=this.__data__,t=Wt(e,r);return t<0?void 0:e[t][1]}var Zf=wE;function vE(r){return Wt(this.__data__,r)>-1}var ep=vE;function bE(r,e){var t=this.__data__,n=Wt(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var tp=bE;function on(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}on.prototype.clear=Yf;on.prototype.delete=Xf;on.prototype.get=Zf;on.prototype.has=ep;on.prototype.set=tp;var Qt=on;var TE=Fe(ce,"Map"),Jt=TE;function EE(){this.size=0,this.__data__={hash:new Rl,map:new(Jt||Qt),string:new Rl}}var rp=EE;function IE(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var np=IE;function AE(r,e){var t=r.__data__;return np(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Yt=AE;function xE(r){var e=Yt(this,r).delete(r);return this.size-=e?1:0,e}var ip=xE;function SE(r){return Yt(this,r).get(r)}var sp=SE;function RE(r){return Yt(this,r).has(r)}var op=RE;function PE(r,e){var t=Yt(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var ap=PE;function an(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}an.prototype.clear=rp;an.prototype.delete=ip;an.prototype.get=sp;an.prototype.has=op;an.prototype.set=ap;var yr=an;var CE="Expected a function";function Pl(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(CE);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=t.cache;if(s.has(i))return s.get(i);var a=r.apply(this,n);return t.cache=s.set(i,a)||s,a};return t.cache=new(Pl.Cache||yr),t}Pl.Cache=yr;var lp=Pl;var kE=500;function DE(r){var e=lp(r,function(n){return t.size===kE&&t.clear(),n}),t=e.cache;return e}var up=DE;var OE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,NE=/\\(\\)?/g,VE=up(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(OE,function(t,n,i,s){e.push(i?s.replace(NE,"$1"):n||t)}),e}),cp=VE;function LE(r){return r==null?"":ff(r)}var hp=LE;function ME(r,e){return de(r)?r:nn(r,e)?[r]:cp(hp(r))}var ln=ME;var FE=1/0;function jE(r){if(typeof r=="string"||$t(r))return r;var e=r+"";return e=="0"&&1/r==-FE?"-0":e}var it=jE;function UE(r,e){e=ln(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[it(e[t++])];return t&&t==n?r:void 0}var ro=UE;function BE(r,e,t){var n=r==null?void 0:ro(r,e);return n===void 0?t:n}var xi=BE;function $E(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var no=$E;var qE=eo(Object.getPrototypeOf,Object),io=qE;function zE(){this.__data__=new Qt,this.size=0}var dp=zE;function GE(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var fp=GE;function KE(r){return this.__data__.get(r)}var pp=KE;function HE(r){return this.__data__.has(r)}var mp=HE;var WE=200;function QE(r,e){var t=this.__data__;if(t instanceof Qt){var n=t.__data__;if(!Jt||n.length<WE-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new yr(n)}return t.set(r,e),this.size=t.size,this}var gp=QE;function un(r){var e=this.__data__=new Qt(r);this.size=e.size}un.prototype.clear=dp;un.prototype.delete=fp;un.prototype.get=pp;un.prototype.has=mp;un.prototype.set=gp;var Xt=un;function JE(r,e){return r&&zt(e,Pe(e),r)}var yp=JE;function YE(r,e){return r&&zt(e,Ht(e),r)}var _p=YE;var Tp=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wp=Tp&&typeof module=="object"&&module&&!module.nodeType&&module,XE=wp&&wp.exports===Tp,vp=XE?ce.Buffer:void 0,bp=vp?vp.allocUnsafe:void 0;function ZE(r,e){if(e)return r.slice();var t=r.length,n=bp?bp(t):new r.constructor(t);return r.copy(n),n}var Ep=ZE;function e0(r,e){for(var t=-1,n=r==null?0:r.length,i=0,s=[];++t<n;){var a=r[t];e(a,t,r)&&(s[i++]=a)}return s}var Ip=e0;function t0(){return[]}var so=t0;var r0=Object.prototype,n0=r0.propertyIsEnumerable,Ap=Object.getOwnPropertySymbols,i0=Ap?function(r){return r==null?[]:(r=Object(r),Ip(Ap(r),function(e){return n0.call(r,e)}))}:so,cn=i0;function s0(r,e){return zt(r,cn(r),e)}var xp=s0;var o0=Object.getOwnPropertySymbols,a0=o0?function(r){for(var e=[];r;)no(e,cn(r)),r=io(r);return e}:so,oo=a0;function l0(r,e){return zt(r,oo(r),e)}var Sp=l0;function u0(r,e,t){var n=e(r);return de(r)?n:no(n,t(r))}var ao=u0;function c0(r){return ao(r,Pe,cn)}var Si=c0;function h0(r){return ao(r,Ht,oo)}var Rp=h0;var d0=Fe(ce,"DataView"),lo=d0;var f0=Fe(ce,"Promise"),uo=f0;var p0=Fe(ce,"Set"),co=p0;var Pp="[object Map]",m0="[object Object]",Cp="[object Promise]",kp="[object Set]",Dp="[object WeakMap]",Op="[object DataView]",g0=vt(lo),y0=vt(Jt),_0=vt(uo),w0=vt(co),v0=vt(Xs),_r=Xe;(lo&&_r(new lo(new ArrayBuffer(1)))!=Op||Jt&&_r(new Jt)!=Pp||uo&&_r(uo.resolve())!=Cp||co&&_r(new co)!=kp||Xs&&_r(new Xs)!=Dp)&&(_r=function(r){var e=Xe(r),t=e==m0?r.constructor:void 0,n=t?vt(t):"";if(n)switch(n){case g0:return Op;case y0:return Pp;case _0:return Cp;case w0:return kp;case v0:return Dp}return e});var Ze=_r;var b0=Object.prototype,T0=b0.hasOwnProperty;function E0(r){var e=r.length,t=new r.constructor(e);return e&&typeof r[0]=="string"&&T0.call(r,"index")&&(t.index=r.index,t.input=r.input),t}var Np=E0;var I0=ce.Uint8Array,hn=I0;function A0(r){var e=new r.constructor(r.byteLength);return new hn(e).set(new hn(r)),e}var dn=A0;function x0(r,e){var t=e?dn(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)}var Vp=x0;var S0=/\w*$/;function R0(r){var e=new r.constructor(r.source,S0.exec(r));return e.lastIndex=r.lastIndex,e}var Lp=R0;var Mp=Ne?Ne.prototype:void 0,Fp=Mp?Mp.valueOf:void 0;function P0(r){return Fp?Object(Fp.call(r)):{}}var jp=P0;function C0(r,e){var t=e?dn(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}var Up=C0;var k0="[object Boolean]",D0="[object Date]",O0="[object Map]",N0="[object Number]",V0="[object RegExp]",L0="[object Set]",M0="[object String]",F0="[object Symbol]",j0="[object ArrayBuffer]",U0="[object DataView]",B0="[object Float32Array]",$0="[object Float64Array]",q0="[object Int8Array]",z0="[object Int16Array]",G0="[object Int32Array]",K0="[object Uint8Array]",H0="[object Uint8ClampedArray]",W0="[object Uint16Array]",Q0="[object Uint32Array]";function J0(r,e,t){var n=r.constructor;switch(e){case j0:return dn(r);case k0:case D0:return new n(+r);case U0:return Vp(r,t);case B0:case $0:case q0:case z0:case G0:case K0:case H0:case W0:case Q0:return Up(r,t);case O0:return new n;case N0:case M0:return new n(r);case V0:return Lp(r);case L0:return new n;case F0:return jp(r)}}var Bp=J0;function Y0(r){return typeof r.constructor=="function"&&!Kt(r)?Tf(io(r)):{}}var $p=Y0;var X0="[object Map]";function Z0(r){return Ve(r)&&Ze(r)==X0}var qp=Z0;var zp=Tt&&Tt.isMap,eI=zp?tn(zp):qp,Gp=eI;var tI="[object Set]";function rI(r){return Ve(r)&&Ze(r)==tI}var Kp=rI;var Hp=Tt&&Tt.isSet,nI=Hp?tn(Hp):Kp,Wp=nI;var iI=1,sI=2,oI=4,Qp="[object Arguments]",aI="[object Array]",lI="[object Boolean]",uI="[object Date]",cI="[object Error]",Jp="[object Function]",hI="[object GeneratorFunction]",dI="[object Map]",fI="[object Number]",Yp="[object Object]",pI="[object RegExp]",mI="[object Set]",gI="[object String]",yI="[object Symbol]",_I="[object WeakMap]",wI="[object ArrayBuffer]",vI="[object DataView]",bI="[object Float32Array]",TI="[object Float64Array]",EI="[object Int8Array]",II="[object Int16Array]",AI="[object Int32Array]",xI="[object Uint8Array]",SI="[object Uint8ClampedArray]",RI="[object Uint16Array]",PI="[object Uint32Array]",re={};re[Qp]=re[aI]=re[wI]=re[vI]=re[lI]=re[uI]=re[bI]=re[TI]=re[EI]=re[II]=re[AI]=re[dI]=re[fI]=re[Yp]=re[pI]=re[mI]=re[gI]=re[yI]=re[xI]=re[SI]=re[RI]=re[PI]=!0;re[cI]=re[Jp]=re[_I]=!1;function ho(r,e,t,n,i,s){var a,l=e&iI,u=e&sI,h=e&oI;if(t&&(a=i?t(r,n,i,s):t(r)),a!==void 0)return a;if(!Z(r))return r;var f=de(r);if(f){if(a=Np(r),!l)return If(r,a)}else{var m=Ze(r),g=m==Jp||m==hI;if(bt(r))return Ep(r,l);if(m==Yp||m==Qp||g&&!i){if(a=u||g?{}:$p(r),!l)return u?Sp(r,_p(a,r)):xp(r,yp(a,r))}else{if(!re[m])return i?r:{};a=Bp(r,m,l)}}s||(s=new Xt);var E=s.get(r);if(E)return E;s.set(r,a),Wp(r)?r.forEach(function(R){a.add(ho(R,e,t,R,r,s))}):Gp(r)&&r.forEach(function(R,N){a.set(N,ho(R,e,t,N,r,s))});var P=h?u?Rp:Si:u?Ht:Pe,C=f?void 0:P(r);return Pf(C||r,function(R,N){C&&(N=R,R=r[N]),Xr(a,N,ho(R,e,t,N,r,s))}),a}var Xp=ho;var CI=1,kI=4;function DI(r){return Xp(r,CI|kI)}var Zt=DI;var OI="__lodash_hash_undefined__";function NI(r){return this.__data__.set(r,OI),this}var Zp=NI;function VI(r){return this.__data__.has(r)}var em=VI;function fo(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new yr;++e<t;)this.add(r[e])}fo.prototype.add=fo.prototype.push=Zp;fo.prototype.has=em;var tm=fo;function LI(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var rm=LI;function MI(r,e){return r.has(e)}var nm=MI;var FI=1,jI=2;function UI(r,e,t,n,i,s){var a=t&FI,l=r.length,u=e.length;if(l!=u&&!(a&&u>l))return!1;var h=s.get(r),f=s.get(e);if(h&&f)return h==e&&f==r;var m=-1,g=!0,E=t&jI?new tm:void 0;for(s.set(r,e),s.set(e,r);++m<l;){var P=r[m],C=e[m];if(n)var R=a?n(C,P,m,e,r,s):n(P,C,m,r,e,s);if(R!==void 0){if(R)continue;g=!1;break}if(E){if(!rm(e,function(N,M){if(!nm(E,M)&&(P===N||i(P,N,t,n,s)))return E.push(M)})){g=!1;break}}else if(!(P===C||i(P,C,t,n,s))){g=!1;break}}return s.delete(r),s.delete(e),g}var po=UI;function BI(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var im=BI;function $I(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var sm=$I;var qI=1,zI=2,GI="[object Boolean]",KI="[object Date]",HI="[object Error]",WI="[object Map]",QI="[object Number]",JI="[object RegExp]",YI="[object Set]",XI="[object String]",ZI="[object Symbol]",eA="[object ArrayBuffer]",tA="[object DataView]",om=Ne?Ne.prototype:void 0,Cl=om?om.valueOf:void 0;function rA(r,e,t,n,i,s,a){switch(t){case tA:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case eA:return!(r.byteLength!=e.byteLength||!s(new hn(r),new hn(e)));case GI:case KI:case QI:return nt(+r,+e);case HI:return r.name==e.name&&r.message==e.message;case JI:case XI:return r==e+"";case WI:var l=im;case YI:var u=n&qI;if(l||(l=sm),r.size!=e.size&&!u)return!1;var h=a.get(r);if(h)return h==e;n|=zI,a.set(r,e);var f=po(l(r),l(e),n,i,s,a);return a.delete(r),f;case ZI:if(Cl)return Cl.call(r)==Cl.call(e)}return!1}var am=rA;var nA=1,iA=Object.prototype,sA=iA.hasOwnProperty;function oA(r,e,t,n,i,s){var a=t&nA,l=Si(r),u=l.length,h=Si(e),f=h.length;if(u!=f&&!a)return!1;for(var m=u;m--;){var g=l[m];if(!(a?g in e:sA.call(e,g)))return!1}var E=s.get(r),P=s.get(e);if(E&&P)return E==e&&P==r;var C=!0;s.set(r,e),s.set(e,r);for(var R=a;++m<u;){g=l[m];var N=r[g],M=e[g];if(n)var U=a?n(M,N,g,e,r,s):n(N,M,g,r,e,s);if(!(U===void 0?N===M||i(N,M,t,n,s):U)){C=!1;break}R||(R=g=="constructor")}if(C&&!R){var G=r.constructor,Y=e.constructor;G!=Y&&"constructor"in r&&"constructor"in e&&!(typeof G=="function"&&G instanceof G&&typeof Y=="function"&&Y instanceof Y)&&(C=!1)}return s.delete(r),s.delete(e),C}var lm=oA;var aA=1,um="[object Arguments]",cm="[object Array]",mo="[object Object]",lA=Object.prototype,hm=lA.hasOwnProperty;function uA(r,e,t,n,i,s){var a=de(r),l=de(e),u=a?cm:Ze(r),h=l?cm:Ze(e);u=u==um?mo:u,h=h==um?mo:h;var f=u==mo,m=h==mo,g=u==h;if(g&&bt(r)){if(!bt(e))return!1;a=!0,f=!1}if(g&&!f)return s||(s=new Xt),a||rn(r)?po(r,e,t,n,i,s):am(r,e,u,t,n,i,s);if(!(t&aA)){var E=f&&hm.call(r,"__wrapped__"),P=m&&hm.call(e,"__wrapped__");if(E||P){var C=E?r.value():r,R=P?e.value():e;return s||(s=new Xt),i(C,R,t,n,s)}}return g?(s||(s=new Xt),lm(r,e,t,n,i,s)):!1}var dm=uA;function fm(r,e,t,n,i){return r===e?!0:r==null||e==null||!Ve(r)&&!Ve(e)?r!==r&&e!==e:dm(r,e,t,n,fm,i)}var fn=fm;var cA=1,hA=2;function dA(r,e,t,n){var i=t.length,s=i,a=!n;if(r==null)return!s;for(r=Object(r);i--;){var l=t[i];if(a&&l[2]?l[1]!==r[l[0]]:!(l[0]in r))return!1}for(;++i<s;){l=t[i];var u=l[0],h=r[u],f=l[1];if(a&&l[2]){if(h===void 0&&!(u in r))return!1}else{var m=new Xt;if(n)var g=n(h,f,u,r,e,m);if(!(g===void 0?fn(f,h,cA|hA,n,m):g))return!1}}return!0}var pm=dA;function fA(r){return r===r&&!Z(r)}var go=fA;function pA(r){for(var e=Pe(r),t=e.length;t--;){var n=e[t],i=r[n];e[t]=[n,i,go(i)]}return e}var mm=pA;function mA(r,e){return function(t){return t==null?!1:t[r]===e&&(e!==void 0||r in Object(t))}}var yo=mA;function gA(r){var e=mm(r);return e.length==1&&e[0][2]?yo(e[0][0],e[0][1]):function(t){return t===r||pm(t,r,e)}}var gm=gA;function yA(r,e){return r!=null&&e in Object(r)}var ym=yA;function _A(r,e,t){e=ln(e,r);for(var n=-1,i=e.length,s=!1;++n<i;){var a=it(e[n]);if(!(s=r!=null&&t(r,a)))break;r=r[a]}return s||++n!=i?s:(i=r==null?0:r.length,!!i&&Zr(i)&&qt(a,i)&&(de(r)||en(r)))}var _m=_A;function wA(r,e){return r!=null&&_m(r,e,ym)}var wm=wA;var vA=1,bA=2;function TA(r,e){return nn(r)&&go(e)?yo(it(r),e):function(t){var n=xi(t,r);return n===void 0&&n===e?wm(t,r):fn(e,n,vA|bA)}}var vm=TA;function EA(r){return function(e){return e==null?void 0:e[r]}}var bm=EA;function IA(r){return function(e){return ro(e,r)}}var Tm=IA;function AA(r){return nn(r)?bm(it(r)):Tm(r)}var Em=AA;function xA(r){return typeof r=="function"?r:r==null?Qr:typeof r=="object"?de(r)?vm(r[0],r[1]):gm(r):Em(r)}var Im=xA;function SA(r){return function(e,t,n){for(var i=-1,s=Object(e),a=n(e),l=a.length;l--;){var u=a[r?l:++i];if(t(s[u],u,s)===!1)break}return e}}var Am=SA;var RA=Am(),xm=RA;function PA(r,e){return r&&xm(r,e,Pe)}var Sm=PA;var CA=function(){return ce.Date.now()},_o=CA;var kA="Expected a function",DA=Math.max,OA=Math.min;function NA(r,e,t){var n,i,s,a,l,u,h=0,f=!1,m=!1,g=!0;if(typeof r!="function")throw new TypeError(kA);e=Al(e)||0,Z(t)&&(f=!!t.leading,m="maxWait"in t,s=m?DA(Al(t.maxWait)||0,e):s,g="trailing"in t?!!t.trailing:g);function E(B){var T=n,y=i;return n=i=void 0,h=B,a=r.apply(y,T),a}function P(B){return h=B,l=setTimeout(N,e),f?E(B):a}function C(B){var T=B-u,y=B-h,w=e-T;return m?OA(w,s-y):w}function R(B){var T=B-u,y=B-h;return u===void 0||T>=e||T<0||m&&y>=s}function N(){var B=_o();if(R(B))return M(B);l=setTimeout(N,C(B))}function M(B){return l=void 0,g&&n?E(B):(n=i=void 0,a)}function U(){l!==void 0&&clearTimeout(l),h=0,n=u=i=l=void 0}function G(){return l===void 0?a:M(_o())}function Y(){var B=_o(),T=R(B);if(n=arguments,i=this,u=B,T){if(l===void 0)return P(u);if(m)return clearTimeout(l),l=setTimeout(N,e),E(u)}return l===void 0&&(l=setTimeout(N,e)),a}return Y.cancel=U,Y.flush=G,Y}var Rm=NA;var Pm=Object.prototype,VA=Pm.hasOwnProperty,LA=Df(function(r,e){r=Object(r);var t=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&Of(e[0],e[1],i)&&(n=1);++t<n;)for(var s=e[t],a=Ht(s),l=-1,u=a.length;++l<u;){var h=a[l],f=r[h];(f===void 0||nt(f,Pm[h])&&!VA.call(r,h))&&(r[h]=s[h])}return r}),wo=LA;var MA="[object Map]",FA="[object Set]",jA=Object.prototype,UA=jA.hasOwnProperty;function BA(r){if(r==null)return!0;if(Gt(r)&&(de(r)||typeof r=="string"||typeof r.splice=="function"||bt(r)||rn(r)||en(r)))return!r.length;var e=Ze(r);if(e==MA||e==FA)return!r.size;if(Kt(r))return!to(r).length;for(var t in r)if(UA.call(r,t))return!1;return!0}var kl=BA;function $A(r,e){return fn(r,e)}var Dl=$A;function qA(r,e){var t={};return e=Im(e,3),Sm(r,function(n,i,s){Yr(t,e(n,i,s),n)}),t}var Ol=qA;function zA(r,e,t,n){if(!Z(r))return r;e=ln(e,r);for(var i=-1,s=e.length,a=s-1,l=r;l!=null&&++i<s;){var u=it(e[i]),h=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(i!=a){var f=l[u];h=n?n(f,u,l):void 0,h===void 0&&(h=Z(f)?f:qt(e[i+1])?[]:{})}Xr(l,u,h),l=l[u]}return r}var Cm=zA;function GA(r,e,t){return r==null?r:Cm(r,e,t)}var er=GA;var KA="Expected a function";function HA(r,e,t){var n=!0,i=!0;if(typeof r!="function")throw new TypeError(KA);return Z(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),Rm(r,e,{leading:n,maxWait:e,trailing:i})}var Nl=HA;var Dm=function(r){let e=[],t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},WA=function(r){let e=[],t=0,n=0;for(;t<r.length;){let i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=r[t++],a=r[t++],l=r[t++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{let s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Om={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){let s=r[i],a=i+1<r.length,l=a?r[i+1]:0,u=i+2<r.length,h=u?r[i+2]:0,f=s>>2,m=(s&3)<<4|l>>4,g=(l&15)<<2|h>>6,E=h&63;u||(E=64,a||(g=64)),n.push(t[f],t[m],t[g],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Dm(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):WA(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){let s=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;let h=i<r.length?t[r.charAt(i)]:64;++i;let m=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new Vl;let g=s<<2|l>>4;if(n.push(g),h!==64){let E=l<<4&240|h>>2;if(n.push(E),m!==64){let P=h<<6&192|m;n.push(P)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}},Vl=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},QA=function(r){let e=Dm(r);return Om.encodeByteArray(e,!0)},Ri=function(r){return QA(r).replace(/\./g,"")},Nm=function(r){try{return Om.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JA(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}var YA=()=>JA().__FIREBASE_DEFAULTS__,XA=()=>{if(typeof process=="undefined"||typeof process.env=="undefined")return;let r=process.env.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},ZA=()=>{if(typeof document=="undefined")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=r&&Nm(r[1]);return e&&JSON.parse(e)},Ll=()=>{try{return YA()||XA()||ZA()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},ex=r=>{var e,t;return(t=(e=Ll())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},Vm=r=>{let e=ex(r);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Ml=()=>{var r;return(r=Ll())===null||r===void 0?void 0:r.config};var vo=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};function Lm(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Ri(JSON.stringify(t)),Ri(JSON.stringify(a)),""].join(".")}function Mm(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tx(){var r;let e=(r=Ll())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Fm(){return!tx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fl(){try{return typeof indexedDB=="object"}catch{return!1}}function jm(){return new Promise((r,e)=>{try{let t=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var rx="FirebaseError",It=class r extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=rx,Object.setPrototypeOf(this,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pi.prototype.create)}},Pi=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?nx(s,n):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new It(i,l,n)}};function nx(r,e){return r.replace(ix,(t,n)=>{let i=e[n];return i!=null?String(i):`<${n}?>`})}var ix=/\{\$([^}]+)}/g;function Ci(r,e){if(r===e)return!0;let t=Object.keys(r),n=Object.keys(e);for(let i of t){if(!n.includes(i))return!1;let s=r[i],a=e[i];if(km(s)&&km(a)){if(!Ci(s,a))return!1}else if(s!==a)return!1}for(let i of n)if(!t.includes(i))return!1;return!0}function km(r){return r!==null&&typeof r=="object"}var CF=4*60*60*1e3;function At(r){return r&&r._delegate?r._delegate:r}var xt=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var wr="[DEFAULT]";var jl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let n=new vo;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ox(e))try{this.getOrInitializeService({instanceIdentifier:wr})}catch{}for(let[t,n]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=wr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wr){return this.instances.has(e)}getOptions(e=wr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[s,a]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(s);n===l&&a.resolve(i)}return i}onInit(e,t){var n;let i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:sx(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=wr){return this.component?this.component.multipleInstances?e:wr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function sx(r){return r===wr?void 0:r}function ox(r){return r.instantiationMode==="EAGER"}var bo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new jl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var ax=[],W;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(W||(W={}));var lx={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},ux=W.INFO,cx={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},hx=(r,e,...t)=>{if(e<r.logLevel)return;let n=new Date().toISOString(),i=cx[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},pn=class{constructor(e){this.name=e,this._logLevel=ux,this._logHandler=hx,this._userLogHandler=null,ax.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lx[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var dx=(r,e)=>e.some(t=>r instanceof t),Um,Bm;function fx(){return Um||(Um=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function px(){return Bm||(Bm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var $m=new WeakMap,Bl=new WeakMap,qm=new WeakMap,Ul=new WeakMap,ql=new WeakMap;function mx(r){let e=new Promise((t,n)=>{let i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(st(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&$m.set(t,r)}).catch(()=>{}),ql.set(e,r),e}function gx(r){if(Bl.has(r))return;let e=new Promise((t,n)=>{let i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});Bl.set(r,e)}var $l={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Bl.get(r);if(e==="objectStoreNames")return r.objectStoreNames||qm.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return st(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function zm(r){$l=r($l)}function yx(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let n=r.call(To(this),e,...t);return qm.set(n,e.sort?e.sort():[e]),st(n)}:px().includes(r)?function(...e){return r.apply(To(this),e),st($m.get(this))}:function(...e){return st(r.apply(To(this),e))}}function _x(r){return typeof r=="function"?yx(r):(r instanceof IDBTransaction&&gx(r),dx(r,fx())?new Proxy(r,$l):r)}function st(r){if(r instanceof IDBRequest)return mx(r);if(Ul.has(r))return Ul.get(r);let e=_x(r);return e!==r&&(Ul.set(r,e),ql.set(e,r)),e}var To=r=>ql.get(r);function Km(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(r,e),l=st(a);return n&&a.addEventListener("upgradeneeded",u=>{n(st(a.result),u.oldVersion,u.newVersion,st(a.transaction),u)}),t&&a.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}var wx=["get","getKey","getAll","getAllKeys","count"],vx=["put","add","delete","clear"],zl=new Map;function Gm(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(zl.get(e))return zl.get(e);let t=e.replace(/FromIndex$/,""),n=e!==t,i=vx.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||wx.includes(t)))return;let s=async function(a,...l){let u=this.transaction(a,i?"readwrite":"readonly"),h=u.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),i&&u.done]))[0]};return zl.set(e,s),s}zm(r=>({...r,get:(e,t,n)=>Gm(e,t)||r.get(e,t,n),has:(e,t)=>!!Gm(e,t)||r.has(e,t)}));var Kl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(bx(t)){let n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}};function bx(r){let e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}var Hl="@firebase/app",Hm="0.11.1";var St=new pn("@firebase/app"),Tx="@firebase/app-compat",Ex="@firebase/analytics-compat",Ix="@firebase/analytics",Ax="@firebase/app-check-compat",xx="@firebase/app-check",Sx="@firebase/auth",Rx="@firebase/auth-compat",Px="@firebase/database",Cx="@firebase/data-connect",kx="@firebase/database-compat",Dx="@firebase/functions",Ox="@firebase/functions-compat",Nx="@firebase/installations",Vx="@firebase/installations-compat",Lx="@firebase/messaging",Mx="@firebase/messaging-compat",Fx="@firebase/performance",jx="@firebase/performance-compat",Ux="@firebase/remote-config",Bx="@firebase/remote-config-compat",$x="@firebase/storage",qx="@firebase/storage-compat",zx="@firebase/firestore",Gx="@firebase/vertexai",Kx="@firebase/firestore-compat",Hx="firebase",Wx="11.3.1";var Wl="[DEFAULT]",Qx={[Hl]:"fire-core",[Tx]:"fire-core-compat",[Ix]:"fire-analytics",[Ex]:"fire-analytics-compat",[xx]:"fire-app-check",[Ax]:"fire-app-check-compat",[Sx]:"fire-auth",[Rx]:"fire-auth-compat",[Px]:"fire-rtdb",[Cx]:"fire-data-connect",[kx]:"fire-rtdb-compat",[Dx]:"fire-fn",[Ox]:"fire-fn-compat",[Nx]:"fire-iid",[Vx]:"fire-iid-compat",[Lx]:"fire-fcm",[Mx]:"fire-fcm-compat",[Fx]:"fire-perf",[jx]:"fire-perf-compat",[Ux]:"fire-rc",[Bx]:"fire-rc-compat",[$x]:"fire-gcs",[qx]:"fire-gcs-compat",[zx]:"fire-fst",[Kx]:"fire-fst-compat",[Gx]:"fire-vertex","fire-js":"fire-js",[Hx]:"fire-js-all"};var Eo=new Map,Jx=new Map,Ql=new Map;function Wm(r,e){try{r.container.addComponent(e)}catch(t){St.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ki(r){let e=r.name;if(Ql.has(e))return St.debug(`There were multiple attempts to register component ${e}.`),!1;Ql.set(e,r);for(let t of Eo.values())Wm(t,r);for(let t of Jx.values())Wm(t,r);return!0}function Xm(r,e){let t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Zm(r){return r==null?!1:r.settings!==void 0}var Yx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tr=new Pi("app","Firebase",Yx);var Jl=class{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tr.create("app-deleted",{appName:this._name})}};var eg=Wx;function Zl(r,e={}){let t=r;typeof e!="object"&&(e={name:e});let n=Object.assign({name:Wl,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw tr.create("bad-app-name",{appName:String(i)});if(t||(t=Ml()),!t)throw tr.create("no-options");let s=Eo.get(i);if(s){if(Ci(t,s.options)&&Ci(n,s.config))return s;throw tr.create("duplicate-app",{appName:i})}let a=new bo(i);for(let u of Ql.values())a.addComponent(u);let l=new Jl(t,n,a);return Eo.set(i,l),l}function tg(r=Wl){let e=Eo.get(r);if(!e&&r===Wl&&Ml())return Zl();if(!e)throw tr.create("no-app",{appName:r});return e}function rr(r,e,t){var n;let i=(n=Qx[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),St.warn(l.join(" "));return}ki(new xt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Xx="firebase-heartbeat-database",Zx=1,Di="firebase-heartbeat-store",Gl=null;function rg(){return Gl||(Gl=Km(Xx,Zx,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Di)}catch(t){console.warn(t)}}}}).catch(r=>{throw tr.create("idb-open",{originalErrorMessage:r.message})})),Gl}async function eS(r){try{let t=(await rg()).transaction(Di),n=await t.objectStore(Di).get(ng(r));return await t.done,n}catch(e){if(e instanceof It)St.warn(e.message);else{let t=tr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});St.warn(t.message)}}}async function Qm(r,e){try{let n=(await rg()).transaction(Di,"readwrite");await n.objectStore(Di).put(e,ng(r)),await n.done}catch(t){if(t instanceof It)St.warn(t.message);else{let n=tr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});St.warn(n.message)}}}function ng(r){return`${r.name}!${r.options.appId}`}var tS=1024,rS=30,Yl=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Xl(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Jm();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>rS){let a=iS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){St.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Jm(),{heartbeatsToSend:n,unsentEntries:i}=nS(this._heartbeatsCache.heartbeats),s=Ri(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return St.warn(t),""}}};function Jm(){return new Date().toISOString().substring(0,10)}function nS(r,e=tS){let t=[],n=r.slice();for(let i of r){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Ym(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Ym(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}var Xl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fl()?jm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await eS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return Qm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return Qm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function Ym(r){return Ri(JSON.stringify({version:2,heartbeats:r})).length}function iS(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}function sS(r){ki(new xt("platform-logger",e=>new Kl(e),"PRIVATE")),ki(new xt("heartbeat",e=>new Yl(e),"PRIVATE")),rr(Hl,Hm,r),rr(Hl,Hm,"esm2017"),rr("fire-js","")}sS("");var oS="firebase",aS="11.3.1";rr(oS,aS,"app");var ig=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},sg={};var Rt,eu;(function(){var r;function e(T,y){function w(){}w.prototype=y.prototype,T.D=y.prototype,T.prototype=new w,T.prototype.constructor=T,T.C=function(b,I,x){for(var _=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)_[yt-2]=arguments[yt];return y.prototype[I].apply(b,_)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,y,w){w||(w=0);var b=Array(16);if(typeof y=="string")for(var I=0;16>I;++I)b[I]=y.charCodeAt(w++)|y.charCodeAt(w++)<<8|y.charCodeAt(w++)<<16|y.charCodeAt(w++)<<24;else for(I=0;16>I;++I)b[I]=y[w++]|y[w++]<<8|y[w++]<<16|y[w++]<<24;y=T.g[0],w=T.g[1],I=T.g[2];var x=T.g[3],_=y+(x^w&(I^x))+b[0]+3614090360&4294967295;y=w+(_<<7&4294967295|_>>>25),_=x+(I^y&(w^I))+b[1]+3905402710&4294967295,x=y+(_<<12&4294967295|_>>>20),_=I+(w^x&(y^w))+b[2]+606105819&4294967295,I=x+(_<<17&4294967295|_>>>15),_=w+(y^I&(x^y))+b[3]+3250441966&4294967295,w=I+(_<<22&4294967295|_>>>10),_=y+(x^w&(I^x))+b[4]+4118548399&4294967295,y=w+(_<<7&4294967295|_>>>25),_=x+(I^y&(w^I))+b[5]+1200080426&4294967295,x=y+(_<<12&4294967295|_>>>20),_=I+(w^x&(y^w))+b[6]+2821735955&4294967295,I=x+(_<<17&4294967295|_>>>15),_=w+(y^I&(x^y))+b[7]+4249261313&4294967295,w=I+(_<<22&4294967295|_>>>10),_=y+(x^w&(I^x))+b[8]+1770035416&4294967295,y=w+(_<<7&4294967295|_>>>25),_=x+(I^y&(w^I))+b[9]+2336552879&4294967295,x=y+(_<<12&4294967295|_>>>20),_=I+(w^x&(y^w))+b[10]+4294925233&4294967295,I=x+(_<<17&4294967295|_>>>15),_=w+(y^I&(x^y))+b[11]+2304563134&4294967295,w=I+(_<<22&4294967295|_>>>10),_=y+(x^w&(I^x))+b[12]+1804603682&4294967295,y=w+(_<<7&4294967295|_>>>25),_=x+(I^y&(w^I))+b[13]+4254626195&4294967295,x=y+(_<<12&4294967295|_>>>20),_=I+(w^x&(y^w))+b[14]+2792965006&4294967295,I=x+(_<<17&4294967295|_>>>15),_=w+(y^I&(x^y))+b[15]+1236535329&4294967295,w=I+(_<<22&4294967295|_>>>10),_=y+(I^x&(w^I))+b[1]+4129170786&4294967295,y=w+(_<<5&4294967295|_>>>27),_=x+(w^I&(y^w))+b[6]+3225465664&4294967295,x=y+(_<<9&4294967295|_>>>23),_=I+(y^w&(x^y))+b[11]+643717713&4294967295,I=x+(_<<14&4294967295|_>>>18),_=w+(x^y&(I^x))+b[0]+3921069994&4294967295,w=I+(_<<20&4294967295|_>>>12),_=y+(I^x&(w^I))+b[5]+3593408605&4294967295,y=w+(_<<5&4294967295|_>>>27),_=x+(w^I&(y^w))+b[10]+38016083&4294967295,x=y+(_<<9&4294967295|_>>>23),_=I+(y^w&(x^y))+b[15]+3634488961&4294967295,I=x+(_<<14&4294967295|_>>>18),_=w+(x^y&(I^x))+b[4]+3889429448&4294967295,w=I+(_<<20&4294967295|_>>>12),_=y+(I^x&(w^I))+b[9]+568446438&4294967295,y=w+(_<<5&4294967295|_>>>27),_=x+(w^I&(y^w))+b[14]+3275163606&4294967295,x=y+(_<<9&4294967295|_>>>23),_=I+(y^w&(x^y))+b[3]+4107603335&4294967295,I=x+(_<<14&4294967295|_>>>18),_=w+(x^y&(I^x))+b[8]+1163531501&4294967295,w=I+(_<<20&4294967295|_>>>12),_=y+(I^x&(w^I))+b[13]+2850285829&4294967295,y=w+(_<<5&4294967295|_>>>27),_=x+(w^I&(y^w))+b[2]+4243563512&4294967295,x=y+(_<<9&4294967295|_>>>23),_=I+(y^w&(x^y))+b[7]+1735328473&4294967295,I=x+(_<<14&4294967295|_>>>18),_=w+(x^y&(I^x))+b[12]+2368359562&4294967295,w=I+(_<<20&4294967295|_>>>12),_=y+(w^I^x)+b[5]+4294588738&4294967295,y=w+(_<<4&4294967295|_>>>28),_=x+(y^w^I)+b[8]+2272392833&4294967295,x=y+(_<<11&4294967295|_>>>21),_=I+(x^y^w)+b[11]+1839030562&4294967295,I=x+(_<<16&4294967295|_>>>16),_=w+(I^x^y)+b[14]+4259657740&4294967295,w=I+(_<<23&4294967295|_>>>9),_=y+(w^I^x)+b[1]+2763975236&4294967295,y=w+(_<<4&4294967295|_>>>28),_=x+(y^w^I)+b[4]+1272893353&4294967295,x=y+(_<<11&4294967295|_>>>21),_=I+(x^y^w)+b[7]+4139469664&4294967295,I=x+(_<<16&4294967295|_>>>16),_=w+(I^x^y)+b[10]+3200236656&4294967295,w=I+(_<<23&4294967295|_>>>9),_=y+(w^I^x)+b[13]+681279174&4294967295,y=w+(_<<4&4294967295|_>>>28),_=x+(y^w^I)+b[0]+3936430074&4294967295,x=y+(_<<11&4294967295|_>>>21),_=I+(x^y^w)+b[3]+3572445317&4294967295,I=x+(_<<16&4294967295|_>>>16),_=w+(I^x^y)+b[6]+76029189&4294967295,w=I+(_<<23&4294967295|_>>>9),_=y+(w^I^x)+b[9]+3654602809&4294967295,y=w+(_<<4&4294967295|_>>>28),_=x+(y^w^I)+b[12]+3873151461&4294967295,x=y+(_<<11&4294967295|_>>>21),_=I+(x^y^w)+b[15]+530742520&4294967295,I=x+(_<<16&4294967295|_>>>16),_=w+(I^x^y)+b[2]+3299628645&4294967295,w=I+(_<<23&4294967295|_>>>9),_=y+(I^(w|~x))+b[0]+4096336452&4294967295,y=w+(_<<6&4294967295|_>>>26),_=x+(w^(y|~I))+b[7]+1126891415&4294967295,x=y+(_<<10&4294967295|_>>>22),_=I+(y^(x|~w))+b[14]+2878612391&4294967295,I=x+(_<<15&4294967295|_>>>17),_=w+(x^(I|~y))+b[5]+4237533241&4294967295,w=I+(_<<21&4294967295|_>>>11),_=y+(I^(w|~x))+b[12]+1700485571&4294967295,y=w+(_<<6&4294967295|_>>>26),_=x+(w^(y|~I))+b[3]+2399980690&4294967295,x=y+(_<<10&4294967295|_>>>22),_=I+(y^(x|~w))+b[10]+4293915773&4294967295,I=x+(_<<15&4294967295|_>>>17),_=w+(x^(I|~y))+b[1]+2240044497&4294967295,w=I+(_<<21&4294967295|_>>>11),_=y+(I^(w|~x))+b[8]+1873313359&4294967295,y=w+(_<<6&4294967295|_>>>26),_=x+(w^(y|~I))+b[15]+4264355552&4294967295,x=y+(_<<10&4294967295|_>>>22),_=I+(y^(x|~w))+b[6]+2734768916&4294967295,I=x+(_<<15&4294967295|_>>>17),_=w+(x^(I|~y))+b[13]+1309151649&4294967295,w=I+(_<<21&4294967295|_>>>11),_=y+(I^(w|~x))+b[4]+4149444226&4294967295,y=w+(_<<6&4294967295|_>>>26),_=x+(w^(y|~I))+b[11]+3174756917&4294967295,x=y+(_<<10&4294967295|_>>>22),_=I+(y^(x|~w))+b[2]+718787259&4294967295,I=x+(_<<15&4294967295|_>>>17),_=w+(x^(I|~y))+b[9]+3951481745&4294967295,T.g[0]=T.g[0]+y&4294967295,T.g[1]=T.g[1]+(I+(_<<21&4294967295|_>>>11))&4294967295,T.g[2]=T.g[2]+I&4294967295,T.g[3]=T.g[3]+x&4294967295}n.prototype.u=function(T,y){y===void 0&&(y=T.length);for(var w=y-this.blockSize,b=this.B,I=this.h,x=0;x<y;){if(I==0)for(;x<=w;)i(this,T,x),x+=this.blockSize;if(typeof T=="string"){for(;x<y;)if(b[I++]=T.charCodeAt(x++),I==this.blockSize){i(this,b),I=0;break}}else for(;x<y;)if(b[I++]=T[x++],I==this.blockSize){i(this,b),I=0;break}}this.h=I,this.o+=y},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var y=1;y<T.length-8;++y)T[y]=0;var w=8*this.o;for(y=T.length-8;y<T.length;++y)T[y]=w&255,w/=256;for(this.u(T),T=Array(16),y=w=0;4>y;++y)for(var b=0;32>b;b+=8)T[w++]=this.g[y]>>>b&255;return T};function s(T,y){var w=l;return Object.prototype.hasOwnProperty.call(w,T)?w[T]:w[T]=y(T)}function a(T,y){this.h=y;for(var w=[],b=!0,I=T.length-1;0<=I;I--){var x=T[I]|0;b&&x==y||(w[I]=x,b=!1)}this.g=w}var l={};function u(T){return-128<=T&&128>T?s(T,function(y){return new a([y|0],0>y?-1:0)}):new a([T|0],0>T?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return m;if(0>T)return R(h(-T));for(var y=[],w=1,b=0;T>=w;b++)y[b]=T/w|0,w*=4294967296;return new a(y,0)}function f(T,y){if(T.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(T.charAt(0)=="-")return R(f(T.substring(1),y));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=h(Math.pow(y,8)),b=m,I=0;I<T.length;I+=8){var x=Math.min(8,T.length-I),_=parseInt(T.substring(I,I+x),y);8>x?(x=h(Math.pow(y,x)),b=b.j(x).add(h(_))):(b=b.j(w),b=b.add(h(_)))}return b}var m=u(0),g=u(1),E=u(16777216);r=a.prototype,r.m=function(){if(C(this))return-R(this).m();for(var T=0,y=1,w=0;w<this.g.length;w++){var b=this.i(w);T+=(0<=b?b:4294967296+b)*y,y*=4294967296}return T},r.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(P(this))return"0";if(C(this))return"-"+R(this).toString(T);for(var y=h(Math.pow(T,6)),w=this,b="";;){var I=G(w,y).g;w=N(w,I.j(y));var x=((0<w.g.length?w.g[0]:w.h)>>>0).toString(T);if(w=I,P(w))return x+b;for(;6>x.length;)x="0"+x;b=x+b}},r.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function P(T){if(T.h!=0)return!1;for(var y=0;y<T.g.length;y++)if(T.g[y]!=0)return!1;return!0}function C(T){return T.h==-1}r.l=function(T){return T=N(this,T),C(T)?-1:P(T)?0:1};function R(T){for(var y=T.g.length,w=[],b=0;b<y;b++)w[b]=~T.g[b];return new a(w,~T.h).add(g)}r.abs=function(){return C(this)?R(this):this},r.add=function(T){for(var y=Math.max(this.g.length,T.g.length),w=[],b=0,I=0;I<=y;I++){var x=b+(this.i(I)&65535)+(T.i(I)&65535),_=(x>>>16)+(this.i(I)>>>16)+(T.i(I)>>>16);b=_>>>16,x&=65535,_&=65535,w[I]=_<<16|x}return new a(w,w[w.length-1]&-2147483648?-1:0)};function N(T,y){return T.add(R(y))}r.j=function(T){if(P(this)||P(T))return m;if(C(this))return C(T)?R(this).j(R(T)):R(R(this).j(T));if(C(T))return R(this.j(R(T)));if(0>this.l(E)&&0>T.l(E))return h(this.m()*T.m());for(var y=this.g.length+T.g.length,w=[],b=0;b<2*y;b++)w[b]=0;for(b=0;b<this.g.length;b++)for(var I=0;I<T.g.length;I++){var x=this.i(b)>>>16,_=this.i(b)&65535,yt=T.i(I)>>>16,ii=T.i(I)&65535;w[2*b+2*I]+=_*ii,M(w,2*b+2*I),w[2*b+2*I+1]+=x*ii,M(w,2*b+2*I+1),w[2*b+2*I+1]+=_*yt,M(w,2*b+2*I+1),w[2*b+2*I+2]+=x*yt,M(w,2*b+2*I+2)}for(b=0;b<y;b++)w[b]=w[2*b+1]<<16|w[2*b];for(b=y;b<2*y;b++)w[b]=0;return new a(w,0)};function M(T,y){for(;(T[y]&65535)!=T[y];)T[y+1]+=T[y]>>>16,T[y]&=65535,y++}function U(T,y){this.g=T,this.h=y}function G(T,y){if(P(y))throw Error("division by zero");if(P(T))return new U(m,m);if(C(T))return y=G(R(T),y),new U(R(y.g),R(y.h));if(C(y))return y=G(T,R(y)),new U(R(y.g),y.h);if(30<T.g.length){if(C(T)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var w=g,b=y;0>=b.l(T);)w=Y(w),b=Y(b);var I=B(w,1),x=B(b,1);for(b=B(b,2),w=B(w,2);!P(b);){var _=x.add(b);0>=_.l(T)&&(I=I.add(w),x=_),b=B(b,1),w=B(w,1)}return y=N(T,I.j(y)),new U(I,y)}for(I=m;0<=T.l(y);){for(w=Math.max(1,Math.floor(T.m()/y.m())),b=Math.ceil(Math.log(w)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),x=h(w),_=x.j(y);C(_)||0<_.l(T);)w-=b,x=h(w),_=x.j(y);P(x)&&(x=g),I=I.add(x),T=N(T,_)}return new U(I,T)}r.A=function(T){return G(this,T).h},r.and=function(T){for(var y=Math.max(this.g.length,T.g.length),w=[],b=0;b<y;b++)w[b]=this.i(b)&T.i(b);return new a(w,this.h&T.h)},r.or=function(T){for(var y=Math.max(this.g.length,T.g.length),w=[],b=0;b<y;b++)w[b]=this.i(b)|T.i(b);return new a(w,this.h|T.h)},r.xor=function(T){for(var y=Math.max(this.g.length,T.g.length),w=[],b=0;b<y;b++)w[b]=this.i(b)^T.i(b);return new a(w,this.h^T.h)};function Y(T){for(var y=T.g.length+1,w=[],b=0;b<y;b++)w[b]=T.i(b)<<1|T.i(b-1)>>>31;return new a(w,T.h)}function B(T,y){var w=y>>5;y%=32;for(var b=T.g.length-w,I=[],x=0;x<b;x++)I[x]=0<y?T.i(x+w)>>>y|T.i(x+w+1)<<32-y:T.i(x+w);return new a(I,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,eu=sg.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Rt=sg.Integer=a}).apply(typeof ig!="undefined"?ig:typeof self!="undefined"?self:typeof window!="undefined"?window:{});var Io=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Pt={};var tu,lS,mn,ru,Oi,Ao,nu,iu,su;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,d){return o==Array.prototype||o==Object.prototype||(o[c]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Io=="object"&&Io];for(var c=0;c<o.length;++c){var d=o[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var n=t(this);function i(o,c){if(c)e:{var d=n;o=o.split(".");for(var p=0;p<o.length-1;p++){var A=o[p];if(!(A in d))break e;d=d[A]}o=o[o.length-1],p=d[o],c=c(p),c!=p&&c!=null&&e(d,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var d=0,p=!1,A={next:function(){if(!p&&d<o.length){var S=d++;return{value:c(S,o[S]),done:!1}}return p=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,d){return d})}});var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function f(o,c,d){return o.call.apply(o.bind,arguments)}function m(o,c,d){if(!o)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,p),o.apply(c,A)}}return function(){return o.apply(c,arguments)}}function g(o,c,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function E(o,c){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function P(o,c){function d(){}d.prototype=c.prototype,o.aa=c.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(p,A,S){for(var O=Array(arguments.length-2),te=2;te<arguments.length;te++)O[te-2]=arguments[te];return c.prototype[A].apply(p,O)}}function C(o){let c=o.length;if(0<c){let d=Array(c);for(let p=0;p<c;p++)d[p]=o[p];return d}return[]}function R(o,c){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(u(p)){let A=o.length||0,S=p.length||0;o.length=A+S;for(let O=0;O<S;O++)o[A+O]=p[O]}else o.push(p)}}class N{constructor(c,d){this.i=c,this.j=d,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function M(o){return/^[\s\xa0]*$/.test(o)}function U(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function G(o){return G[" "](o),o}G[" "]=function(){};var Y=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function B(o,c,d){for(let p in o)c.call(d,o[p],p,o)}function T(o,c){for(let d in o)c.call(void 0,o[d],d,o)}function y(o){let c={};for(let d in o)c[d]=o[d];return c}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(o,c){let d,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(d in p)o[d]=p[d];for(let S=0;S<w.length;S++)d=w[S],Object.prototype.hasOwnProperty.call(p,d)&&(o[d]=p[d])}}function I(o){var c=1;o=o.split(":");let d=[];for(;0<c&&o.length;)d.push(o.shift()),c--;return o.length&&d.push(o.join(":")),d}function x(o){l.setTimeout(()=>{throw o},0)}function _(){var o=el;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class yt{constructor(){this.h=this.g=null}add(c,d){let p=ii.get();p.set(c,d),this.h?this.h.next=p:this.g=p,this.h=p}}var ii=new N(()=>new Uw,o=>o.reset());class Uw{constructor(){this.next=this.g=this.h=null}set(c,d){this.h=c,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let si,oi=!1,el=new yt,td=()=>{let o=l.Promise.resolve(void 0);si=()=>{o.then(Bw)}};var Bw=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(d){x(d)}var c=ii;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}oi=!1};function Ft(){this.s=this.s,this.C=this.C}Ft.prototype.s=!1,Ft.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ft.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var $w=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let d=()=>{};l.addEventListener("test",d,c),l.removeEventListener("test",d,c)}catch{}return o}();function ai(o,c){if(Ae.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(Y){e:{try{G(c.nodeName);var A=!0;break e}catch{}A=!1}A||(c=null)}}else d=="mouseover"?c=o.fromElement:d=="mouseout"&&(c=o.toElement);this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:qw[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&ai.aa.h.call(this)}}P(ai,Ae);var qw={2:"touch",3:"pen",4:"mouse"};ai.prototype.h=function(){ai.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var li="closure_listenable_"+(1e6*Math.random()|0),zw=0;function Gw(o,c,d,p,A){this.listener=o,this.proxy=null,this.src=c,this.type=d,this.capture=!!p,this.ha=A,this.key=++zw,this.da=this.fa=!1}function Ds(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Os(o){this.src=o,this.g={},this.h=0}Os.prototype.add=function(o,c,d,p,A){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var O=rl(o,c,p,A);return-1<O?(c=o[O],d||(c.fa=!1)):(c=new Gw(c,this.src,S,!!p,A),c.fa=d,o.push(c)),c};function tl(o,c){var d=c.type;if(d in o.g){var p=o.g[d],A=Array.prototype.indexOf.call(p,c,void 0),S;(S=0<=A)&&Array.prototype.splice.call(p,A,1),S&&(Ds(c),o.g[d].length==0&&(delete o.g[d],o.h--))}}function rl(o,c,d,p){for(var A=0;A<o.length;++A){var S=o[A];if(!S.da&&S.listener==c&&S.capture==!!d&&S.ha==p)return A}return-1}var nl="closure_lm_"+(1e6*Math.random()|0),il={};function rd(o,c,d,p,A){if(p&&p.once)return id(o,c,d,p,A);if(Array.isArray(c)){for(var S=0;S<c.length;S++)rd(o,c[S],d,p,A);return null}return d=ll(d),o&&o[li]?o.K(c,d,h(p)?!!p.capture:!!p,A):nd(o,c,d,!1,p,A)}function nd(o,c,d,p,A,S){if(!c)throw Error("Invalid event type");var O=h(A)?!!A.capture:!!A,te=ol(o);if(te||(o[nl]=te=new Os(o)),d=te.add(c,d,p,O,S),d.proxy)return d;if(p=Kw(),d.proxy=p,p.src=o,p.listener=d,o.addEventListener)$w||(A=O),A===void 0&&(A=!1),o.addEventListener(c.toString(),p,A);else if(o.attachEvent)o.attachEvent(od(c.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function Kw(){function o(d){return c.call(o.src,o.listener,d)}let c=Hw;return o}function id(o,c,d,p,A){if(Array.isArray(c)){for(var S=0;S<c.length;S++)id(o,c[S],d,p,A);return null}return d=ll(d),o&&o[li]?o.L(c,d,h(p)?!!p.capture:!!p,A):nd(o,c,d,!0,p,A)}function sd(o,c,d,p,A){if(Array.isArray(c))for(var S=0;S<c.length;S++)sd(o,c[S],d,p,A);else p=h(p)?!!p.capture:!!p,d=ll(d),o&&o[li]?(o=o.i,c=String(c).toString(),c in o.g&&(S=o.g[c],d=rl(S,d,p,A),-1<d&&(Ds(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete o.g[c],o.h--)))):o&&(o=ol(o))&&(c=o.g[c.toString()],o=-1,c&&(o=rl(c,d,p,A)),(d=-1<o?c[o]:null)&&sl(d))}function sl(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[li])tl(c.i,o);else{var d=o.type,p=o.proxy;c.removeEventListener?c.removeEventListener(d,p,o.capture):c.detachEvent?c.detachEvent(od(d),p):c.addListener&&c.removeListener&&c.removeListener(p),(d=ol(c))?(tl(d,o),d.h==0&&(d.src=null,c[nl]=null)):Ds(o)}}}function od(o){return o in il?il[o]:il[o]="on"+o}function Hw(o,c){if(o.da)o=!0;else{c=new ai(c,this);var d=o.listener,p=o.ha||o.src;o.fa&&sl(o),o=d.call(p,c)}return o}function ol(o){return o=o[nl],o instanceof Os?o:null}var al="__closure_events_fn_"+(1e9*Math.random()>>>0);function ll(o){return typeof o=="function"?o:(o[al]||(o[al]=function(c){return o.handleEvent(c)}),o[al])}function xe(){Ft.call(this),this.i=new Os(this),this.M=this,this.F=null}P(xe,Ft),xe.prototype[li]=!0,xe.prototype.removeEventListener=function(o,c,d,p){sd(this,o,c,d,p)};function De(o,c){var d,p=o.F;if(p)for(d=[];p;p=p.F)d.push(p);if(o=o.M,p=c.type||c,typeof c=="string")c=new Ae(c,o);else if(c instanceof Ae)c.target=c.target||o;else{var A=c;c=new Ae(p,o),b(c,A)}if(A=!0,d)for(var S=d.length-1;0<=S;S--){var O=c.g=d[S];A=Ns(O,p,!0,c)&&A}if(O=c.g=o,A=Ns(O,p,!0,c)&&A,A=Ns(O,p,!1,c)&&A,d)for(S=0;S<d.length;S++)O=c.g=d[S],A=Ns(O,p,!1,c)&&A}xe.prototype.N=function(){if(xe.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var d=o.g[c],p=0;p<d.length;p++)Ds(d[p]);delete o.g[c],o.h--}}this.F=null},xe.prototype.K=function(o,c,d,p){return this.i.add(String(o),c,!1,d,p)},xe.prototype.L=function(o,c,d,p){return this.i.add(String(o),c,!0,d,p)};function Ns(o,c,d,p){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var A=!0,S=0;S<c.length;++S){var O=c[S];if(O&&!O.da&&O.capture==d){var te=O.listener,be=O.ha||O.src;O.fa&&tl(o.i,O),A=te.call(be,p)!==!1&&A}}return A&&!p.defaultPrevented}function ad(o,c,d){if(typeof o=="function")d&&(o=g(o,d));else if(o&&typeof o.handleEvent=="function")o=g(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function ld(o){o.g=ad(()=>{o.g=null,o.i&&(o.i=!1,ld(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class Ww extends Ft{constructor(c,d){super(),this.m=c,this.l=d,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ld(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ui(o){Ft.call(this),this.h=o,this.g={}}P(ui,Ft);var ud=[];function cd(o){B(o.g,function(c,d){this.g.hasOwnProperty(d)&&sl(c)},o),o.g={}}ui.prototype.N=function(){ui.aa.N.call(this),cd(this)},ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ul=l.JSON.stringify,Qw=l.JSON.parse,Jw=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function cl(){}cl.prototype.h=null;function hd(o){return o.h||(o.h=o.i())}function dd(){}var ci={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hl(){Ae.call(this,"d")}P(hl,Ae);function dl(){Ae.call(this,"c")}P(dl,Ae);var fr={},fd=null;function Vs(){return fd=fd||new xe}fr.La="serverreachability";function pd(o){Ae.call(this,fr.La,o)}P(pd,Ae);function hi(o){let c=Vs();De(c,new pd(c))}fr.STAT_EVENT="statevent";function md(o,c){Ae.call(this,fr.STAT_EVENT,o),this.stat=c}P(md,Ae);function Oe(o){let c=Vs();De(c,new md(c,o))}fr.Ma="timingevent";function gd(o,c){Ae.call(this,fr.Ma,o),this.size=c}P(gd,Ae);function di(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function fi(){this.g=!0}fi.prototype.xa=function(){this.g=!1};function Yw(o,c,d,p,A,S){o.info(function(){if(o.g)if(S)for(var O="",te=S.split("&"),be=0;be<te.length;be++){var X=te[be].split("=");if(1<X.length){var Se=X[0];X=X[1];var Re=Se.split("_");O=2<=Re.length&&Re[1]=="type"?O+(Se+"="+X+"&"):O+(Se+"=redacted&")}}else O=null;else O=S;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+c+`
`+d+`
`+O})}function Xw(o,c,d,p,A,S,O){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+c+`
`+d+`
`+S+" "+O})}function zr(o,c,d,p){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+ev(o,d)+(p?" "+p:"")})}function Zw(o,c){o.info(function(){return"TIMEOUT: "+c})}fi.prototype.info=function(){};function ev(o,c){if(!o.g)return c;if(!c)return null;try{var d=JSON.parse(c);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var p=d[o];if(!(2>p.length)){var A=p[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var O=1;O<A.length;O++)A[O]=""}}}}return ul(d)}catch{return c}}var Ls={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},fl;function Ms(){}P(Ms,cl),Ms.prototype.g=function(){return new XMLHttpRequest},Ms.prototype.i=function(){return{}},fl=new Ms;function jt(o,c,d,p){this.j=o,this.i=c,this.l=d,this.R=p||1,this.U=new ui(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _d}function _d(){this.i=null,this.g="",this.h=!1}var wd={},pl={};function ml(o,c,d){o.L=1,o.v=Bs(_t(c)),o.m=d,o.P=!0,vd(o,null)}function vd(o,c){o.F=Date.now(),Fs(o),o.A=_t(o.v);var d=o.A,p=o.R;Array.isArray(p)||(p=[String(p)]),Nd(d.i,"t",p),o.C=0,d=o.j.J,o.h=new _d,o.g=Xd(o.j,d?c:null,!o.m),0<o.O&&(o.M=new Ww(g(o.Y,o,o.g),o.O)),c=o.U,d=o.g,p=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(ud[0]=A.toString()),A=ud);for(var S=0;S<A.length;S++){var O=rd(d,A[S],p||c.handleEvent,!1,c.h||c);if(!O)break;c.g[O.key]=O}c=o.H?y(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),hi(),Yw(o.i,o.u,o.A,o.l,o.R,o.m)}jt.prototype.ca=function(o){o=o.target;let c=this.M;c&&wt(o)==3?c.j():this.Y(o)},jt.prototype.Y=function(o){try{if(o==this.g)e:{let Re=wt(this.g);var c=this.g.Ba();let Hr=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||Bd(this.g)))){this.J||Re!=4||c==7||(c==8||0>=Hr?hi(3):hi(2)),gl(this);var d=this.g.Z();this.X=d;t:if(bd(this)){var p=Bd(this.g);o="";var A=p.length,S=wt(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){pr(this),pi(this);var O="";break t}this.h.i=new l.TextDecoder}for(c=0;c<A;c++)this.h.h=!0,o+=this.h.i.decode(p[c],{stream:!(S&&c==A-1)});p.length=0,this.h.g+=o,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=d==200,Xw(this.i,this.u,this.A,this.l,this.R,Re,d),this.o){if(this.T&&!this.K){t:{if(this.g){var te,be=this.g;if((te=be.g?be.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(te)){var X=te;break t}}X=null}if(d=X)zr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yl(this,d);else{this.o=!1,this.s=3,Oe(12),pr(this),pi(this);break e}}if(this.P){d=!0;let Ye;for(;!this.J&&this.C<O.length;)if(Ye=tv(this,O),Ye==pl){Re==4&&(this.s=4,Oe(14),d=!1),zr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ye==wd){this.s=4,Oe(15),zr(this.i,this.l,O,"[Invalid Chunk]"),d=!1;break}else zr(this.i,this.l,Ye,null),yl(this,Ye);if(bd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||O.length!=0||this.h.h||(this.s=1,Oe(16),d=!1),this.o=this.o&&d,!d)zr(this.i,this.l,O,"[Invalid Chunked Response]"),pr(this),pi(this);else if(0<O.length&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.ba&&!Se.M&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),El(Se),Se.M=!0,Oe(11))}}else zr(this.i,this.l,O,null),yl(this,O);Re==4&&pr(this),this.o&&!this.J&&(Re==4?Wd(this.j,this):(this.o=!1,Fs(this)))}else _v(this.g),d==400&&0<O.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),pr(this),pi(this)}}}catch{}finally{}};function bd(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function tv(o,c){var d=o.C,p=c.indexOf(`
`,d);return p==-1?pl:(d=Number(c.substring(d,p)),isNaN(d)?wd:(p+=1,p+d>c.length?pl:(c=c.slice(p,p+d),o.C=p+d,c)))}jt.prototype.cancel=function(){this.J=!0,pr(this)};function Fs(o){o.S=Date.now()+o.I,Td(o,o.I)}function Td(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=di(g(o.ba,o),c)}function gl(o){o.B&&(l.clearTimeout(o.B),o.B=null)}jt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Zw(this.i,this.A),this.L!=2&&(hi(),Oe(17)),pr(this),this.s=2,pi(this)):Td(this,this.S-o)};function pi(o){o.j.G==0||o.J||Wd(o.j,o)}function pr(o){gl(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,cd(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function yl(o,c){try{var d=o.j;if(d.G!=0&&(d.g==o||_l(d.h,o))){if(!o.K&&_l(d.h,o)&&d.G==3){try{var p=d.Da.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)Ks(d),zs(d);else break e;Tl(d),Oe(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=di(g(d.Za,d),6e3));if(1>=Ad(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else gr(d,11)}else if((o.K||d.g==o)&&Ks(d),!M(c))for(A=d.Da.g.parse(c),c=0;c<A.length;c++){let X=A[c];if(d.T=X[0],X=X[1],d.G==2)if(X[0]=="c"){d.K=X[1],d.ia=X[2];let Se=X[3];Se!=null&&(d.la=Se,d.j.info("VER="+d.la));let Re=X[4];Re!=null&&(d.Aa=Re,d.j.info("SVER="+d.Aa));let Hr=X[5];Hr!=null&&typeof Hr=="number"&&0<Hr&&(p=1.5*Hr,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let Ye=o.g;if(Ye){let Ws=Ye.g?Ye.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ws){var S=p.h;S.g||Ws.indexOf("spdy")==-1&&Ws.indexOf("quic")==-1&&Ws.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(wl(S,S.h),S.h=null))}if(p.D){let Il=Ye.g?Ye.g.getResponseHeader("X-HTTP-Session-Id"):null;Il&&(p.ya=Il,ie(p.I,p.D,Il))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var O=o;if(p.qa=Yd(p,p.J?p.ia:null,p.W),O.K){xd(p.h,O);var te=O,be=p.L;be&&(te.I=be),te.B&&(gl(te),Fs(te)),p.g=O}else Kd(p);0<d.i.length&&Gs(d)}else X[0]!="stop"&&X[0]!="close"||gr(d,7);else d.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?gr(d,7):bl(d):X[0]!="noop"&&d.l&&d.l.ta(X),d.v=0)}}hi(4)}catch{}}var rv=class{constructor(o,c){this.g=o,this.map=c}};function Ed(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Id(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ad(o){return o.h?1:o.g?o.g.size:0}function _l(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function wl(o,c){o.g?o.g.add(c):o.h=c}function xd(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Ed.prototype.cancel=function(){if(this.i=Sd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Sd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let d of o.g.values())c=c.concat(d.D);return c}return C(o.i)}function nv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map!="undefined"&&o instanceof Map||typeof Set!="undefined"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],d=o.length,p=0;p<d;p++)c.push(o[p]);return c}c=[],d=0;for(p in o)c[d++]=o[p];return c}function iv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map!="undefined"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set!="undefined"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var d=0;d<o;d++)c.push(d);return c}c=[],d=0;for(let p in o)c[d++]=p;return c}}}function Rd(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var d=iv(o),p=nv(o),A=p.length,S=0;S<A;S++)c.call(void 0,p[S],d&&d[S],o)}var Pd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sv(o,c){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var p=o[d].indexOf("="),A=null;if(0<=p){var S=o[d].substring(0,p);A=o[d].substring(p+1)}else S=o[d];c(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function mr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof mr){this.h=o.h,js(this,o.j),this.o=o.o,this.g=o.g,Us(this,o.s),this.l=o.l;var c=o.i,d=new yi;d.i=c.i,c.g&&(d.g=new Map(c.g),d.h=c.h),Cd(this,d),this.m=o.m}else o&&(c=String(o).match(Pd))?(this.h=!1,js(this,c[1]||"",!0),this.o=mi(c[2]||""),this.g=mi(c[3]||"",!0),Us(this,c[4]),this.l=mi(c[5]||"",!0),Cd(this,c[6]||"",!0),this.m=mi(c[7]||"")):(this.h=!1,this.i=new yi(null,this.h))}mr.prototype.toString=function(){var o=[],c=this.j;c&&o.push(gi(c,kd,!0),":");var d=this.g;return(d||c=="file")&&(o.push("//"),(c=this.o)&&o.push(gi(c,kd,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(gi(d,d.charAt(0)=="/"?lv:av,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",gi(d,cv)),o.join("")};function _t(o){return new mr(o)}function js(o,c,d){o.j=d?mi(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Us(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function Cd(o,c,d){c instanceof yi?(o.i=c,hv(o.i,o.h)):(d||(c=gi(c,uv)),o.i=new yi(c,o.h))}function ie(o,c,d){o.i.set(c,d)}function Bs(o){return ie(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function mi(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function gi(o,c,d){return typeof o=="string"?(o=encodeURI(o).replace(c,ov),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function ov(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var kd=/[#\/\?@]/g,av=/[#\?:]/g,lv=/[#\?]/g,uv=/[#\?@]/g,cv=/#/g;function yi(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Ut(o){o.g||(o.g=new Map,o.h=0,o.i&&sv(o.i,function(c,d){o.add(decodeURIComponent(c.replace(/\+/g," ")),d)}))}r=yi.prototype,r.add=function(o,c){Ut(this),this.i=null,o=Gr(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(c),this.h+=1,this};function Dd(o,c){Ut(o),c=Gr(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Od(o,c){return Ut(o),c=Gr(o,c),o.g.has(c)}r.forEach=function(o,c){Ut(this),this.g.forEach(function(d,p){d.forEach(function(A){o.call(c,A,p,this)},this)},this)},r.na=function(){Ut(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),d=[];for(let p=0;p<c.length;p++){let A=o[p];for(let S=0;S<A.length;S++)d.push(c[p])}return d},r.V=function(o){Ut(this);let c=[];if(typeof o=="string")Od(this,o)&&(c=c.concat(this.g.get(Gr(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)c=c.concat(o[d])}return c},r.set=function(o,c){return Ut(this),this.i=null,o=Gr(this,o),Od(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},r.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Nd(o,c,d){Dd(o,c),0<d.length&&(o.i=null,o.g.set(Gr(o,c),C(d)),o.h+=d.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var d=0;d<c.length;d++){var p=c[d];let S=encodeURIComponent(String(p)),O=this.V(p);for(p=0;p<O.length;p++){var A=S;O[p]!==""&&(A+="="+encodeURIComponent(String(O[p]))),o.push(A)}}return this.i=o.join("&")};function Gr(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function hv(o,c){c&&!o.j&&(Ut(o),o.i=null,o.g.forEach(function(d,p){var A=p.toLowerCase();p!=A&&(Dd(this,p),Nd(this,A,d))},o)),o.j=c}function dv(o,c){let d=new fi;if(l.Image){let p=new Image;p.onload=E(Bt,d,"TestLoadImage: loaded",!0,c,p),p.onerror=E(Bt,d,"TestLoadImage: error",!1,c,p),p.onabort=E(Bt,d,"TestLoadImage: abort",!1,c,p),p.ontimeout=E(Bt,d,"TestLoadImage: timeout",!1,c,p),l.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else c(!1)}function fv(o,c){let d=new fi,p=new AbortController,A=setTimeout(()=>{p.abort(),Bt(d,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:p.signal}).then(S=>{clearTimeout(A),S.ok?Bt(d,"TestPingServer: ok",!0,c):Bt(d,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),Bt(d,"TestPingServer: error",!1,c)})}function Bt(o,c,d,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(d)}catch{}}function pv(){this.g=new Jw}function mv(o,c,d){let p=d||"";try{Rd(o,function(A,S){let O=A;h(A)&&(O=ul(A)),c.push(p+S+"="+encodeURIComponent(O))})}catch(A){throw c.push(p+"type="+encodeURIComponent("_badmap")),A}}function _i(o){this.l=o.Ub||null,this.j=o.eb||!1}P(_i,cl),_i.prototype.g=function(){return new $s(this.l,this.j)},_i.prototype.i=function(o){return function(){return o}}({});function $s(o,c){xe.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P($s,xe),r=$s.prototype,r.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,vi(this)},r.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,wi(this)),this.readyState=0},r.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,vi(this)),this.g&&(this.readyState=3,vi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream!="undefined"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vd(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vd(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}r.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?wi(this):vi(this),this.readyState==3&&Vd(this)}},r.Ra=function(o){this.g&&(this.response=this.responseText=o,wi(this))},r.Qa=function(o){this.g&&(this.response=o,wi(this))},r.ga=function(){this.g&&wi(this)};function wi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,vi(o)}r.setRequestHeader=function(o,c){this.u.append(o,c)},r.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var d=c.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=c.next();return o.join(`\r
`)};function vi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Ld(o){let c="";return B(o,function(d,p){c+=p,c+=":",c+=d,c+=`\r
`}),c}function vl(o,c,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Ld(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):ie(o,c,d))}function ue(o){xe.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(ue,xe);var gv=/^https?$/i,yv=["POST","PUT"];r=ue.prototype,r.Ha=function(o){this.J=o},r.ea=function(o,c,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():fl.g(),this.v=this.o?hd(this.o):hd(fl),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(S){Md(this,S);return}if(o=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)d.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),A=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(yv,c,void 0))||p||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,O]of d)this.g.setRequestHeader(S,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ud(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Md(this,S)}};function Md(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,Fd(o),qs(o)}function Fd(o){o.A||(o.A=!0,De(o,"complete"),De(o,"error"))}r.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,De(this,"complete"),De(this,"abort"),qs(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qs(this,!0)),ue.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?jd(this):this.bb())},r.bb=function(){jd(this)};function jd(o){if(o.h&&typeof a!="undefined"&&(!o.v[1]||wt(o)!=4||o.Z()!=2)){if(o.u&&wt(o)==4)ad(o.Ea,0,o);else if(De(o,"readystatechange"),wt(o)==4){o.h=!1;try{let O=o.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var d;if(!(d=c)){var p;if(p=O===0){var A=String(o.D).match(Pd)[1]||null;!A&&l.self&&l.self.location&&(A=l.self.location.protocol.slice(0,-1)),p=!gv.test(A?A.toLowerCase():"")}d=p}if(d)De(o,"complete"),De(o,"success");else{o.m=6;try{var S=2<wt(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",Fd(o)}}finally{qs(o)}}}}function qs(o,c){if(o.g){Ud(o);let d=o.g,p=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||De(o,"ready");try{d.onreadystatechange=p}catch{}}}function Ud(o){o.I&&(l.clearTimeout(o.I),o.I=null)}r.isActive=function(){return!!this.g};function wt(o){return o.g?o.g.readyState:0}r.Z=function(){try{return 2<wt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Qw(c)}};function Bd(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function _v(o){let c={};o=(o.g&&2<=wt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(M(o[p]))continue;var d=I(o[p]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=c[A]||[];c[A]=S,S.push(d)}T(c,function(p){return p.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(o,c,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||c}function $d(o){this.Aa=0,this.i=[],this.j=new fi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bi("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bi("baseRetryDelayMs",5e3,o),this.cb=bi("retryDelaySeedMs",1e4,o),this.Wa=bi("forwardChannelMaxRetries",2,o),this.wa=bi("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Ed(o&&o.concurrentRequestLimit),this.Da=new pv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=$d.prototype,r.la=8,r.G=1,r.connect=function(o,c,d,p){Oe(0),this.W=o,this.H=c||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Yd(this,null,this.W),Gs(this)};function bl(o){if(qd(o),o.G==3){var c=o.U++,d=_t(o.I);if(ie(d,"SID",o.K),ie(d,"RID",c),ie(d,"TYPE","terminate"),Ti(o,d),c=new jt(o,o.j,c),c.L=2,c.v=Bs(_t(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=c.v,d=!0),d||(c.g=Xd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Fs(c)}Jd(o)}function zs(o){o.g&&(El(o),o.g.cancel(),o.g=null)}function qd(o){zs(o),o.u&&(l.clearTimeout(o.u),o.u=null),Ks(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Gs(o){if(!Id(o.h)&&!o.s){o.s=!0;var c=o.Ga;si||td(),oi||(si(),oi=!0),el.add(c,o),o.B=0}}function wv(o,c){return Ad(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=di(g(o.Ga,o,c),Qd(o,o.B)),o.B++,!0)}r.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new jt(this,this.j,o),S=this.o;if(this.S&&(S?(S=y(S),b(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var c=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,4096<c){c=d;break e}if(c===4096||d===this.i.length-1){c=d+1;break e}}c=1e3}else c=1e3;c=Gd(this,A,c),d=_t(this.I),ie(d,"RID",o),ie(d,"CVER",22),this.D&&ie(d,"X-HTTP-Session-Id",this.D),Ti(this,d),S&&(this.O?c="headers="+encodeURIComponent(String(Ld(S)))+"&"+c:this.m&&vl(d,this.m,S)),wl(this.h,A),this.Ua&&ie(d,"TYPE","init"),this.P?(ie(d,"$req",c),ie(d,"SID","null"),A.T=!0,ml(A,d,null)):ml(A,d,c),this.G=2}}else this.G==3&&(o?zd(this,o):this.i.length==0||Id(this.h)||zd(this))};function zd(o,c){var d;c?d=c.l:d=o.U++;let p=_t(o.I);ie(p,"SID",o.K),ie(p,"RID",d),ie(p,"AID",o.T),Ti(o,p),o.m&&o.o&&vl(p,o.m,o.o),d=new jt(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Gd(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),wl(o.h,d),ml(d,p,c)}function Ti(o,c){o.H&&B(o.H,function(d,p){ie(c,p,d)}),o.l&&Rd({},function(d,p){ie(c,p,d)})}function Gd(o,c,d){d=Math.min(o.i.length,d);var p=o.l?g(o.l.Na,o.l,o):null;e:{var A=o.i;let S=-1;for(;;){let O=["count="+d];S==-1?0<d?(S=A[0].g,O.push("ofs="+S)):S=0:O.push("ofs="+S);let te=!0;for(let be=0;be<d;be++){let X=A[be].g,Se=A[be].map;if(X-=S,0>X)S=Math.max(0,A[be].g-100),te=!1;else try{mv(Se,O,"req"+X+"_")}catch{p&&p(Se)}}if(te){p=O.join("&");break e}}}return o=o.i.splice(0,d),c.D=o,p}function Kd(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;si||td(),oi||(si(),oi=!0),el.add(c,o),o.v=0}}function Tl(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=di(g(o.Fa,o),Qd(o,o.v)),o.v++,!0)}r.Fa=function(){if(this.u=null,Hd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=di(g(this.ab,this),o)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),zs(this),Hd(this))};function El(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Hd(o){o.g=new jt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=_t(o.qa);ie(c,"RID","rpc"),ie(c,"SID",o.K),ie(c,"AID",o.T),ie(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&ie(c,"TO",o.ja),ie(c,"TYPE","xmlhttp"),Ti(o,c),o.m&&o.o&&vl(c,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=Bs(_t(c)),d.m=null,d.P=!0,vd(d,o)}r.Za=function(){this.C!=null&&(this.C=null,zs(this),Tl(this),Oe(19))};function Ks(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Wd(o,c){var d=null;if(o.g==c){Ks(o),El(o),o.g=null;var p=2}else if(_l(o.h,c))d=c.D,xd(o.h,c),p=1;else return;if(o.G!=0){if(c.o)if(p==1){d=c.m?c.m.length:0,c=Date.now()-c.F;var A=o.B;p=Vs(),De(p,new gd(p,d)),Gs(o)}else Kd(o);else if(A=c.s,A==3||A==0&&0<c.X||!(p==1&&wv(o,c)||p==2&&Tl(o)))switch(d&&0<d.length&&(c=o.h,c.i=c.i.concat(d)),A){case 1:gr(o,5);break;case 4:gr(o,10);break;case 3:gr(o,6);break;default:gr(o,2)}}}function Qd(o,c){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*c}function gr(o,c){if(o.j.info("Error code "+c),c==2){var d=g(o.fb,o),p=o.Xa;let A=!p;p=new mr(p||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||js(p,"https"),Bs(p),A?dv(p.toString(),d):fv(p.toString(),d)}else Oe(2);o.G=0,o.l&&o.l.sa(c),Jd(o),qd(o)}r.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function Jd(o){if(o.G=0,o.ka=[],o.l){let c=Sd(o.h);(c.length!=0||o.i.length!=0)&&(R(o.ka,c),R(o.ka,o.i),o.h.i.length=0,C(o.i),o.i.length=0),o.l.ra()}}function Yd(o,c,d){var p=d instanceof mr?_t(d):new mr(d);if(p.g!="")c&&(p.g=c+"."+p.g),Us(p,p.s);else{var A=l.location;p=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;var S=new mr(null);p&&js(S,p),c&&(S.g=c),A&&Us(S,A),d&&(S.l=d),p=S}return d=o.D,c=o.ya,d&&c&&ie(p,d,c),ie(p,"VER",o.la),Ti(o,p),p}function Xd(o,c,d){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ue(new _i({eb:d})):new ue(o.pa),c.Ha(o.J),c}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zd(){}r=Zd.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Hs(){}Hs.prototype.g=function(o,c){return new qe(o,c)};function qe(o,c){xe.call(this),this.g=new $d(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!M(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!M(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Kr(this)}P(qe,xe),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){bl(this.g)},qe.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=ul(o),o=d);c.i.push(new rv(c.Ya++,o)),c.G==3&&Gs(c)},qe.prototype.N=function(){this.g.l=null,delete this.j,bl(this.g),delete this.g,qe.aa.N.call(this)};function ef(o){hl.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let d in c){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}P(ef,hl);function tf(){dl.call(this),this.status=1}P(tf,dl);function Kr(o){this.g=o}P(Kr,Zd),Kr.prototype.ua=function(){De(this.g,"a")},Kr.prototype.ta=function(o){De(this.g,new ef(o))},Kr.prototype.sa=function(o){De(this.g,new tf)},Kr.prototype.ra=function(){De(this.g,"b")},Hs.prototype.createWebChannel=Hs.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,su=Pt.createWebChannelTransport=function(){return new Hs},iu=Pt.getStatEventTarget=function(){return Vs()},nu=Pt.Event=fr,Ao=Pt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ls.NO_ERROR=0,Ls.TIMEOUT=8,Ls.HTTP_ERROR=6,Oi=Pt.ErrorCode=Ls,yd.COMPLETE="complete",ru=Pt.EventType=yd,dd.EventType=ci,ci.OPEN="a",ci.CLOSE="b",ci.ERROR="c",ci.MESSAGE="d",xe.prototype.listen=xe.prototype.K,mn=Pt.WebChannel=dd,lS=Pt.FetchXmlHttpFactory=_i,ue.prototype.listenOnce=ue.prototype.L,ue.prototype.getLastError=ue.prototype.Ka,ue.prototype.getLastErrorCode=ue.prototype.Ba,ue.prototype.getStatus=ue.prototype.Z,ue.prototype.getResponseJson=ue.prototype.Oa,ue.prototype.getResponseText=ue.prototype.oa,ue.prototype.send=ue.prototype.ea,ue.prototype.setWithCredentials=ue.prototype.Ha,tu=Pt.XhrIo=ue}).apply(typeof Io!="undefined"?Io:typeof self!="undefined"?self:typeof window!="undefined"?window:{});var og="@firebase/firestore",ag="4.7.8";var we=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};we.UNAUTHENTICATED=new we(null),we.GOOGLE_CREDENTIALS=new we("google-credentials-uid"),we.FIRST_PARTY=new we("first-party-uid"),we.MOCK_USER=new we("mock-user");var jn="11.3.1";var Er=new pn("@firebase/firestore");function gn(){return Er.logLevel}function V(r,...e){if(Er.logLevel<=W.DEBUG){let t=e.map(Gc);Er.debug(`Firestore (${jn}): ${r}`,...t)}}function Ct(r,...e){if(Er.logLevel<=W.ERROR){let t=e.map(Gc);Er.error(`Firestore (${jn}): ${r}`,...t)}}function En(r,...e){if(Er.logLevel<=W.WARN){let t=e.map(Gc);Er.warn(`Firestore (${jn}): ${r}`,...t)}}function Gc(r){if(typeof r=="string")return r;try{return function(t){return JSON.stringify(t)}(r)}catch{return r}}function F(r="Unexpected state"){let e=`FIRESTORE (${jn}) INTERNAL ASSERTION FAILED: `+r;throw Ct(e),new Error(e)}function ee(r,e){r||F()}function $(r,e){return r}var D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends It{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ot=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Do=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},cu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(we.UNAUTHENTICATED))}shutdown(){}},hu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},du=class{constructor(e){this.t=e,this.currentUser=we.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0);let n=this.i,i=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve(),s=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ot,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?l(u):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ot)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ee(typeof n.accessToken=="string"),new Do(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string"),new we(e)}},fu=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=we.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},pu=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new fu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(we.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Oo=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},mu=class{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Zm(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0);let n=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new Oo(this.V));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string"),this.R=t.token,new Oo(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function uS(r){let e=typeof self!="undefined"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}var No=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),n="";for(;n.length<20;){let i=uS(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}};function Q(r,e){return r<e?-1:r>e?1:0}function In(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}var lg=-62135596800,ug=1e6,Te=class r{static now(){return r.fromMillis(Date.now())}static fromDate(e){return r.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ug);return new r(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lg)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ug}_compareTo(e){return this.seconds===e.seconds?Q(this.nanoseconds,e.nanoseconds):Q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-lg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class r{static fromTimestamp(e){return new r(e)}static min(){return new r(new Te(0,0))}static max(){return new r(new Te(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var cg="__name__",Vo=class r{constructor(e,t,n){t===void 0?t=0:t>e.length&&F(),n===void 0?n=e.length-t:n>e.length-t&&F(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return r.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof r?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let i=0;i<n;i++){let s=r.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Math.sign(e.length-t.length)}static compareSegments(e,t){let n=r.isNumericId(e),i=r.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?r.extractNumericId(e).compare(r.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Rt.fromString(e.substring(4,e.length-2))}},me=class r extends Vo{construct(e,t,n){return new r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new L(D.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new r(t)}static emptyPath(){return new r([])}},cS=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ge=class r extends Vo{construct(e,t,n){return new r(e,t,n)}static isValidIdentifier(e){return cS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cg}static keyField(){return new r([cg])}static fromServerFormat(e){let t=[],n="",i=0,s=()=>{if(n.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},a=!1;for(;i<e.length;){let l=e[i];if(l==="\\"){if(i+1===e.length)throw new L(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new L(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(n+=l,i++):(s(),i++)}if(s(),a)throw new L(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}static emptyPath(){return new r([])}};var j=class r{constructor(e){this.path=e}static fromPath(e){return new r(me.fromString(e))}static fromName(e){return new r(me.fromString(e).popFirst(5))}static empty(){return new r(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new r(new me(e.slice()))}};var ji=-1,gu=class{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}};gu.UNKNOWN_ID=-1;function hS(r,e){let t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=q.fromTimestamp(n===1e9?new Te(t+1,0):new Te(t,n));return new Ir(i,j.empty(),e)}function dS(r){return new Ir(r.readTime,r.key,ji)}var Ir=class r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new r(q.min(),j.empty(),ji)}static max(){return new r(q.max(),j.empty(),ji)}};function fS(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(r.documentKey,e.documentKey),t!==0?t:Q(r.largestBatchId,e.largestBatchId))}var pS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",yu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Un(r){if(r.code!==D.FAILED_PRECONDITION||r.message!==pS)throw r;V("LocalStore","Unexpectedly lost primary lease")}var k=class r{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof r?t:r.resolve(t)}catch(t){return r.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):r.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):r.reject(t)}static resolve(e){return new r((t,n)=>{t(e)})}static reject(e){return new r((t,n)=>{n(e)})}static waitFor(e){return new r((t,n)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},u=>n(u))}),a=!0,s===i&&t()})}static or(e){let t=r.resolve(!1);for(let n of e)t=t.next(i=>i?r.resolve(i):n());return t}static forEach(e,t){let n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new r((n,i)=>{let s=e.length,a=new Array(s),l=0;for(let u=0;u<s;u++){let h=u;t(e[h]).next(f=>{a[h]=f,++l,l===s&&n(a)},f=>i(f))}})}static doWhile(e,t){return new r((n,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}};function mS(r){let e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Bn(r){return r.name==="IndexedDbTransactionError"}var An=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this._e&&this._e(e),e}};An.ae=-1;var Kc=-1;function ga(r){return r==null}function Ui(r){return r===0&&1/r==-1/0}function gS(r){return typeof r=="number"&&Number.isInteger(r)&&!Ui(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}var Hg="";function yS(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=hg(e)),e=_S(r.get(t),e);return hg(e)}function _S(r,e){let t=e,n=r.length;for(let i=0;i<n;i++){let s=r.charAt(i);switch(s){case"\0":t+="";break;case Hg:t+="";break;default:t+=s}}return t}function hg(r){return r+Hg+""}var wS="remoteDocuments",Wg="owner";var Qg="mutationQueues";var Jg="mutations";var Yg="documentMutations",vS="remoteDocumentsV14";var Xg="remoteDocumentGlobal";var Zg="targets";var ey="targetDocuments";var ty="targetGlobal",ry="collectionParents";var ny="clientMetadata";var iy="bundles";var sy="namedQueries";var bS="indexConfiguration";var TS="indexState";var ES="indexEntries";var oy="documentOverlays";var IS="globals";var AS=[Qg,Jg,Yg,wS,Zg,Wg,ty,ey,ny,Xg,ry,iy,sy],uj=[...AS,oy],xS=[Qg,Jg,Yg,vS,Zg,Wg,ty,ey,ny,Xg,ry,iy,sy,oy],SS=xS,RS=[...SS,bS,TS,ES];var cj=[...RS,IS];function dg(r){let e=0;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function lr(r,e){for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function ay(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}var he=class r{constructor(e,t){this.comparator=e,this.root=t||at.EMPTY}insert(e,t){return new r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,at.BLACK,null,null))}remove(e){return new r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,at.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vn(this.root,e,this.comparator,!1)}getReverseIterator(){return new vn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vn(this.root,e,this.comparator,!0)}},vn=class{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},at=class r{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n!=null?n:r.RED,this.left=i!=null?i:r.EMPTY,this.right=s!=null?s:r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new r(e!=null?e:this.key,t!=null?t:this.value,n!=null?n:this.color,i!=null?i:this.left,s!=null?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();let e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}};at.EMPTY=null,at.RED=!0,at.BLACK=!1;at.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(e,t,n,i,s){return this}insert(e,t,n){return new at(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class r{constructor(e){this.comparator=e,this.data=new he(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Lo(this.data.getIterator())}getIteratorFrom(e){return new Lo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new r(this.comparator);return t.data=e,t}},Lo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Qe=class r{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new r([])}unionWith(e){let t=new ve(Ge.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new r(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return In(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var Mo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ke=class r{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException!="undefined"&&s instanceof DOMException?new Mo("Invalid base64 string: "+s):s}}(e);return new r(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ke.EMPTY_BYTE_STRING=new ke("");var PS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(r){if(ee(!!r),typeof r=="string"){let e=0,t=PS.exec(r);if(ee(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ae(r.seconds),nanos:ae(r.nanos)}}function ae(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Dt(r){return typeof r=="string"?ke.fromBase64String(r):ke.fromUint8Array(r)}var ly="server_timestamp",uy="__type__",cy="__previous_value__",hy="__local_write_time__";function Hc(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[uy])===null||t===void 0?void 0:t.stringValue)===ly}function ya(r){let e=r.mapValue.fields[cy];return Hc(e)?ya(e):e}function Bi(r){let e=kt(r.mapValue.fields[hy].timestampValue);return new Te(e.seconds,e.nanos)}var _u=class{constructor(e,t,n,i,s,a,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}},Fo="(default)",jo=class r{constructor(e,t){this.projectId=e,this.database=t||Fo}static empty(){return new r("","")}get isDefaultDatabase(){return this.database===Fo}isEqual(e){return e instanceof r&&e.projectId===this.projectId&&e.database===this.database}};var Wc="__type__",dy="__max__",xo={mapValue:{fields:{__type__:{stringValue:dy}}}},Qc="__vector__",xn="value";function ir(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Hc(r)?4:py(r)?9007199254740991:fy(r)?10:11:F()}function ht(r,e){if(r===e)return!0;let t=ir(r);if(t!==ir(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Bi(r).isEqual(Bi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=kt(i.timestampValue),l=kt(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Dt(i.bytesValue).isEqual(Dt(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return ae(i.geoPointValue.latitude)===ae(s.geoPointValue.latitude)&&ae(i.geoPointValue.longitude)===ae(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ae(i.integerValue)===ae(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ae(i.doubleValue),l=ae(s.doubleValue);return a===l?Ui(a)===Ui(l):isNaN(a)&&isNaN(l)}return!1}(r,e);case 9:return In(r.arrayValue.values||[],e.arrayValue.values||[],ht);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(dg(a)!==dg(l))return!1;for(let u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!ht(a[u],l[u])))return!1;return!0}(r,e);default:return F()}}function $i(r,e){return(r.values||[]).find(t=>ht(t,e))!==void 0}function Sn(r,e){if(r===e)return 0;let t=ir(r),n=ir(e);if(t!==n)return Q(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Q(r.booleanValue,e.booleanValue);case 2:return function(s,a){let l=ae(s.integerValue||s.doubleValue),u=ae(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(r,e);case 3:return fg(r.timestampValue,e.timestampValue);case 4:return fg(Bi(r),Bi(e));case 5:return Q(r.stringValue,e.stringValue);case 6:return function(s,a){let l=Dt(s),u=Dt(a);return l.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){let l=s.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){let f=Q(l[h],u[h]);if(f!==0)return f}return Q(l.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){let l=Q(ae(s.latitude),ae(a.latitude));return l!==0?l:Q(ae(s.longitude),ae(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return pg(r.arrayValue,e.arrayValue);case 10:return function(s,a){var l,u,h,f;let m=s.fields||{},g=a.fields||{},E=(l=m[xn])===null||l===void 0?void 0:l.arrayValue,P=(u=g[xn])===null||u===void 0?void 0:u.arrayValue,C=Q(((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0,((f=P==null?void 0:P.values)===null||f===void 0?void 0:f.length)||0);return C!==0?C:pg(E,P)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===xo.mapValue&&a===xo.mapValue)return 0;if(s===xo.mapValue)return 1;if(a===xo.mapValue)return-1;let l=s.fields||{},u=Object.keys(l),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){let g=Q(u[m],f[m]);if(g!==0)return g;let E=Sn(l[u[m]],h[f[m]]);if(E!==0)return E}return Q(u.length,f.length)}(r.mapValue,e.mapValue);default:throw F()}}function fg(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Q(r,e);let t=kt(r),n=kt(e),i=Q(t.seconds,n.seconds);return i!==0?i:Q(t.nanos,n.nanos)}function pg(r,e){let t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){let s=Sn(t[i],n[i]);if(s)return s}return Q(t.length,n.length)}function Rn(r){return wu(r)}function wu(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){let n=kt(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Dt(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return j.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(let s of t.values||[])i?i=!1:n+=",",n+=wu(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){let n=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of n)s?s=!1:i+=",",i+=`${a}:${wu(t.fields[a])}`;return i+"}"}(r.mapValue):F()}function Po(r){switch(ir(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=ya(r);return e?16+Po(e):16;case 5:return 2*r.stringValue.length;case 6:return Dt(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+Po(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return lr(n.fields,(s,a)=>{i+=s.length+Po(a)}),i}(r.mapValue);default:throw F()}}function vu(r){return!!r&&"integerValue"in r}function Jc(r){return!!r&&"arrayValue"in r}function mg(r){return!!r&&"nullValue"in r}function gg(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Co(r){return!!r&&"mapValue"in r}function fy(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Wc])===null||t===void 0?void 0:t.stringValue)===Qc}function Vi(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){let e={mapValue:{fields:{}}};return lr(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Vi(n)),e}if(r.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vi(r.arrayValue.values[t]);return e}return Object.assign({},r)}function py(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===dy}var dj={mapValue:{fields:{[Wc]:{stringValue:Qc},[xn]:{arrayValue:{}}}}};var ze=class r{constructor(e){this.value=e}static empty(){return new r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Co(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vi(t)}setAll(e){let t=Ge.emptyPath(),n={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){let u=this.getFieldsMap(t);this.applyChanges(u,n,i),n={},i=[],t=l.popLast()}a?n[l.lastSegment()]=Vi(a):i.push(l.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){let t=this.field(e.popLast());Co(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ht(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Co(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){lr(t,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new r(Vi(this.value))}};function my(r){let e=[];return lr(r.fields,(t,n)=>{let i=new Ge([t]);if(Co(n)){let s=my(n.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Qe(e)}var et=class r{constructor(e,t,n,i,s,a,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new r(e,0,q.min(),q.min(),q.min(),ze.empty(),0)}static newFoundDocument(e,t,n,i){return new r(e,1,t,q.min(),n,i,0)}static newNoDocument(e,t){return new r(e,2,t,q.min(),q.min(),ze.empty(),0)}static newUnknownDocument(e,t){return new r(e,3,t,q.min(),q.min(),ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof r&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Pn=class{constructor(e,t){this.position=e,this.inclusive=t}};function yg(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){let s=e[i],a=r.position[i];if(s.field.isKeyField()?n=j.comparator(j.fromName(a.referenceValue),t.key):n=Sn(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function _g(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!ht(r.position[t],e.position[t]))return!1;return!0}var Cn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function CS(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}var Uo=class{},ye=class r extends Uo{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Tu(e,t,n):t==="array-contains"?new Au(e,n):t==="in"?new xu(e,n):t==="not-in"?new Su(e,n):t==="array-contains-any"?new Ru(e,n):new r(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Eu(e,n):new Iu(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Sn(t,this.value)):t!==null&&ir(this.value)===ir(t)&&this.matchesComparison(Sn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},dt=class r extends Uo{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new r(e,t)}matches(e){return gy(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}};function gy(r){return r.op==="and"}function yy(r){return kS(r)&&gy(r)}function kS(r){for(let e of r.filters)if(e instanceof dt)return!1;return!0}function bu(r){if(r instanceof ye)return r.field.canonicalString()+r.op.toString()+Rn(r.value);if(yy(r))return r.filters.map(e=>bu(e)).join(",");{let e=r.filters.map(t=>bu(t)).join(",");return`${r.op}(${e})`}}function _y(r,e){return r instanceof ye?function(n,i){return i instanceof ye&&n.op===i.op&&n.field.isEqual(i.field)&&ht(n.value,i.value)}(r,e):r instanceof dt?function(n,i){return i instanceof dt&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,l)=>s&&_y(a,i.filters[l]),!0):!1}(r,e):void F()}function wy(r){return r instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${Rn(t.value)}`}(r):r instanceof dt?function(t){return t.op.toString()+" {"+t.getFilters().map(wy).join(" ,")+"}"}(r):"Filter"}var Tu=class extends ye{constructor(e,t,n){super(e,t,n),this.key=j.fromName(n.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},Eu=class extends ye{constructor(e,t){super(e,"in",t),this.keys=vy("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Iu=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=vy("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function vy(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>j.fromName(n.referenceValue))}var Au=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Jc(t)&&$i(t.arrayValue,this.value)}},xu=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&$i(this.value.arrayValue,t)}},Su=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if($i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!$i(this.value.arrayValue,t)}},Ru=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Jc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>$i(this.value.arrayValue,n))}};var Pu=class{constructor(e,t=null,n=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.le=null}};function wg(r,e=null,t=[],n=[],i=null,s=null,a=null){return new Pu(r,e,t,n,i,s,a)}function Yc(r){let e=$(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>bu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ga(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Rn(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Rn(n)).join(",")),e.le=t}return e.le}function Xc(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!CS(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!_y(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!_g(r.startAt,e.startAt)&&_g(r.endAt,e.endAt)}function Cu(r){return j.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}var kn=class{constructor(e,t=null,n=[],i=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}};function DS(r,e,t,n,i,s,a,l){return new kn(r,e,t,n,i,s,a,l)}function _a(r){return new kn(r)}function vg(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function OS(r){return r.collectionGroup!==null}function Li(r){let e=$(r);if(e.he===null){e.he=[];let t=new Set;for(let s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ve(Ge.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new Cn(s,n))}),t.has(Ge.keyField().canonicalString())||e.he.push(new Cn(Ge.keyField(),n))}return e.he}function lt(r){let e=$(r);return e.Pe||(e.Pe=NS(e,Li(r))),e.Pe}function NS(r,e){if(r.limitType==="F")return wg(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Cn(i.field,s)});let t=r.endAt?new Pn(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Pn(r.startAt.position,r.startAt.inclusive):null;return wg(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function ku(r,e,t){return new kn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function wa(r,e){return Xc(lt(r),lt(e))&&r.limitType===e.limitType}function by(r){return`${Yc(lt(r))}|lt:${r.limitType}`}function yn(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>wy(i)).join(", ")}]`),ga(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Rn(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Rn(i)).join(",")),`Target(${n})`}(lt(r))}; limitType=${r.limitType})`}function va(r,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):j.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(let s of Li(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,l,u){let h=yg(a,l,u);return a.inclusive?h<=0:h<0}(n.startAt,Li(n),i)||n.endAt&&!function(a,l,u){let h=yg(a,l,u);return a.inclusive?h>=0:h>0}(n.endAt,Li(n),i))}(r,e)}function VS(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Ty(r){return(e,t)=>{let n=!1;for(let i of Li(r)){let s=LS(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function LS(r,e,t){let n=r.field.isKeyField()?j.comparator(e.key,t.key):function(s,a,l){let u=a.data.field(s),h=l.data.field(s);return u!==null&&h!==null?Sn(u,h):F()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return F()}}var Ot=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lr(this.inner,(t,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return ay(this.inner)}size(){return this.innerSize}};var MS=new he(j.comparator);function Nt(){return MS}var Ey=new he(j.comparator);function Ni(...r){let e=Ey;for(let t of r)e=e.insert(t.key,t);return e}function Iy(r){let e=Ey;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function vr(){return Mi()}function Ay(){return Mi()}function Mi(){return new Ot(r=>r.toString(),(r,e)=>r.isEqual(e))}var FS=new he(j.comparator),jS=new ve(j.comparator);function H(...r){let e=jS;for(let t of r)e=e.add(t);return e}var US=new ve(Q);function BS(){return US}function Zc(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function xy(r){return{integerValue:""+r}}function $S(r,e){return gS(e)?xy(e):Zc(r,e)}var Dn=class{constructor(){this._=void 0}};function qS(r,e,t){return r instanceof On?function(i,s){let a={fields:{[uy]:{stringValue:ly},[hy]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Hc(s)&&(s=ya(s)),s&&(a.fields[cy]=s),{mapValue:a}}(t,e):r instanceof Ar?Ry(r,e):r instanceof xr?Py(r,e):function(i,s){let a=Sy(i,s),l=bg(a)+bg(i.Ie);return vu(a)&&vu(i.Ie)?xy(l):Zc(i.serializer,l)}(r,e)}function zS(r,e,t){return r instanceof Ar?Ry(r,e):r instanceof xr?Py(r,e):t}function Sy(r,e){return r instanceof Nn?function(n){return vu(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var On=class extends Dn{},Ar=class extends Dn{constructor(e){super(),this.elements=e}};function Ry(r,e){let t=Cy(e);for(let n of r.elements)t.some(i=>ht(i,n))||t.push(n);return{arrayValue:{values:t}}}var xr=class extends Dn{constructor(e){super(),this.elements=e}};function Py(r,e){let t=Cy(e);for(let n of r.elements)t=t.filter(i=>!ht(i,n));return{arrayValue:{values:t}}}var Nn=class extends Dn{constructor(e,t){super(),this.serializer=e,this.Ie=t}};function bg(r){return ae(r.integerValue||r.doubleValue)}function Cy(r){return Jc(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function GS(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ar&&i instanceof Ar||n instanceof xr&&i instanceof xr?In(n.elements,i.elements,ht):n instanceof Nn&&i instanceof Nn?ht(n.Ie,i.Ie):n instanceof On&&i instanceof On}(r.transform,e.transform)}var Du=class{constructor(e,t){this.version=e,this.transformResults=t}},nr=class r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new r}static exists(e){return new r(void 0,e)}static updateTime(e){return new r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ko(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}var Vn=class{};function ky(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Bo(r.key,nr.none()):new Sr(r.key,r.data,nr.none());{let t=r.data,n=ze.empty(),i=new ve(Ge.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ft(r.key,n,new Qe(i.toArray()),nr.none())}}function KS(r,e,t){r instanceof Sr?function(i,s,a){let l=i.value.clone(),u=Eg(i.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(r,e,t):r instanceof ft?function(i,s,a){if(!ko(i.precondition,s))return void s.convertToUnknownDocument(a.version);let l=Eg(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(Dy(i)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Fi(r,e,t,n){return r instanceof Sr?function(s,a,l,u){if(!ko(s.precondition,a))return l;let h=s.value.clone(),f=Ig(s.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(r,e,t,n):r instanceof ft?function(s,a,l,u){if(!ko(s.precondition,a))return l;let h=Ig(s.fieldTransforms,u,a),f=a.data;return f.setAll(Dy(s)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(r,e,t,n):function(s,a,l){return ko(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(r,e,t)}function HS(r,e){let t=null;for(let n of r.fieldTransforms){let i=e.data.field(n.field),s=Sy(n.transform,i||null);s!=null&&(t===null&&(t=ze.empty()),t.set(n.field,s))}return t||null}function Tg(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&In(n,i,(s,a)=>GS(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}var Sr=class extends Vn{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ft=class extends Vn{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Dy(r){let e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=r.data.field(t);e.set(t,n)}}),e}function Eg(r,e,t){let n=new Map;ee(r.length===t.length);for(let i=0;i<t.length;i++){let s=r[i],a=s.transform,l=e.data.field(s.field);n.set(s.field,zS(a,l,t[i]))}return n}function Ig(r,e,t){let n=new Map;for(let i of r){let s=i.transform,a=t.data.field(i.field);n.set(i.field,qS(s,a,e))}return n}var Bo=class extends Vn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ou=class extends Vn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Nu=class{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&KS(s,e,n[i])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Fi(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Fi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=Ay();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;let u=ky(a,l);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(q.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),H())}isEqual(e){return this.batchId===e.batchId&&In(this.mutations,e.mutations,(t,n)=>Tg(t,n))&&In(this.baseMutations,e.baseMutations,(t,n)=>Tg(t,n))}},Vu=class r{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ee(e.mutations.length===n.length);let i=function(){return FS}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new r(e,t,n,i)}};var Lu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Mu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fe,J;function WS(r){switch(r){case D.OK:return F();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return F()}}function Oy(r){if(r===void 0)return Ct("GRPC error has no .code"),D.UNKNOWN;switch(r){case fe.OK:return D.OK;case fe.CANCELLED:return D.CANCELLED;case fe.UNKNOWN:return D.UNKNOWN;case fe.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case fe.INTERNAL:return D.INTERNAL;case fe.UNAVAILABLE:return D.UNAVAILABLE;case fe.UNAUTHENTICATED:return D.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case fe.NOT_FOUND:return D.NOT_FOUND;case fe.ALREADY_EXISTS:return D.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return D.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case fe.ABORTED:return D.ABORTED;case fe.OUT_OF_RANGE:return D.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return D.UNIMPLEMENTED;case fe.DATA_LOSS:return D.DATA_LOSS;default:return F()}}(J=fe||(fe={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var Ag=null;function QS(){return new TextEncoder}var JS=new Rt([4294967295,4294967295],0);function xg(r){let e=QS().encode(r),t=new eu;return t.update(e),new Uint8Array(t.digest())}function Sg(r){let e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rt([t,n],0),new Rt([i,s],0)]}var Fu=class r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new br(`Invalid padding: ${t}`);if(n<0)throw new br(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new br(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new br(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Rt.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(Rt.fromNumber(n)));return i.compare(JS)===1&&(i=new Rt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;let t=xg(e),[n,i]=Sg(t);for(let s=0;s<this.hashCount;s++){let a=this.Ae(n,i,s);if(!this.Re(a))return!1}return!0}static create(e,t,n){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new r(s,i,t);return n.forEach(l=>a.insert(l)),a}insert(e){if(this.Ee===0)return;let t=xg(e),[n,i]=Sg(t);for(let s=0;s<this.hashCount;s++){let a=this.Ae(n,i,s);this.Ve(a)}}Ve(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},br=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var $o=class r{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let i=new Map;return i.set(e,qi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new r(q.min(),i,new he(Q),Nt(),H())}},qi=class r{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new r(n,t,H(),H(),H())}};var bn=class{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}},qo=class{constructor(e,t){this.targetId=e,this.ge=t}},zo=class{constructor(e,t,n=ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}},Go=class{constructor(){this.pe=0,this.ye=Rg(),this.we=ke.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=H(),t=H(),n=H();return this.ye.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:F()}}),new qi(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Rg()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,ee(this.pe>=0)}Le(){this.be=!0,this.Se=!0}},ju=class{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Nt(),this.$e=So(),this.Ke=So(),this.Ue=new he(Q)}We(e){for(let t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(let t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{let n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:F()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){let t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){let s=i.target;if(Cu(s))if(n===0){let a=new j(s.path);this.ze(t,a,et.newNoDocument(a,q.min()))}else ee(n===1);else{let a=this.et(t);if(a!==n){let l=this.tt(e),u=l?this.nt(l,e,a):1;if(u!==0){this.Ye(t);let h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,h)}Ag==null||Ag.rt(function(f,m,g,E,P){var C,R,N,M,U,G;let Y={localCacheCount:f,existenceFilterCount:m.count,databaseId:g.database,projectId:g.projectId},B=m.unchangedNames;return B&&(Y.bloomFilter={applied:P===0,hashCount:(C=B==null?void 0:B.hashCount)!==null&&C!==void 0?C:0,bitmapLength:(M=(N=(R=B==null?void 0:B.bits)===null||R===void 0?void 0:R.bitmap)===null||N===void 0?void 0:N.length)!==null&&M!==void 0?M:0,padding:(G=(U=B==null?void 0:B.bits)===null||U===void 0?void 0:U.padding)!==null&&G!==void 0?G:0,mightContain:T=>{var y;return(y=E==null?void 0:E.mightContain(T))!==null&&y!==void 0&&y}}),Y}(a,e.ge,this.ke.it(),l,u))}}}}tt(e){let t=e.ge.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t,a,l;try{a=Dt(n).toUint8Array()}catch(u){if(u instanceof Mo)return En("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Fu(a,i,s)}catch(u){return En(u instanceof br?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ee===0?null:l}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){let n=this.ke.getRemoteKeysForTarget(t),i=0;return n.forEach(s=>{let a=this.ke.it(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.ze(t,s,null),i++)}),i}ot(e){let t=new Map;this.qe.forEach((s,a)=>{let l=this.Xe(a);if(l){if(s.current&&Cu(l.target)){let u=new j(l.target.path);this._t(u).has(a)||this.ut(a,u)||this.ze(a,u,et.newNoDocument(u,e))}s.ve&&(t.set(a,s.Fe()),s.Me())}});let n=H();this.Ke.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{let h=this.Xe(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.Qe.forEach((s,a)=>a.setReadTime(e));let i=new $o(e,t,this.Ue,this.Qe,n);return this.Qe=Nt(),this.$e=So(),this.Ke=So(),this.Ue=new he(Q),i}Ge(e,t){if(!this.Je(e))return;let n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;let i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){let t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Go,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new ve(Q),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new ve(Q),this.$e=this.$e.insert(e,t)),t}Je(e){let t=this.Xe(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){let t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Go),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}};function So(){return new he(j.comparator)}function Rg(){return new he(j.comparator)}var YS={asc:"ASCENDING",desc:"DESCENDING"},XS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZS={and:"AND",or:"OR"},Uu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Bu(r,e){return r.useProto3Json||ga(e)?e:{value:e}}function Ko(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ny(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function eR(r,e){return Ko(r,e.toTimestamp())}function ut(r){return ee(!!r),q.fromTimestamp(function(t){let n=kt(t);return new Te(n.seconds,n.nanos)}(r))}function eh(r,e){return $u(r,e).canonicalString()}function $u(r,e){let t=function(i){return new me(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Vy(r){let e=me.fromString(r);return ee(Uy(e)),e}function qu(r,e){return eh(r.databaseId,e.path)}function ou(r,e){let t=Vy(e);if(t.get(1)!==r.databaseId.projectId)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new j(My(t))}function Ly(r,e){return eh(r.databaseId,e)}function tR(r){let e=Vy(r);return e.length===4?me.emptyPath():My(e)}function zu(r){return new me(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function My(r){return ee(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Pg(r,e,t){return{name:qu(r,e),fields:t.value.mapValue.fields}}function rR(r,e){let t;if("targetChange"in e){e.targetChange;let n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:F()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(ee(f===void 0||typeof f=="string"),ke.fromBase64String(f||"")):(ee(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ke.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){let f=h.code===void 0?D.UNKNOWN:Oy(h.code);return new L(f,h.message||"")}(a);t=new zo(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let i=ou(r,n.document.name),s=ut(n.document.updateTime),a=n.document.createTime?ut(n.document.createTime):q.min(),l=new ze({mapValue:{fields:n.document.fields}}),u=et.newFoundDocument(i,s,a,l),h=n.targetIds||[],f=n.removedTargetIds||[];t=new bn(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let i=ou(r,n.document),s=n.readTime?ut(n.readTime):q.min(),a=et.newNoDocument(i,s),l=n.removedTargetIds||[];t=new bn([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let i=ou(r,n.document),s=n.removedTargetIds||[];t=new bn([],s,i,null)}else{if(!("filter"in e))return F();{e.filter;let n=e.filter;n.targetId;let{count:i=0,unchangedNames:s}=n,a=new Mu(i,s),l=n.targetId;t=new qo(l,a)}}return t}function nR(r,e){let t;if(e instanceof Sr)t={update:Pg(r,e.key,e.value)};else if(e instanceof Bo)t={delete:qu(r,e.key)};else if(e instanceof ft)t={update:Pg(r,e.key,e.data),updateMask:dR(e.fieldMask)};else{if(!(e instanceof Ou))return F();t={verify:qu(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){let l=a.transform;if(l instanceof On)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ar)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof xr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Nn)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw F()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:eR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:F()}(r,e.precondition)),t}function iR(r,e){return r&&r.length>0?(ee(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?ut(i.updateTime):ut(s);return a.isEqual(q.min())&&(a=ut(s)),new Du(a,i.transformResults||[])}(t,e))):[]}function sR(r,e){return{documents:[Ly(r,e.path)]}}function oR(r,e){let t={structuredQuery:{}},n=e.path,i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Ly(r,i);let s=function(h){if(h.length!==0)return jy(dt.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(h){if(h.length!==0)return h.map(f=>function(g){return{field:_n(g.field),direction:uR(g.dir)}}(f))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let l=Bu(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ht:t,parent:i}}function aR(r){let e=tR(r.parent),t=r.structuredQuery,n=t.from?t.from.length:0,i=null;if(n>0){ee(n===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(m){let g=Fy(m);return g instanceof dt&&yy(g)?g.getFilters():[g]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(g=>function(P){return new Cn(wn(P.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,ga(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(m){let g=!!m.before,E=m.values||[];return new Pn(E,g)}(t.startAt));let h=null;return t.endAt&&(h=function(m){let g=!m.before,E=m.values||[];return new Pn(E,g)}(t.endAt)),DS(e,i,a,s,l,"F",u,h)}function lR(r,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Fy(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=wn(t.unaryFilter.field);return ye.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=wn(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=wn(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=wn(t.unaryFilter.field);return ye.create(a,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(r):r.fieldFilter!==void 0?function(t){return ye.create(wn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return dt.create(t.compositeFilter.filters.map(n=>Fy(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return F()}}(t.compositeFilter.op))}(r):F()}function uR(r){return YS[r]}function cR(r){return XS[r]}function hR(r){return ZS[r]}function _n(r){return{fieldPath:r.canonicalString()}}function wn(r){return Ge.fromServerFormat(r.fieldPath)}function jy(r){return r instanceof ye?function(t){if(t.op==="=="){if(gg(t.value))return{unaryFilter:{field:_n(t.field),op:"IS_NAN"}};if(mg(t.value))return{unaryFilter:{field:_n(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gg(t.value))return{unaryFilter:{field:_n(t.field),op:"IS_NOT_NAN"}};if(mg(t.value))return{unaryFilter:{field:_n(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_n(t.field),op:cR(t.op),value:t.value}}}(r):r instanceof dt?function(t){let n=t.getFilters().map(i=>jy(i));return n.length===1?n[0]:{compositeFilter:{op:hR(t.op),filters:n}}}(r):F()}function dR(r){let e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Uy(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}var zi=class r{constructor(e,t,n,i,s=q.min(),a=q.min(),l=ke.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Gu=class{constructor(e){this.Tt=e}};function fR(r){let e=aR({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?ku(e,e.limit,"L"):e}var Ho=class{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(ae(e.integerValue));else if("doubleValue"in e){let n=ae(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Ui(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),typeof n=="string"&&(n=kt(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(Dt(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?py(e)?this.ft(t,Number.MAX_SAFE_INTEGER):fy(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):F()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){let n=e.fields||{};this.ft(t,55);for(let i of Object.keys(n))this.wt(i,t),this.Rt(n[i],t)}vt(e,t){var n,i;let s=e.fields||{};this.ft(t,53);let a=xn,l=((i=(n=s[a].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(ae(l)),this.wt(a,t),this.Rt(s[a],t)}Ft(e,t){let n=e.values||[];this.ft(t,50);for(let i of n)this.Rt(i,t)}Dt(e,t){this.ft(t,37),j.fromName(e).path.forEach(n=>{this.ft(t,60),this.Mt(n,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}};Ho.xt=new Ho;var Ku=class{constructor(){this.Tn=new Hu}addToCollectionParentIndex(e,t){return this.Tn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(Ir.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(Ir.min())}updateCollectionGroup(e,t,n){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},Hu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ve(me.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ve(me.comparator)).toArray()}};var fj=new Uint8Array(0);var Cg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},By=41943040,We=class r{static withCacheSize(e){return new r(e,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};We.DEFAULT_COLLECTION_PERCENTILE=10,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,We.DEFAULT=new We(By,We.DEFAULT_COLLECTION_PERCENTILE,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),We.DISABLED=new We(-1,0,0);var Gi=class r{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new r(0)}static Un(){return new r(-1)}};var kg="LruGarbageCollector",pR=1048576;function Dg([r,e],[t,n]){let i=Q(r,t);return i===0?Q(e,n):i}var Wu=class{constructor(e){this.Hn=e,this.buffer=new ve(Dg),this.Jn=0}Yn(){return++this.Jn}Zn(e){let t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();Dg(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},Qu=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){V(kg,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Bn(t)?V(kg,"Ignoring IndexedDB error during garbage collection: ",t):await Un(t)}await this.er(3e5)})}},Ju=class{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return k.resolve(An.ae);let n=new Wu(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(Cg)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Cg):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,s,a,l,u,h,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(n=m,l=Date.now(),this.removeTargets(e,n,t))).next(m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(h=Date.now(),gn()<=W.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}};function mR(r,e){return new Ju(r,e)}var Yu=class{constructor(){this.changes=new Ot(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?k.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Xu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Zu=class{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Fi(n.mutation,i,Qe.empty(),Te.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,H()).next(()=>n))}getLocalViewOfDocuments(e,t,n=H()){let i=vr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=Ni();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let n=vr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,H()))}populateOverlays(e,t,n){let i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,n,i){let s=Nt(),a=Mi(),l=function(){return Mi()}();return t.forEach((u,h)=>{let f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof ft)?s=s.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),Fi(f.mutation,h,f.mutation.getFieldMask(),Te.now())):a.set(h.key,Qe.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>a.set(h,f)),t.forEach((h,f)=>{var m;return l.set(h,new Xu(f,(m=a.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){let n=Mi(),i=new he((a,l)=>a-l),s=H();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let l of a)l.keys().forEach(u=>{let h=t.get(u);if(h===null)return;let f=n.get(u)||Qe.empty();f=l.applyToLocalView(h,f),n.set(u,f);let m=(i.get(l.batchId)||H()).add(u);i=i.insert(l.batchId,m)})}).next(()=>{let a=[],l=i.getReverseIterator();for(;l.hasNext();){let u=l.getNext(),h=u.key,f=u.value,m=Ay();f.forEach(g=>{if(!s.has(g)){let E=ky(t.get(g),n.get(g));E!==null&&m.set(g,E),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return j.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):OS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):k.resolve(vr()),l=ji,u=s;return a.next(h=>k.forEach(h,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,H())).next(f=>({batchId:l,changes:Iy(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(n=>{let i=Ni();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){let s=t.collectionGroup,a=Ni();return this.indexManager.getCollectionParents(e,s).next(l=>k.forEach(l,u=>{let h=function(m,g){return new kn(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((m,g)=>{a=a.insert(m,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((u,h)=>{let f=h.getKey();a.get(f)===null&&(a=a.insert(f,et.newInvalidDocument(f)))});let l=Ni();return a.forEach((u,h)=>{let f=s.get(u);f!==void 0&&Fi(f.mutation,h,Qe.empty(),Te.now()),va(t,h)&&(l=l.insert(u,h))}),l})}};var ec=class{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return k.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ut(i.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:fR(i.bundledQuery),readTime:ut(i.readTime)}}(t)),k.resolve()}};var tc=class{constructor(){this.overlays=new he(j.comparator),this.Rr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let n=vr();return k.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.Et(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,n){let i=this.Rr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),k.resolve()}getOverlaysForCollection(e,t,n){let i=vr(),s=t.length+1,a=new j(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){let u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return k.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new he((h,f)=>h-f),a=this.overlays.getIterator();for(;a.hasNext();){let h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let f=s.get(h.largestBatchId);f===null&&(f=vr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let l=vr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>l.set(h,f)),!(l.size()>=i)););return k.resolve(l)}Et(e,t,n){let i=this.overlays.get(n.key);if(i!==null){let a=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Lu(t,n));let s=this.Rr.get(t);s===void 0&&(s=H(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}};var rc=class{constructor(){this.sessionToken=ke.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var Ki=class{constructor(){this.Vr=new ve(pe.mr),this.gr=new ve(pe.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){let n=new pe(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new pe(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){let t=new j(new me([])),n=new pe(t,e),i=new pe(t,e+1),s=[];return this.gr.forEachInRange([n,i],a=>{this.wr(a),s.push(a.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){let t=new j(new me([])),n=new pe(t,e),i=new pe(t,e+1),s=H();return this.gr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new pe(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},pe=class{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return j.comparator(e.key,t.key)||Q(e.Cr,t.Cr)}static pr(e,t){return Q(e.Cr,t.Cr)||j.comparator(e.key,t.key)}};var nc=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new ve(pe.mr)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){let s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Nu(s,t,n,i);this.mutationQueue.push(a);for(let l of i)this.Mr=this.Mr.add(new pe(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=this.Nr(n),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?Kc:this.Fr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new pe(t,0),i=new pe(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,i],a=>{let l=this.Or(a.Cr);s.push(l)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ve(Q);return t.forEach(i=>{let s=new pe(i,0),a=new pe(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,a],l=>{n=n.add(l.Cr)})}),k.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=n;j.isDocumentKey(s)||(s=s.child(""));let a=new pe(new j(s),0),l=new ve(Q);return this.Mr.forEachWhile(u=>{let h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.Cr)),!0)},a),k.resolve(this.Br(l))}Br(e){let t=[];return e.forEach(n=>{let i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return k.forEach(t.mutations,i=>{let s=new pe(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){let n=new pe(t,0),i=this.Mr.firstAfterOrEqual(n);return k.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){let t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ic=class{constructor(e){this.kr=e,this.docs=function(){return new he(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return k.resolve(n?n.document.mutableCopy():et.newInvalidDocument(t))}getEntries(e,t){let n=Nt();return t.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():et.newInvalidDocument(i))}),k.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Nt(),a=t.path,l=new j(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){let{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||fS(dS(f),n)<=0||(i.has(f.key)||va(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,n,i){F()}qr(e,t){return k.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new sc(this)}getSize(e){return k.resolve(this.size)}},sc=class extends Yu{constructor(e){super(),this.Ir=e}applyChanges(e){let t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),k.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}};var oc=class{constructor(e){this.persistence=e,this.Qr=new Ot(t=>Yc(t),Xc),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.$r=0,this.Kr=new Ki,this.targetCount=0,this.Ur=Gi.Kn()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),k.resolve()}zn(e){this.Qr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Ur=new Gi(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.zn(t),k.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.br(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,n){let i=0,s=[];return this.Qr.forEach((a,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.Qr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let n=this.Qr.get(t)||null;return k.resolve(n)}addMatchingKeys(e,t,n){return this.Kr.yr(t,n),k.resolve()}removeMatchingKeys(e,t,n){this.Kr.Sr(t,n);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Kr.br(t),k.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Kr.vr(t);return k.resolve(n)}containsKey(e,t){return k.resolve(this.Kr.containsKey(t))}};var Wo=class{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new An(0),this.zr=!1,this.zr=!0,this.jr=new rc,this.referenceDelegate=e(this),this.Hr=new oc(this),this.indexManager=new Ku,this.remoteDocumentCache=function(i){return new ic(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new Gu(t),this.Yr=new ec(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new nc(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){V("MemoryPersistence","Starting transaction:",e);let i=new ac(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return k.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}},ac=class extends yu{constructor(e){super(),this.currentSequenceNumber=e}},lc=class r{constructor(e){this.persistence=e,this.ti=new Ki,this.ni=null}static ri(e){return new r(e)}get ii(){if(this.ni)return this.ni;throw F()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),k.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),k.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.ii,n=>{let i=j.fromPath(n);return this.si(e,i).next(s=>{s||t.removeEntry(i,q.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return k.or([()=>k.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}},Qo=class r{constructor(e,t){this.persistence=e,this.oi=new Ot(n=>yS(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=mR(this,t)}static ri(e,t){return new r(e,t)}Zr(){}Xr(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){let t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return k.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(s=>s?k.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,a=>this.ar(e,a,t).next(l=>{l||(n++,s.removeEntry(a,q.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),k.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),k.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Po(e.data.value)),t}ar(e,t,n){return k.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.oi.get(t);return k.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var uc=class r{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=H(),i=H();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new r(e,t.fromCache,n,i)}};var cc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var hc=class{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return Fm()?8:mS(Mm())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){let s={result:null};return this.rs(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ss(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new cc;return this._s(e,t,a).next(l=>{if(s.result=l,this.Xi)return this.us(e,t,a,l.size)})}).next(()=>s.result)}us(e,t,n,i){return n.documentReadCount<this.es?(gn()<=W.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",yn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),k.resolve()):(gn()<=W.DEBUG&&V("QueryEngine","Query:",yn(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(gn()<=W.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",yn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lt(t))):k.resolve())}rs(e,t){if(vg(t))return k.resolve(null);let n=lt(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ku(t,null,"F"),n=lt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=H(...s);return this.ns.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{let h=this.cs(t,l);return this.ls(t,h,a,u.readTime)?this.rs(e,ku(t,null,"F")):this.hs(e,h,t,u)}))})))}ss(e,t,n,i){return vg(t)||i.isEqual(q.min())?k.resolve(null):this.ns.getDocuments(e,n).next(s=>{let a=this.cs(t,s);return this.ls(t,a,n,i)?k.resolve(null):(gn()<=W.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),yn(t)),this.hs(e,a,t,hS(i,ji)).next(l=>l))})}cs(e,t){let n=new ve(Ty(e));return t.forEach((i,s)=>{va(e,s)&&(n=n.add(s))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,n){return gn()<=W.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",yn(t)),this.ns.getDocumentsMatchingQuery(e,t,Ir.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var th="LocalStore",gR=3e8,dc=class{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new he(Q),this.Is=new Ot(s=>Yc(s),Xc),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zu(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}};function yR(r,e,t,n){return new dc(r,e,t,n)}async function $y(r,e){let t=$(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{let a=[],l=[],u=H();for(let h of i){a.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}for(let h of s){l.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(n,u).next(h=>({Rs:h,removedBatchIds:a,addedBatchIds:l}))})})}function _R(r,e){let t=$(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(l,u,h,f){let m=h.batch,g=m.keys(),E=k.resolve();return g.forEach(P=>{E=E.next(()=>f.getEntry(u,P)).next(C=>{let R=h.docVersions.get(P);ee(R!==null),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=H();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function qy(r){let e=$(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function wR(r,e){let t=$(r),n=e.snapshotVersion,i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;let l=[];e.targetChanges.forEach((f,m)=>{let g=i.get(m);if(!g)return;l.push(t.Hr.removeMatchingKeys(s,f.removedDocuments,m).next(()=>t.Hr.addMatchingKeys(s,f.addedDocuments,m)));let E=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?E=E.withResumeToken(ke.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(m,E),function(C,R,N){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=gR?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(g,E,f)&&l.push(t.Hr.updateTargetData(s,E))});let u=Nt(),h=H();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(vR(s,a,e.documentUpdates).next(f=>{u=f.Vs,h=f.fs})),!n.isEqual(q.min())){let f=t.Hr.getLastRemoteSnapshotVersion(s).next(m=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(f)}return k.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(t.Ts=i,s))}function vR(r,e,t){let n=H(),i=H();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=Nt();return t.forEach((l,u)=>{let h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(q.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):V(th,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Vs:a,fs:i}})}function bR(r,e){let t=$(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Kc),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function TR(r,e){let t=$(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(s=>s?(i=s,k.resolve(i)):t.Hr.allocateTargetId(n).next(a=>(i=new zi(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function fc(r,e,t){let n=$(r),i=n.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Bn(a))throw a;V(th,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Og(r,e,t){let n=$(r),i=q.min(),s=H();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){let m=$(u),g=m.Is.get(f);return g!==void 0?k.resolve(m.Ts.get(g)):m.Hr.getTargetData(h,f)}(n,a,lt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>n.Ps.getDocumentsMatchingQuery(a,e,t?i:q.min(),t?s:H())).next(l=>(ER(n,VS(e),l),{documents:l,gs:s})))}function ER(r,e,t){let n=r.Es.get(e)||q.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Es.set(e,n)}var Jo=class{constructor(){this.activeTargetIds=BS()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var pc=class{constructor(){this.ho=new Jo,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Jo,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var mc=class{To(e){}shutdown(){}};var Ng="ConnectivityMonitor",Yo=class{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){V(Ng,"Network connectivity changed: AVAILABLE");for(let e of this.Vo)e(0)}Ro(){V(Ng,"Network connectivity changed: UNAVAILABLE");for(let e of this.Vo)e(1)}static D(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ro=null;function gc(){return Ro===null?Ro=function(){return 268435456+Math.round(2147483648*Math.random())}():Ro++,"0x"+Ro.toString(16)}var au="RestConnection",IR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},yc=class{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===Fo?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,s){let a=gc(),l=this.bo(e,t.toUriEncodedString());V(au,`Sending RPC '${e}' ${a}:`,l,n);let u={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(u,i,s),this.vo(e,l,u,n).then(h=>(V(au,`Received RPC '${e}' ${a}: `,h),h),h=>{throw En(au,`RPC '${e}' ${a} failed with error: `,h,"url: ",l,"request:",n),h})}Co(e,t,n,i,s,a){return this.So(e,t,n,i,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}bo(e,t){let n=IR[e];return`${this.po}/v1/${t}:${n}`}terminate(){}};var _c=class{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}};var Ce="WebChannelConnection",wc=class extends yc{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){let s=gc();return new Promise((a,l)=>{let u=new tu;u.setWithCredentials(!0),u.listenOnce(ru.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Oi.NO_ERROR:let f=u.getResponseJson();V(Ce,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Oi.TIMEOUT:V(Ce,`RPC '${e}' ${s} timed out`),l(new L(D.DEADLINE_EXCEEDED,"Request time out"));break;case Oi.HTTP_ERROR:let m=u.getStatus();if(V(Ce,`RPC '${e}' ${s} failed with status:`,m,"response text:",u.getResponseText()),m>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let E=g==null?void 0:g.error;if(E&&E.status&&E.message){let P=function(R){let N=R.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(N)>=0?N:D.UNKNOWN}(E.status);l(new L(P,E.message))}else l(new L(D.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new L(D.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{V(Ce,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);V(Ce,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",h,n,15)})}Wo(e,t,n){let i=gc(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=su(),l=iu(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;let f=s.join("");V(Ce,`Creating RPC '${e}' stream ${i}: ${f}`,u);let m=a.createWebChannel(f,u),g=!1,E=!1,P=new _c({Fo:R=>{E?V(Ce,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(g||(V(Ce,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),V(Ce,`RPC '${e}' stream ${i} sending:`,R),m.send(R))},Mo:()=>m.close()}),C=(R,N,M)=>{R.listen(N,U=>{try{M(U)}catch(G){setTimeout(()=>{throw G},0)}})};return C(m,mn.EventType.OPEN,()=>{E||(V(Ce,`RPC '${e}' stream ${i} transport opened.`),P.Qo())}),C(m,mn.EventType.CLOSE,()=>{E||(E=!0,V(Ce,`RPC '${e}' stream ${i} transport closed`),P.Ko())}),C(m,mn.EventType.ERROR,R=>{E||(E=!0,En(Ce,`RPC '${e}' stream ${i} transport errored:`,R),P.Ko(new L(D.UNAVAILABLE,"The operation could not be completed")))}),C(m,mn.EventType.MESSAGE,R=>{var N;if(!E){let M=R.data[0];ee(!!M);let U=M,G=(U==null?void 0:U.error)||((N=U[0])===null||N===void 0?void 0:N.error);if(G){V(Ce,`RPC '${e}' stream ${i} received error:`,G);let Y=G.status,B=function(w){let b=fe[w];if(b!==void 0)return Oy(b)}(Y),T=G.message;B===void 0&&(B=D.INTERNAL,T="Unknown error status: "+Y+" with message "+G.message),E=!0,P.Ko(new L(B,T)),m.close()}else V(Ce,`RPC '${e}' stream ${i} received:`,M),P.Uo(M)}}),C(l,nu.STAT_EVENT,R=>{R.stat===Ao.PROXY?V(Ce,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Ao.NOPROXY&&V(Ce,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.$o()},0),P}};function lu(){return typeof document!="undefined"?document:null}function ba(r){return new Uu(r,!0)}var Xo=class{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();let t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}};var Vg="PersistentStream",Zo=class{constructor(e,t,n,i,s,a,l,u){this.Ti=e,this.n_=n,this.r_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Xo(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(Ct(t.toString()),Ct("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;let e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{let i=new L(D.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){let n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return V(Vg,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(V(Vg,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},vc=class extends Zo{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();let t=rR(this.serializer,e),n=function(s){if(!("targetChange"in s))return q.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?ut(a.readTime):q.min()}(e);return this.listener.p_(t,n)}y_(e){let t={};t.database=zu(this.serializer),t.addTarget=function(s,a){let l,u=a.target;if(l=Cu(u)?{documents:sR(s,u)}:{query:oR(s,u).ht},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Ny(s,a.resumeToken);let h=Bu(s,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(q.min())>0){l.readTime=Ko(s,a.snapshotVersion.toTimestamp());let h=Bu(s,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);let n=lR(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){let t={};t.database=zu(this.serializer),t.removeTarget=e,this.I_(t)}},bc=class extends Zo{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return ee(!!e.streamToken),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();let t=iR(e.writeResults,e.commitTime),n=ut(e.commitTime);return this.listener.v_(n,t)}C_(){let e={};e.database=zu(this.serializer),this.I_(e)}b_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>nR(this.serializer,n))};this.I_(t)}};var Tc=class{},Ec=class extends Tc{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.So(e,$u(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(D.UNKNOWN,s.toString())})}Co(e,t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Co(e,$u(t,n),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(D.UNKNOWN,a.toString())})}terminate(){this.F_=!0,this.connection.terminate()}},Ic=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Ct(t),this.N_=!1):V("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}};var Rr="RemoteStore",Ac=class{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(a=>{n.enqueueAndForget(async()=>{Pr(this)&&(V(Rr,"Restarting streams for network reachability change."),await async function(u){let h=$(u);h.W_.add(4),await es(h),h.j_.set("Unknown"),h.W_.delete(4),await Ta(h)}(this))})}),this.j_=new Ic(n,i)}};async function Ta(r){if(Pr(r))for(let e of r.G_)await e(!0)}async function es(r){for(let e of r.G_)await e(!1)}function zy(r,e){let t=$(r);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),sh(t)?ih(t):$n(t).c_()&&nh(t,e))}function rh(r,e){let t=$(r),n=$n(t);t.U_.delete(e),n.c_()&&Gy(t,e),t.U_.size===0&&(n.c_()?n.P_():Pr(t)&&t.j_.set("Unknown"))}function nh(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$n(r).y_(e)}function Gy(r,e){r.H_.Ne(e),$n(r).w_(e)}function ih(r){r.H_=new ju({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.U_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),$n(r).start(),r.j_.B_()}function sh(r){return Pr(r)&&!$n(r).u_()&&r.U_.size>0}function Pr(r){return $(r).W_.size===0}function Ky(r){r.H_=void 0}async function AR(r){r.j_.set("Online")}async function xR(r){r.U_.forEach((e,t)=>{nh(r,e)})}async function SR(r,e){Ky(r),sh(r)?(r.j_.q_(e),ih(r)):r.j_.set("Unknown")}async function RR(r,e,t){if(r.j_.set("Online"),e instanceof zo&&e.state===2&&e.cause)try{await async function(i,s){let a=s.cause;for(let l of s.targetIds)i.U_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.U_.delete(l),i.H_.removeTarget(l))}(r,e)}catch(n){V(Rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ea(r,n)}else if(e instanceof bn?r.H_.We(e):e instanceof qo?r.H_.Ze(e):r.H_.je(e),!t.isEqual(q.min()))try{let n=await qy(r.localStore);t.compareTo(n)>=0&&await function(s,a){let l=s.H_.ot(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){let f=s.U_.get(h);f&&s.U_.set(h,f.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{let f=s.U_.get(u);if(!f)return;s.U_.set(u,f.withResumeToken(ke.EMPTY_BYTE_STRING,f.snapshotVersion)),Gy(s,u);let m=new zi(f.target,u,h,f.sequenceNumber);nh(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(r,t)}catch(n){V(Rr,"Failed to raise snapshot:",n),await ea(r,n)}}async function ea(r,e,t){if(!Bn(e))throw e;r.W_.add(1),await es(r),r.j_.set("Offline"),t||(t=()=>qy(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{V(Rr,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await Ta(r)})}function Hy(r,e){return e().catch(t=>ea(r,t,e))}async function Ea(r){let e=$(r),t=sr(e),n=e.K_.length>0?e.K_[e.K_.length-1].batchId:Kc;for(;PR(e);)try{let i=await bR(e.localStore,n);if(i===null){e.K_.length===0&&t.P_();break}n=i.batchId,CR(e,i)}catch(i){await ea(e,i)}Wy(e)&&Qy(e)}function PR(r){return Pr(r)&&r.K_.length<10}function CR(r,e){r.K_.push(e);let t=sr(r);t.c_()&&t.S_&&t.b_(e.mutations)}function Wy(r){return Pr(r)&&!sr(r).u_()&&r.K_.length>0}function Qy(r){sr(r).start()}async function kR(r){sr(r).C_()}async function DR(r){let e=sr(r);for(let t of r.K_)e.b_(t.mutations)}async function OR(r,e,t){let n=r.K_.shift(),i=Vu.from(n,e,t);await Hy(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Ea(r)}async function NR(r,e){e&&sr(r).S_&&await async function(n,i){if(function(a){return WS(a)&&a!==D.ABORTED}(i.code)){let s=n.K_.shift();sr(n).h_(),await Hy(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ea(n)}}(r,e),Wy(r)&&Qy(r)}async function Lg(r,e){let t=$(r);t.asyncQueue.verifyOperationInProgress(),V(Rr,"RemoteStore received new credentials");let n=Pr(t);t.W_.add(3),await es(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await Ta(t)}async function VR(r,e){let t=$(r);e?(t.W_.delete(2),await Ta(t)):e||(t.W_.add(2),await es(t),t.j_.set("Unknown"))}function $n(r){return r.J_||(r.J_=function(t,n,i){let s=$(t);return s.M_(),new vc(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:AR.bind(null,r),No:xR.bind(null,r),Lo:SR.bind(null,r),p_:RR.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),sh(r)?ih(r):r.j_.set("Unknown")):(await r.J_.stop(),Ky(r))})),r.J_}function sr(r){return r.Y_||(r.Y_=function(t,n,i){let s=$(t);return s.M_(),new bc(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:kR.bind(null,r),Lo:NR.bind(null,r),D_:DR.bind(null,r),v_:OR.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await Ea(r)):(await r.Y_.stop(),r.K_.length>0&&(V(Rr,`Stopping write stream with ${r.K_.length} pending writes`),r.K_=[]))})),r.Y_}var xc=class r{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){let a=Date.now()+n,l=new r(e,t,a,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function oh(r,e){if(Ct("AsyncQueue",`${e}: ${r}`),Bn(r))return new L(D.UNAVAILABLE,`${e}: ${r}`);throw r}var ta=class r{static emptySet(e){return new r(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||j.comparator(t.key,n.key):(t,n)=>j.comparator(t.key,n.key),this.keyedMap=Ni(),this.sortedSet=new he(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new r;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var ra=class{constructor(){this.Z_=new he(j.comparator)}track(e){let t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):F():this.Z_=this.Z_.insert(t,e)}X_(){let e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}},Ln=class r{constructor(e,t,n,i,s,a,l,u,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,i,s){let a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new r(e,t,ta.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}};var Sc=class{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}},Rc=class{constructor(){this.queries=Mg(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){let i=$(t),s=i.queries;i.queries=Mg(),s.forEach((a,l)=>{for(let u of l.ta)u.onError(n)})})(this,new L(D.ABORTED,"Firestore shutting down"))}};function Mg(){return new Ot(r=>by(r),wa)}async function Jy(r,e){let t=$(r),n=3,i=e.query,s=t.queries.get(i);s?!s.na()&&e.ra()&&(n=2):(s=new Sc,n=e.ra()?0:1);try{switch(n){case 0:s.ea=await t.onListen(i,!0);break;case 1:s.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){let l=oh(a,`Initialization of query '${yn(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&ah(t)}async function Yy(r,e){let t=$(r),n=e.query,i=3,s=t.queries.get(n);if(s){let a=s.ta.indexOf(e);a>=0&&(s.ta.splice(a,1),s.ta.length===0?i=e.ra()?0:1:!s.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function LR(r,e){let t=$(r),n=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let l of a.ta)l.oa(i)&&(n=!0);a.ea=i}}n&&ah(t)}function MR(r,e,t){let n=$(r),i=n.queries.get(e);if(i)for(let s of i.ta)s.onError(t);n.queries.delete(e)}function ah(r){r.ia.forEach(e=>{e.next()})}var Pc,Fg;(Fg=Pc||(Pc={}))._a="default",Fg.Cache="cache";var na=class{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){let n=[];for(let i of e.docChanges)i.type!==3&&n.push(i);e=new Ln(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;let n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;let t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=Ln.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Pc.Cache}};var ia=class{constructor(e){this.key=e}},sa=class{constructor(e){this.key=e}},Cc=class{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=H(),this.mutatedKeys=H(),this.ya=Ty(e),this.wa=new ta(this.ya)}get Sa(){return this.fa}ba(e,t){let n=t?t.Da:new ra,i=t?t.wa:this.wa,s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{let g=i.get(f),E=va(this.query,m)?m:null,P=!!g&&this.mutatedKeys.has(g.key),C=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations),R=!1;g&&E?g.data.isEqual(E.data)?P!==C&&(n.track({type:3,doc:E}),R=!0):this.va(g,E)||(n.track({type:2,doc:E}),R=!0,(u&&this.ya(E,u)>0||h&&this.ya(E,h)<0)&&(l=!0)):!g&&E?(n.track({type:0,doc:E}),R=!0):g&&!E&&(n.track({type:1,doc:g}),R=!0,(u||h)&&(l=!0)),R&&(E?(a=a.add(E),s=C?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{wa:a,Da:n,ls:l,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){let s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;let a=e.Da.X_();a.sort((f,m)=>function(E,P){let C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F()}};return C(E)-C(P)}(f.type,m.type)||this.ya(f.doc,m.doc)),this.Ca(n),i=i!=null&&i;let l=t&&!i?this.Fa():[],u=this.pa.size===0&&this.current&&!i?1:0,h=u!==this.ga;return this.ga=u,a.length!==0||h?{snapshot:new Ln(this.query,e.wa,s,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:l}:{Ma:l}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new ra,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];let e=this.pa;this.pa=H(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});let t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new sa(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new ia(n))}),t}Oa(e){this.fa=e.gs,this.pa=H();let t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return Ln.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}},lh="SyncEngine",kc=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Dc=class{constructor(e){this.key=e,this.Ba=!1}},Oc=class{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.La={},this.ka=new Ot(l=>by(l),wa),this.qa=new Map,this.Qa=new Set,this.$a=new he(j.comparator),this.Ka=new Map,this.Ua=new Ki,this.Wa={},this.Ga=new Map,this.za=Gi.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}};async function FR(r,e,t=!0){let n=n_(r),i,s=n.ka.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Na()):i=await Xy(n,e,t,!0),i}async function jR(r,e){let t=n_(r);await Xy(t,e,!0,!1)}async function Xy(r,e,t,n){let i=await TR(r.localStore,lt(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t),l;return n&&(l=await UR(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&zy(r.remoteStore,i),l}async function UR(r,e,t,n,i){r.Ha=(m,g,E)=>async function(C,R,N,M){let U=R.view.ba(N);U.ls&&(U=await Og(C.localStore,R.query,!1).then(({documents:T})=>R.view.ba(T,U)));let G=M&&M.targetChanges.get(R.targetId),Y=M&&M.targetMismatches.get(R.targetId)!=null,B=R.view.applyChanges(U,C.isPrimaryClient,G,Y);return Ug(C,R.targetId,B.Ma),B.snapshot}(r,m,g,E);let s=await Og(r.localStore,e,!0),a=new Cc(e,s.gs),l=a.ba(s.documents),u=qi.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),h=a.applyChanges(l,r.isPrimaryClient,u);Ug(r,t,h.Ma);let f=new kc(e,t,a);return r.ka.set(e,f),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),h.snapshot}async function BR(r,e,t){let n=$(r),i=n.ka.get(e),s=n.qa.get(i.targetId);if(s.length>1)return n.qa.set(i.targetId,s.filter(a=>!wa(a,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await fc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&rh(n.remoteStore,i.targetId),Nc(n,i.targetId)}).catch(Un)):(Nc(n,i.targetId),await fc(n.localStore,i.targetId,!0))}async function $R(r,e){let t=$(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),rh(t.remoteStore,n.targetId))}async function qR(r,e,t){let n=JR(r);try{let i=await function(a,l){let u=$(a),h=Te.now(),f=l.reduce((E,P)=>E.add(P.key),H()),m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let P=Nt(),C=H();return u.ds.getEntries(E,f).next(R=>{P=R,P.forEach((N,M)=>{M.isValidDocument()||(C=C.add(N))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,P)).next(R=>{m=R;let N=[];for(let M of l){let U=HS(M,m.get(M.key).overlayedDocument);U!=null&&N.push(new ft(M.key,U,my(U.value.mapValue),nr.exists(!0)))}return u.mutationQueue.addMutationBatch(E,h,N,l)}).next(R=>{g=R;let N=R.applyToLocalDocumentSet(m,C);return u.documentOverlayCache.saveOverlays(E,R.batchId,N)})}).then(()=>({batchId:g.batchId,changes:Iy(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,l,u){let h=a.Wa[a.currentUser.toKey()];h||(h=new he(Q)),h=h.insert(l,u),a.Wa[a.currentUser.toKey()]=h}(n,i.batchId,t),await ts(n,i.changes),await Ea(n.remoteStore)}catch(i){let s=oh(i,"Failed to persist write");t.reject(s)}}async function Zy(r,e){let t=$(r);try{let n=await wR(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Ka.get(s);a&&(ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ba=!0:i.modifiedDocuments.size>0?ee(a.Ba):i.removedDocuments.size>0&&(ee(a.Ba),a.Ba=!1))}),await ts(t,n,e)}catch(n){await Un(n)}}function jg(r,e,t){let n=$(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let i=[];n.ka.forEach((s,a)=>{let l=a.view.sa(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){let u=$(a);u.onlineState=l;let h=!1;u.queries.forEach((f,m)=>{for(let g of m.ta)g.sa(l)&&(h=!0)}),h&&ah(u)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function zR(r,e,t){let n=$(r);n.sharedClientState.updateQueryState(e,"rejected",t);let i=n.Ka.get(e),s=i&&i.key;if(s){let a=new he(j.comparator);a=a.insert(s,et.newNoDocument(s,q.min()));let l=H().add(s),u=new $o(q.min(),new Map,new he(Q),a,l);await Zy(n,u),n.$a=n.$a.remove(s),n.Ka.delete(e),uh(n)}else await fc(n.localStore,e,!1).then(()=>Nc(n,e,t)).catch(Un)}async function GR(r,e){let t=$(r),n=e.batch.batchId;try{let i=await _R(t.localStore,e);t_(t,n,null),e_(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await ts(t,i)}catch(i){await Un(i)}}async function KR(r,e,t){let n=$(r);try{let i=await function(a,l){let u=$(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next(m=>(ee(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);t_(n,e,t),e_(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await ts(n,i)}catch(i){await Un(i)}}function e_(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function t_(r,e,t){let n=$(r),i=n.Wa[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function Nc(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(let n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ua.br(e).forEach(n=>{r.Ua.containsKey(n)||r_(r,n)})}function r_(r,e){r.Qa.delete(e.path.canonicalString());let t=r.$a.get(e);t!==null&&(rh(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ka.delete(t),uh(r))}function Ug(r,e,t){for(let n of t)n instanceof ia?(r.Ua.addReference(n.key,e),HR(r,n)):n instanceof sa?(V(lh,"Document no longer in limbo: "+n.key),r.Ua.removeReference(n.key,e),r.Ua.containsKey(n.key)||r_(r,n.key)):F()}function HR(r,e){let t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(V(lh,"New document in limbo: "+t),r.Qa.add(n),uh(r))}function uh(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){let e=r.Qa.values().next().value;r.Qa.delete(e);let t=new j(me.fromString(e)),n=r.za.next();r.Ka.set(n,new Dc(t)),r.$a=r.$a.insert(t,n),zy(r.remoteStore,new zi(lt(_a(t.path)),n,"TargetPurposeLimboResolution",An.ae))}}async function ts(r,e,t){let n=$(r),i=[],s=[],a=[];n.ka.isEmpty()||(n.ka.forEach((l,u)=>{a.push(n.Ha(u,e,t).then(h=>{var f;if((h||t)&&n.isPrimaryClient){let m=h?!h.fromCache:(f=t==null?void 0:t.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){i.push(h);let m=uc.Yi(u.targetId,h);s.push(m)}}))}),await Promise.all(a),n.La.p_(i),await async function(u,h){let f=$(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>k.forEach(h,g=>k.forEach(g.Hi,E=>f.persistence.referenceDelegate.addReference(m,g.targetId,E)).next(()=>k.forEach(g.Ji,E=>f.persistence.referenceDelegate.removeReference(m,g.targetId,E)))))}catch(m){if(!Bn(m))throw m;V(th,"Failed to update sequence numbers: "+m)}for(let m of h){let g=m.targetId;if(!m.fromCache){let E=f.Ts.get(g),P=E.snapshotVersion,C=E.withLastLimboFreeSnapshotVersion(P);f.Ts=f.Ts.insert(g,C)}}}(n.localStore,s))}async function WR(r,e){let t=$(r);if(!t.currentUser.isEqual(e)){V(lh,"User change. New user:",e.toKey());let n=await $y(t.localStore,e);t.currentUser=e,function(s,a){s.Ga.forEach(l=>{l.forEach(u=>{u.reject(new L(D.CANCELLED,a))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ts(t,n.Rs)}}function QR(r,e){let t=$(r),n=t.Ka.get(e);if(n&&n.Ba)return H().add(n.key);{let i=H(),s=t.qa.get(e);if(!s)return i;for(let a of s){let l=t.ka.get(a);i=i.unionWith(l.view.Sa)}return i}}function n_(r){let e=$(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zR.bind(null,e),e.La.p_=LR.bind(null,e.eventManager),e.La.Ja=MR.bind(null,e.eventManager),e}function JR(r){let e=$(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KR.bind(null,e),e}var Mn=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ba(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return yR(this.persistence,new hc,e.initialUser,this.serializer)}Xa(e){return new Wo(lc.ri,this.serializer)}Za(e){return new pc}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};Mn.provider={build:()=>new Mn};var Vc=class extends Mn{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){ee(this.persistence.referenceDelegate instanceof Qo);let n=this.persistence.referenceDelegate.garbageCollector;return new Qu(n,e.asyncQueue,t)}Xa(e){let t=this.cacheSizeBytes!==void 0?We.withCacheSize(this.cacheSizeBytes):We.DEFAULT;return new Wo(n=>Qo.ri(n,t),this.serializer)}};var Hi=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jg(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=WR.bind(null,this.syncEngine),await VR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Rc}()}createDatastore(e){let t=ba(e.databaseInfo.databaseId),n=function(s){return new wc(s)}(e.databaseInfo);return function(s,a,l,u){return new Ec(s,a,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,l){return new Ac(n,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>jg(this.syncEngine,t,0),function(){return Yo.D()?new Yo:new mc}())}createSyncEngine(e,t){return function(i,s,a,l,u,h,f){let m=new Oc(i,s,a,l,u,h);return f&&(m.ja=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){let s=$(i);V(Rr,"RemoteStore shutting down."),s.W_.add(5),await es(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}};Hi.provider={build:()=>new Hi};var oa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Ct("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var or="FirestoreClient",Lc=class{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=we.UNAUTHENTICATED,this.clientId=No.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{V(or,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(V(or,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=oh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}};async function uu(r,e){r.asyncQueue.verifyOperationInProgress(),V(or,"Initializing OfflineComponentProvider");let t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await $y(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Bg(r,e){r.asyncQueue.verifyOperationInProgress();let t=await YR(r);V(or,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Lg(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>Lg(e.remoteStore,i)),r._onlineComponents=e}async function YR(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){V(or,"Using user provided OfflineComponentProvider");try{await uu(r,r._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===D.FAILED_PRECONDITION||i.code===D.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;En("Error using user provided cache. Falling back to memory cache: "+t),await uu(r,new Mn)}}else V(or,"Using default OfflineComponentProvider"),await uu(r,new Vc(void 0));return r._offlineComponents}async function i_(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(V(or,"Using user provided OnlineComponentProvider"),await Bg(r,r._uninitializedComponentsProvider._online)):(V(or,"Using default OnlineComponentProvider"),await Bg(r,new Hi))),r._onlineComponents}function XR(r){return i_(r).then(e=>e.syncEngine)}async function Mc(r){let e=await i_(r),t=e.eventManager;return t.onListen=FR.bind(null,e.syncEngine),t.onUnlisten=BR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=jR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$R.bind(null,e.syncEngine),t}function ZR(r,e,t={}){let n=new ot;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){let f=new oa({next:g=>{f.su(),a.enqueueAndForget(()=>Yy(s,m));let E=g.docs.has(l);!E&&g.fromCache?h.reject(new L(D.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&g.fromCache&&u&&u.source==="server"?h.reject(new L(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new na(_a(l.path),f,{includeMetadataChanges:!0,Ta:!0});return Jy(s,m)}(await Mc(r),r.asyncQueue,e,t,n)),n.promise}function s_(r){let e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}var $g=new Map;function eP(r,e,t){if(!t)throw new L(D.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function tP(r,e,t,n){if(e===!0&&n===!0)throw new L(D.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function qg(r){if(!j.isDocumentKey(r))throw new L(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function ch(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":F()}function ct(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new L(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ch(r);throw new L(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}var o_="firestore.googleapis.com",zg=!0,aa=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new L(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=o_,this.ssl=zg}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:zg;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=By;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pR)throw new L(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=s_((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Wi=class{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aa({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aa(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new cu;switch(n.type){case"firstParty":return new pu(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new L(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=$g.get(t);n&&(V("ComponentProvider","Removing Datastore"),$g.delete(t),n.terminate())}(this),Promise.resolve()}};function rP(r,e,t,n={}){var i;let s=(r=ct(r,Wi))._getSettings(),a=`${e}:${t}`;if(s.host!==o_&&s.host!==a&&En("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=we.MOCK_USER;else{l=Lm(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);let h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new L(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new we(h)}r._authCredentials=new hu(new Do(l,u))}}var la=class r{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new r(this.firestore,e,this._query)}},je=class r{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new r(this.firestore,e,this._key)}},Qi=class r extends la{constructor(e,t,n){super(e,t,_a(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new j(e))}withConverter(e){return new r(this.firestore,e,this._path)}};function Ia(r,e,...t){if(r=At(r),arguments.length===1&&(e=No.newId()),eP("doc","path",e),r instanceof Wi){let n=me.fromString(e,...t);return qg(n),new je(r,null,new j(n))}{if(!(r instanceof je||r instanceof Qi))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(me.fromString(e,...t));return qg(n),new je(r.firestore,r instanceof Qi?r.converter:null,new j(n))}}var Gg="AsyncQueue",ua=class{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Xo(this,"async_queue_retry"),this.Su=()=>{let n=lu();n&&V(Gg,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;let t=lu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;let t=lu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new ot;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Bn(e))throw e;V(Gg,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){let t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;let i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(n);throw Ct("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);let i=xc.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&F()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(let t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){let t=this.fu.indexOf(e);this.fu.splice(t,1)}};function Kg(r){return function(t,n){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}var ar=class extends Wi{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new ua,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ua(e),this._firestoreClient=void 0,await e}}};function a_(r,e){let t=typeof r=="object"?r:tg(),n=typeof r=="string"?r:e||Fo,i=Xm(t,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=Vm("firestore");s&&rP(i,...s)}return i}function hh(r){if(r._terminated)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||nP(r),r._firestoreClient}function nP(r){var e,t,n;let i=r._freezeSettings(),s=function(l,u,h,f){return new _u(l,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,s_(f.experimentalLongPollingOptions),f.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new Lc(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(l){let u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(r._componentsProvider))}var Ji=class r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new r(ke.fromBase64String(e))}catch(t){throw new L(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new r(ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Fn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Yi=class{constructor(e){this._methodName=e}};var Xi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Q(this._lat,e._lat)||Q(this._long,e._long)}};var Zi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}};var iP=/^__.*__$/,Fc=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new Sr(e,this.data,t,this.fieldTransforms)}},ca=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ft(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function l_(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}var jc=class r{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new r(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Ku(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Uu(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return da(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(l_(this.Lu)&&iP.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}},Uc=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ba(e)}ju(e,t,n,i=!1){return new jc({Lu:e,methodName:t,zu:n,path:Ge.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function u_(r){let e=r._freezeSettings(),t=ba(r._databaseId);return new Uc(r._databaseId,!!e.ignoreUndefinedProperties,t)}function sP(r,e,t,n,i,s={}){let a=r.ju(s.merge||s.mergeFields?2:0,e,t,i);dh("Data must be an object, but it was:",a,n);let l=c_(n,a),u,h;if(s.merge)u=new Qe(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){let f=[];for(let m of s.mergeFields){let g=Bc(e,m,t);if(!a.contains(g))throw new L(D.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);d_(f,g)||f.push(g)}u=new Qe(f),h=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=a.fieldTransforms;return new Fc(new ze(l),u,h)}var ha=class r extends Yi{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof r}};function oP(r,e,t,n){let i=r.ju(1,e,t);dh("Data must be an object, but it was:",i,n);let s=[],a=ze.empty();lr(n,(u,h)=>{let f=fh(e,u,t);h=At(h);let m=i.Ku(f);if(h instanceof ha)s.push(f);else{let g=Aa(h,m);g!=null&&(s.push(f),a.set(f,g))}});let l=new Qe(s);return new ca(a,l,i.fieldTransforms)}function aP(r,e,t,n,i,s){let a=r.ju(1,e,t),l=[Bc(e,n,t)],u=[i];if(s.length%2!=0)throw new L(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Bc(e,s[g])),u.push(s[g+1]);let h=[],f=ze.empty();for(let g=l.length-1;g>=0;--g)if(!d_(h,l[g])){let E=l[g],P=u[g];P=At(P);let C=a.Ku(E);if(P instanceof ha)h.push(E);else{let R=Aa(P,C);R!=null&&(h.push(E),f.set(E,R))}}let m=new Qe(h);return new ca(f,m,a.fieldTransforms)}function Aa(r,e){if(h_(r=At(r)))return dh("Unsupported field value:",e,r),c_(r,e);if(r instanceof Yi)return function(n,i){if(!l_(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){let s=[],a=0;for(let l of n){let u=Aa(l,i.Uu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=At(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return $S(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=Te.fromDate(n);return{timestampValue:Ko(i.serializer,s)}}if(n instanceof Te){let s=new Te(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ko(i.serializer,s)}}if(n instanceof Xi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ji)return{bytesValue:Ny(i.serializer,n._byteString)};if(n instanceof je){let s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Wu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:eh(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Zi)return function(a,l){return{mapValue:{fields:{[Wc]:{stringValue:Qc},[xn]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw l.Wu("VectorValues must only contain numeric values.");return Zc(l.serializer,h)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${ch(n)}`)}(r,e)}function c_(r,e){let t={};return ay(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lr(r,(n,i)=>{let s=Aa(i,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function h_(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Te||r instanceof Xi||r instanceof Ji||r instanceof je||r instanceof Yi||r instanceof Zi)}function dh(r,e,t){if(!h_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let n=ch(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function Bc(r,e,t){if((e=At(e))instanceof Fn)return e._internalPath;if(typeof e=="string")return fh(r,e);throw da("Field path arguments must be of type string or ",r,!1,void 0,t)}var lP=new RegExp("[~\\*/\\[\\]]");function fh(r,e,t){if(e.search(lP)>=0)throw da(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Fn(...e.split("."))._internalPath}catch{throw da(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function da(r,e,t,n,i){let s=n&&!n.isEmpty(),a=i!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new L(D.INVALID_ARGUMENT,l+r+u)}function d_(r,e){return r.some(t=>t.isEqual(e))}var fa=class{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new $c(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(f_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},$c=class extends fa{data(){return super.data()}};function f_(r,e){return typeof e=="string"?fh(r,e):e instanceof Fn?e._internalPath:e._delegate._internalPath}function uP(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new L(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var qc=class{convertValue(e,t="none"){switch(ir(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ae(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw F()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return lr(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;let s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[xn].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>ae(a.doubleValue));return new Zi(s)}convertGeoPoint(e){return new Xi(ae(e.latitude),ae(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=ya(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Bi(e));default:return null}}convertTimestamp(e){let t=kt(e);return new Te(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=me.fromString(e);ee(Uy(n));let i=new jo(n.get(1),n.get(3)),s=new j(n.popFirst(5));return i.isEqual(t)||Ct(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function cP(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}var Tr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},pa=class extends fa{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Tn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(f_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},Tn=class extends pa{data(e={}){return super.data(e)}},zc=class{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Tr(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Tn(this._firestore,this._userDataWriter,n.key,n,new Tr(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{let u=new Tn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Tr(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{let u=new Tn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Tr(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),f=a.indexOf(l.doc.key)),{type:hP(l.type),doc:u,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function hP(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F()}}function ph(r){r=ct(r,je);let e=ct(r.firestore,ar);return ZR(hh(e),r._key).then(t=>__(e,r,t))}var ma=class extends qc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ji(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}};function p_(r,e,t){r=ct(r,je);let n=ct(r.firestore,ar),i=cP(r.converter,e,t);return y_(n,[sP(u_(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,nr.none())])}function m_(r,e,t,...n){r=ct(r,je);let i=ct(r.firestore,ar),s=u_(i),a;return a=typeof(e=At(e))=="string"||e instanceof Fn?aP(s,"updateDoc",r._key,e,t,n):oP(s,"updateDoc",r._key,e),y_(i,[a.toMutation(r._key,nr.exists(!0))])}function g_(r,...e){var t,n,i;r=At(r);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Kg(e[a])||(s=e[a],a++);let l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Kg(e[a])){let m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(n=m.error)===null||n===void 0?void 0:n.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let u,h,f;if(r instanceof je)h=ct(r.firestore,ar),f=_a(r._key.path),u={next:m=>{e[a]&&e[a](__(h,r,m))},error:e[a+1],complete:e[a+2]};else{let m=ct(r,la);h=ct(m.firestore,ar),f=m._query;let g=new ma(h);u={next:E=>{e[a]&&e[a](new zc(h,g,m,E))},error:e[a+1],complete:e[a+2]},uP(r._query)}return function(g,E,P,C){let R=new oa(C),N=new na(E,R,P);return g.asyncQueue.enqueueAndForget(async()=>Jy(await Mc(g),N)),()=>{R.su(),g.asyncQueue.enqueueAndForget(async()=>Yy(await Mc(g),N))}}(hh(h),f,l,u)}function y_(r,e){return function(n,i){let s=new ot;return n.asyncQueue.enqueueAndForget(async()=>qR(await XR(n),i,s)),s.promise}(hh(r),e)}function __(r,e,t){let n=t.docs.get(e._key),i=new ma(r);return new pa(r,i,e._key,n,new Tr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){jn=i})(eg),ki(new xt("firestore",(n,{instanceIdentifier:i,options:s})=>{let a=n.getProvider("app").getImmediate(),l=new ar(new du(n.getProvider("auth-internal")),new mu(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jo(h.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),rr(og,ag,e),rr(og,ag,"esm2017")})();var w_=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=(...t)=>Promise.resolve().then(()=>(ur(),Cr)).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};var rs=class extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}},xa=class extends rs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Sa=class extends rs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Ra=class extends rs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}},Pa;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Pa||(Pa={}));var gP=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},ns=class{constructor(e,{headers:t={},customFetch:n,region:i=Pa.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=w_(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return gP(this,void 0,void 0,function*(){try{let{headers:i,method:s,body:a}=t,l={},{region:u}=t;u||(u=this.region),u&&u!=="any"&&(l["x-region"]=u);let h;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob!="undefined"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(l["Content-Type"]="text/plain",h=a):typeof FormData!="undefined"&&a instanceof FormData?h=a:(l["Content-Type"]="application/json",h=JSON.stringify(a)));let f=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:h}).catch(P=>{throw new xa(P)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new Sa(f);if(!f.ok)throw new Ra(f);let g=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return g==="application/json"?E=yield f.json():g==="application/octet-stream"?E=yield f.blob():g==="text/event-stream"?E=f:g==="multipart/form-data"?E=yield f.formData():E=yield f.text(),{data:E,error:null}}catch(i){return{data:null,error:i}}})}};var D_=nf(k_(),1),{PostgrestClient:O_,PostgrestQueryBuilder:Oj,PostgrestFilterBuilder:Nj,PostgrestTransformBuilder:Vj,PostgrestBuilder:Lj,PostgrestError:RP}=D_.default;var N_="2.11.2";var V_={"X-Client-Info":`realtime-js/${N_}`},L_="1.0.0",Na=1e4,M_=1e3,kr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(kr||(kr={}));var Ue;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Ue||(Ue={}));var Ke;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Ke||(Ke={}));var Oa;(function(r){r.websocket="websocket"})(Oa||(Oa={}));var cr;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(cr||(cr={}));var cs=class{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){let t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){let i=t.getUint8(1),s=t.getUint8(2),a=this.HEADER_LENGTH+2,l=n.decode(e.slice(a,a+i));a=a+i;let u=n.decode(e.slice(a,a+s));a=a+s;let h=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:u,payload:h}}};var Dr=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var ne;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(ne||(ne={}));var Ph=(r,e,t={})=>{var n;let i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,a)=>(s[a]=PP(a,r,e,i),s),{})},PP=(r,e,t,n)=>{let i=e.find(l=>l.name===r),s=i==null?void 0:i.type,a=t[r];return s&&!n.includes(s)?F_(s,a):Rh(a)},F_=(r,e)=>{if(r.charAt(0)==="_"){let t=r.slice(1,r.length);return OP(e,t)}switch(r){case ne.bool:return CP(e);case ne.float4:case ne.float8:case ne.int2:case ne.int4:case ne.int8:case ne.numeric:case ne.oid:return kP(e);case ne.json:case ne.jsonb:return DP(e);case ne.timestamp:return NP(e);case ne.abstime:case ne.date:case ne.daterange:case ne.int4range:case ne.int8range:case ne.money:case ne.reltime:case ne.text:case ne.time:case ne.timestamptz:case ne.timetz:case ne.tsrange:case ne.tstzrange:return Rh(e);default:return Rh(e)}},Rh=r=>r,CP=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},kP=r=>{if(typeof r=="string"){let e=parseFloat(r);if(!Number.isNaN(e))return e}return r},DP=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},OP=(r,e)=>{if(typeof r!="string")return r;let t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let s,a=r.slice(1,t);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(l=>F_(e,l))}return r},NP=r=>typeof r=="string"?r.replace(" ","T"):r,Va=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};var Or=class{constructor(e,t,n={},i=Na){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}};var Ch;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Ch||(Ch={}));var Gn=class r{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{let{onJoin:s,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=r.syncState(this.state,i,s,a),this.pendingDiffs.forEach(u=>{this.state=r.syncDiff(this.state,u,s,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{let{onJoin:s,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=r.syncDiff(this.state,i,s,a),l())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){let s=this.cloneDeep(e),a=this.transformState(t),l={},u={};return this.map(s,(h,f)=>{a[h]||(u[h]=f)}),this.map(a,(h,f)=>{let m=s[h];if(m){let g=f.map(R=>R.presence_ref),E=m.map(R=>R.presence_ref),P=f.filter(R=>E.indexOf(R.presence_ref)<0),C=m.filter(R=>g.indexOf(R.presence_ref)<0);P.length>0&&(l[h]=P),C.length>0&&(u[h]=C)}else l[h]=f}),this.syncDiff(s,{joins:l,leaves:u},n,i)}static syncDiff(e,t,n,i){let{joins:s,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(l,u)=>{var h;let f=(h=e[l])!==null&&h!==void 0?h:[];if(e[l]=this.cloneDeep(u),f.length>0){let m=e[l].map(E=>E.presence_ref),g=f.filter(E=>m.indexOf(E.presence_ref)<0);e[l].unshift(...g)}n(l,f,u)}),this.map(a,(l,u)=>{let h=e[l];if(!h)return;let f=u.map(m=>m.presence_ref);h=h.filter(m=>f.indexOf(m.presence_ref)<0),e[l]=h,i(l,h,u),h.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{let i=e[n];return"metas"in i?t[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var kh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(kh||(kh={}));var Dh;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Dh||(Dh={}));var pt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(pt||(pt={}));var Kn=class r{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Ue.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Or(this,Ke.join,this.params,this.timeout),this.rejoinTimer=new Dr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ue.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ue.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ue.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ue.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ke.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Gn(this),this.broadcastEndpointURL=Va(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:s,presence:a,private:l}}=this.params;this._onError(f=>e==null?void 0:e(pt.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(pt.CLOSED));let u={},h={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){e==null||e(pt.SUBSCRIBED);return}else{let g=this.bindings.postgres_changes,E=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,P=[];for(let C=0;C<E;C++){let R=g[C],{filter:{event:N,schema:M,table:U,filter:G}}=R,Y=f&&f[C];if(Y&&Y.event===N&&Y.schema===M&&Y.table===U&&Y.filter===G)P.push(Object.assign(Object.assign({},R),{id:Y.id}));else{this.unsubscribe(),e==null||e(pt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,e&&e(pt.SUBSCRIBED);return}}).receive("error",f=>{e==null||e(pt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){let{event:s,payload:a}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{let h=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,l,u;let h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),h.receive("ok",()=>s("ok")),h.receive("error",()=>s("error")),h.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ue.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ke.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{let i=new Or(this,Ke.leave,{},e);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){let i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Or(this,e,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,s;let a=e.toLocaleLowerCase(),{close:l,error:u,leave:h,join:f}=Ke;if(n&&[l,u,h,f].indexOf(a)>=0&&n!==this._joinRef())return;let g=this._onMessage(a,t,n);if(t&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(E=>{var P,C,R;return((P=E.filter)===null||P===void 0?void 0:P.event)==="*"||((R=(C=E.filter)===null||C===void 0?void 0:C.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===a}).map(E=>E.callback(g,n)):(s=this.bindings[a])===null||s===void 0||s.filter(E=>{var P,C,R,N,M,U;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in E){let G=E.id,Y=(P=E.filter)===null||P===void 0?void 0:P.event;return G&&((C=t.ids)===null||C===void 0?void 0:C.includes(G))&&(Y==="*"||(Y==null?void 0:Y.toLocaleLowerCase())===((R=t.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{let G=(M=(N=E==null?void 0:E.filter)===null||N===void 0?void 0:N.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return G==="*"||G===((U=t==null?void 0:t.event)===null||U===void 0?void 0:U.toLocaleLowerCase())}else return E.type.toLocaleLowerCase()===a}).map(E=>{if(typeof g=="object"&&"ids"in g){let P=g.data,{schema:C,table:R,commit_timestamp:N,type:M,errors:U}=P;g=Object.assign(Object.assign({},{schema:C,table:R,commit_timestamp:N,eventType:M,new:{},old:{},errors:U}),this._getPayloadRecords(P))}E.callback(g,n)})}_isClosed(){return this.state===Ue.closed}_isJoined(){return this.state===Ue.joined}_isJoining(){return this.state===Ue.joining}_isLeaving(){return this.state===Ue.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){let i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){let n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&r.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ke.close,{},e)}_onError(e){this._on(Ke.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ue.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ph(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ph(e.columns,e.old_record)),t}};var LP=()=>{},MP=typeof WebSocket!="undefined",FP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,Hn=class{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=V_,this.params={},this.timeout=Na,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=LP,this.conn=null,this.sendBuffer=[],this.serializer=new cs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch=="undefined"?a=(...l)=>Promise.resolve().then(()=>(ur(),Cr)).then(({default:u})=>u(...l)):a=fetch,(...l)=>a(...l)},this.endPoint=`${e}/${Oa.websocket}`,this.httpEndpoint=Va(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,a)=>a(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Dr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(MP){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Oh(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Promise.resolve().then(()=>nf(U_())).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:L_}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t!=null?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case kr.connecting:return cr.Connecting;case kr.open:return cr.Open;case kr.closing:return cr.Closing;default:return cr.Closed}}isConnected(){return this.connectionState()===cr.Open}channel(e,t={config:{}}){let n=new Kn(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){let{topic:t,event:n,payload:i,ref:s}=e,a=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${t} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(Ke.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(M_,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:i,payload:s,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(l=>l._isMember(n)).forEach(l=>l._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ke.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;let n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{let n=new Blob([FP],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}},Oh=class{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=kr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}};var Wn=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function ge(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var La=class extends Wn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}},Nr=class extends Wn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};var jP=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},Fa=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=(...t)=>Promise.resolve().then(()=>(ur(),Cr)).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},B_=()=>jP(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield Promise.resolve().then(()=>(ur(),Cr))).Response:Response}),Ma=r=>{if(Array.isArray(r))return r.map(t=>Ma(t));if(typeof r=="function"||r!==Object(r))return r;let e={};return Object.entries(r).forEach(([t,n])=>{let i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ma(n)}),e};var Vr=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},Nh=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),UP=(r,e,t)=>Vr(void 0,void 0,void 0,function*(){let n=yield B_();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{e(new La(Nh(i),r.status||500))}).catch(i=>{e(new Nr(Nh(i),i))}):e(new Nr(Nh(r),r))}),BP=(r,e,t,n)=>{let i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function hs(r,e,t,n,i,s){return Vr(this,void 0,void 0,function*(){return new Promise((a,l)=>{r(t,BP(e,n,i,s)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>UP(u,l,n))})})}function Qn(r,e,t,n){return Vr(this,void 0,void 0,function*(){return hs(r,"GET",e,t,n)})}function mt(r,e,t,n,i){return Vr(this,void 0,void 0,function*(){return hs(r,"POST",e,n,i,t)})}function $_(r,e,t,n,i){return Vr(this,void 0,void 0,function*(){return hs(r,"PUT",e,n,i,t)})}function q_(r,e,t,n){return Vr(this,void 0,void 0,function*(){return hs(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function ja(r,e,t,n,i){return Vr(this,void 0,void 0,function*(){return hs(r,"DELETE",e,n,i,t)})}var Be=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},$P={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},z_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},ds=class{constructor(e,t={},n,i){this.url=e,this.headers=t,this.bucketId=n,this.fetch=Fa(i)}uploadOrUpdate(e,t,n,i){return Be(this,void 0,void 0,function*(){try{let s,a=Object.assign(Object.assign({},z_),i),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)}),u=a.metadata;typeof Blob!="undefined"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));let h=this._removeEmptyFolders(t),f=this._getFinalPath(h),m=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:e,body:s,headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{})),g=yield m.json();return m.ok?{data:{path:h,id:g.Id,fullPath:g.Key},error:null}:{data:null,error:g}}catch(s){if(ge(s))return{data:null,error:s};throw s}})}upload(e,t,n){return Be(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return Be(this,void 0,void 0,function*(){let s=this._removeEmptyFolders(e),a=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",t);try{let u,h=Object.assign({upsert:z_.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",h.cacheControl),u.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(u=n,u.append("cacheControl",h.cacheControl)):(u=n,f["cache-control"]=`max-age=${h.cacheControl}`,f["content-type"]=h.contentType);let m=yield this.fetch(l.toString(),{method:"PUT",body:u,headers:f}),g=yield m.json();return m.ok?{data:{path:s,fullPath:g.Key},error:null}:{data:null,error:g}}catch(u){if(ge(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,t){return Be(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");let s=yield mt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),l=a.searchParams.get("token");if(!l)throw new Wn("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}})}update(e,t,n){return Be(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Be(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}})}copy(e,t,n){return Be(this,void 0,void 0,function*(){try{return{data:{path:(yield mt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return Be(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield mt(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return Be(this,void 0,void 0,function*(){try{let i=yield mt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}})}download(e,t){return Be(this,void 0,void 0,function*(){let i=typeof(t==null?void 0:t.transform)!="undefined"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=s?`?${s}`:"";try{let l=this._getFinalPath(e);return{data:yield(yield Qn(this.fetch,`${this.url}/${i}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ge(l))return{data:null,error:l};throw l}})}info(e){return Be(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let n=yield Qn(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ma(n),error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}})}exists(e){return Be(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield q_(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ge(n)&&n instanceof Nr){let i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){let n=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);let l=typeof(t==null?void 0:t.transform)!="undefined"?"render/image":"object",u=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});u!==""&&i.push(u);let h=i.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${h}`)}}}remove(e){return Be(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}list(e,t,n){return Be(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},$P),t),{prefix:e||""});return{data:yield mt(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer!="undefined"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};var G_="2.7.1";var K_={"X-Client-Info":`storage-js/${G_}`};var Jn=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},fs=class{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},K_),t),this.fetch=Fa(n)}listBuckets(){return Jn(this,void 0,void 0,function*(){try{return{data:yield Qn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ge(e))return{data:null,error:e};throw e}})}getBucket(e){return Jn(this,void 0,void 0,function*(){try{return{data:yield Qn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Jn(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return Jn(this,void 0,void 0,function*(){try{return{data:yield $_(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Jn(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Jn(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}};var ps=class extends fs{constructor(e,t={},n){super(e,t,n)}from(e){return new ds(this.url,this.headers,e,this.fetch)}};var H_="2.48.1";var ms="";typeof Deno!="undefined"?ms="deno":typeof document!="undefined"?ms="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?ms="react-native":ms="node";var qP={"X-Client-Info":`supabase-js-${ms}/${H_}`},W_={headers:qP},Q_={schema:"public"},J_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Y_={};ur();var zP=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},GP=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=mh:e=fetch,(...t)=>e(...t)},KP=()=>typeof Headers=="undefined"?gh:Headers,X_=(r,e,t)=>{let n=GP(t),i=KP();return(s,a)=>zP(void 0,void 0,void 0,function*(){var l;let u=(l=yield e())!==null&&l!==void 0?l:r,h=new i(a==null?void 0:a.headers);return h.has("apikey")||h.set("apikey",r),h.has("Authorization")||h.set("Authorization",`Bearer ${u}`),n(s,Object.assign(Object.assign({},a),{headers:h}))})};var HP=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})};function Z_(r){return r.replace(/\/$/,"")}function ew(r,e){let{db:t,auth:n,realtime:i,global:s}=r,{db:a,auth:l,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},l),n),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign({},h),s),accessToken:()=>HP(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}var Ua="2.67.3";var tw="http://localhost:9999",rw="supabase.auth.token";var nw={"X-Client-Info":`gotrue-js/${Ua}`},Vh=10;var gs="X-Supabase-Api-Version",Lh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function iw(r){return Math.round(Date.now()/1e3)+r}function sw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var tt=()=>typeof window!="undefined"&&typeof document!="undefined",Lr={tested:!1,writable:!1},hr=()=>{if(!tt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Lr.tested)return Lr.writable;let r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Lr.tested=!0,Lr.writable=!0}catch{Lr.tested=!0,Lr.writable=!1}return Lr.writable};function ow(r){let e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}var Ba=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=(...t)=>Promise.resolve().then(()=>(ur(),Cr)).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},aw=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Mh=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},_s=async(r,e)=>{let t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ws=async(r,e)=>{await r.removeItem(e)};function WP(r){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="",n,i,s,a,l,u,h,f=0;for(r=r.replace("-","+").replace("_","/");f<r.length;)a=e.indexOf(r.charAt(f++)),l=e.indexOf(r.charAt(f++)),u=e.indexOf(r.charAt(f++)),h=e.indexOf(r.charAt(f++)),n=a<<2|l>>4,i=(l&15)<<4|u>>2,s=(u&3)<<6|h,t=t+String.fromCharCode(n),u!=64&&i!=0&&(t=t+String.fromCharCode(i)),h!=64&&s!=0&&(t=t+String.fromCharCode(s));return t}var ys=class r{constructor(){this.promise=new r.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}};ys.promiseConstructor=Promise;function Fh(r){let e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");let n=t[1];return JSON.parse(WP(n))}async function lw(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function uw(r,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{let a=await r(s);if(!e(s,null,a)){n(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function QP(r){return("0"+r.toString(16)).substr(-2)}function JP(){let e=new Uint32Array(56);if(typeof crypto=="undefined"){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length,i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,QP).join("")}async function YP(r){let t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}function XP(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ZP(r){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;let t=await YP(r);return XP(t)}async function Mr(r,e,t=!1){let n=JP(),i=n;t&&(i+="/PASSWORD_RECOVERY"),await Mh(r,`${e}-code-verifier`,i);let s=await ZP(n);return[s,n===s?"plain":"s256"]}var eC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function cw(r){let e=r.headers.get(gs);if(!e||!e.match(eC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}var vs=class extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}};function z(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}var $a=class extends vs{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}};function hw(r){return z(r)&&r.name==="AuthApiError"}var Yn=class extends vs{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},Vt=class extends vs{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}},Je=class extends Vt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function dw(r){return z(r)&&r.name==="AuthSessionMissingError"}var Xn=class extends Vt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Fr=class extends Vt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},jr=class extends Vt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function fw(r){return z(r)&&r.name==="AuthImplicitGrantRedirectError"}var bs=class extends Vt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Zn=class extends Vt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}};function qa(r){return z(r)&&r.name==="AuthRetryableFetchError"}var Ts=class extends Vt{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}};var tC=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Ur=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),rC=[502,503,504];async function pw(r){var e;if(!aw(r))throw new Zn(Ur(r),0);if(rC.includes(r.status))throw new Zn(Ur(r),r.status);let t;try{t=await r.json()}catch(s){throw new Yn(Ur(s),s)}let n,i=cw(r);if(i&&i.getTime()>=Lh["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Ts(Ur(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Je}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Ts(Ur(t),r.status,t.weak_password.reasons);throw new $a(Ur(t),r.status||500,n)}var nC=(r,e,t,n)=>{let i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function K(r,e,t,n){var i;let s=Object.assign({},n==null?void 0:n.headers);s[gs]||(s[gs]=Lh["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);let a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);let l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await iC(r,e,t+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function iC(r,e,t,n,i,s){let a=nC(e,n,i,s),l;try{l=await r(t,Object.assign({},a))}catch(u){throw console.error(u),new Zn(Ur(u),0)}if(l.ok||await pw(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(u){await pw(u)}}function Lt(r){var e;let t=null;sC(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=iw(r.expires_in)));let n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function jh(r){let e=Lt(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function gt(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function mw(r){return{data:r,error:null}}function gw(r){let{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s}=r,a=tC(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s},u=Object.assign({},a);return{data:{properties:l,user:u},error:null}}function yw(r){return r}function sC(r){return r.access_token&&r.refresh_token&&r.expires_in}var oC=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Br=class{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Ba(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await K(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(z(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await K(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:gt})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{let{options:t}=e,n=oC(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await K(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gw,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(z(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await K(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:gt})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,s,a,l,u;try{let h={nextPage:null,lastPage:0,total:0},f=await K(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:yw});if(f.error)throw f.error;let m=await f.json(),g=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,E=(u=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return E.length>0&&(E.forEach(P=>{let C=parseInt(P.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(P.split(";")[1].split("=")[1]);h[`${R}Page`]=C}),h.total=parseInt(g)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(z(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){try{return await K(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:gt})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await K(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:gt})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await K(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:gt})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{let{data:t,error:n}=await K(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(z(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await K(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}}};var _w={getItem:r=>hr()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{hr()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{hr()&&globalThis.localStorage.removeItem(r)}};function Uh(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function ww(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var $r={debug:!!(globalThis&&hr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},Es=class extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}},za=class extends Es{};async function Bh(r,e,t){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);let n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),$r.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw $r.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new za(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if($r.debug)try{let s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}ww();var aC={url:tw,storageKey:rw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Is=30*1e3,vw=3;async function bw(r,e,t){return await t()}var qr=class r{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=r.nextInstanceID,r.nextInstanceID+=1,this.instanceID>0&&tt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let i=Object.assign(Object.assign({},aC),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Br({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ba(i.fetch),this.lock=i.lock||bw,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:tt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Bh:this.lock=bw,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:hr()?this.storage=_w:(this.memoryStorage={},this.storage=Uh(this.memoryStorage)):(this.memoryStorage={},this.storage=Uh(this.memoryStorage)),tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ua}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t=ow(window.location.href),n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),tt()&&this.detectSessionInUrl&&n!=="none"){let{data:i,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),fw(s)){let u=(e=s.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}let{session:a,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return z(t)?{error:t}:{error:new Yn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{let s=await K(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Lt}),{data:a,error:l}=s;if(l||!a)return{data:{user:null,session:null},error:l};let u=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:h,session:u},error:null}}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,n,i;try{let s;if("email"in e){let{email:f,password:m,options:g}=e,E=null,P=null;this.flowType==="pkce"&&([E,P]=await Mr(this.storage,this.storageKey)),s=await K(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:f,password:m,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:E,code_challenge_method:P},xform:Lt})}else if("phone"in e){let{phone:f,password:m,options:g}=e;s=await K(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},channel:(i=g==null?void 0:g.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:Lt})}else throw new Fr("You must provide either an email or phone number and a password");let{data:a,error:l}=s;if(l||!a)return{data:{user:null,session:null},error:l};let u=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:h,session:u},error:null}}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){let{email:s,password:a,options:l}=e;t=await K(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jh})}else if("phone"in e){let{phone:s,password:a,options:l}=e;t=await K(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jh})}else throw new Fr("You must provide either an email or phone number and a password");let{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Xn}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await _s(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t!=null?t:"").split("/");try{let{data:s,error:a}=await K(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Lt});if(await ws(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Xn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i!=null?i:null}),error:a})}catch(s){if(z(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{let{options:t,provider:n,token:i,access_token:s,nonce:a}=e,l=await K(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Lt}),{data:u,error:h}=l;return h?{data:{user:null,session:null},error:h}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Xn}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:h})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,s,a;try{if("email"in e){let{email:l,options:u}=e,h=null,f=null;this.flowType==="pkce"&&([h,f]=await Mr(this.storage,this.storageKey));let{error:m}=await K(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=u==null?void 0:u.data)!==null&&t!==void 0?t:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:h,code_challenge_method:f},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){let{phone:l,options:u}=e,{data:h,error:f}=await K(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=u==null?void 0:u.data)!==null&&i!==void 0?i:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:f}}throw new Fr("You must provide either an email or phone number.")}catch(l){if(z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,n;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);let{data:a,error:l}=await K(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Lt});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let u=a.session,h=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:h,session:u},error:null}}catch(i){if(z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await Mr(this.storage,this.storageKey)),await K(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:mw})}catch(s){if(z(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Je;let{error:i}=await K(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:n,type:i,options:s}=e,{error:a}=await K(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:n,type:i,options:s}=e,{data:a,error:l}=await K(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new Fr("You must provide either an email or phone number and a type")}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){let i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,t=await _s(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let n=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,h,f)=>(!a&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,h,f))})}return{data:{session:e},error:null}}let{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await K(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:gt}):await this._useSession(async t=>{var n,i,s;let{data:a,error:l}=t;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Je}:await K(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:gt})})}catch(t){if(z(t))return dw(t)&&(await this._removeSession(),await ws(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{let{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Je;let a=i.session,l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await Mr(this.storage,this.storageKey));let{data:h,error:f}=await K(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:a.access_token,xform:gt});if(f)throw f;return a.user=h.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return Fh(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Je;let t=Date.now()/1e3,n=t,i=!0,s=null,a=Fh(e.access_token);if(a.exp&&(n=a.exp,i=n<=t),i){let{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};s=l}else{let{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(z(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){let{data:a,error:l}=t;if(l)throw l;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Je;let{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!tt())throw new jr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new jr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new bs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new bs("No code detected.");let{data:M,error:U}=await this._exchangeCodeForSession(e.code);if(U)throw U;let G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:M.session,redirectType:null},error:null}}let{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:l,expires_at:u,token_type:h}=e;if(!s||!l||!a||!h)throw new jr("No session defined in URL");let f=Math.round(Date.now()/1e3),m=parseInt(l),g=f+m;u&&(g=parseInt(u));let E=g-f;E*1e3<=Is&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${E}s, should have been closer to ${m}s`);let P=g-m;f-P>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",P,g,f):f-P<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",P,g,f);let{data:C,error:R}=await this._getUser(s);if(R)throw R;let N={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:m,expires_at:g,refresh_token:a,token_type:h,user:C.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:N,redirectType:e.type},error:null}}catch(n){if(z(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await _s(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;let{data:i,error:s}=t;if(s)return{error:s};let a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){let{error:l}=await this.admin.signOut(a,e);if(l&&!(hw(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await ws(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t=sw(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{let{data:{session:s},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Mr(this.storage,this.storageKey,!0));try{return await K(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(z(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{let{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{let{data:n,error:i}=await this._useSession(async s=>{var a,l,u,h,f;let{data:m,error:g}=s;if(g)throw g;let E=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await K(this.fetch,"GET",E,{headers:this.headers,jwt:(f=(h=m.session)===null||h===void 0?void 0:h.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return tt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(z(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;let{data:s,error:a}=t;if(a)throw a;return await K(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{let n=Date.now();return await uw(async i=>(i>0&&await lw(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await K(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Lt})),(i,s)=>{let a=200*Math.pow(2,i);return s&&qa(s)&&Date.now()+a-n<Is})}catch(n){if(this._debug(t,"error",n),z(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),tt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let n=await _s(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}let i=Math.round(Date.now()/1e3),s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)<i+Vh;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${Vh}s`),s){if(this.autoRefreshToken&&n.refresh_token){let{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),qa(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Je;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new ys;let{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new Je;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);let l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),z(s)){let a={session:null,error:s};return qa(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){let i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});let s=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(u){s.push(u)}});if(await Promise.all(a),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Mh(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ws(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),Is);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let i=Math.floor((n.expires_at*1e3-e)/Is);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Is}ms, refresh threshold is ${vw} ticks`),i<=vw&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Es)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){let i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){let[s,a]=await Mr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(l.toString())}if(n!=null&&n.queryParams){let s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;let{data:i,error:s}=t;return s?{data:null,error:s}:await K(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;let{data:s,error:a}=t;if(a)return{data:null,error:a};let l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:h}=await K(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&(!((i=u==null?void 0:u.totp)===null||i===void 0)&&i.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;let{data:i,error:s}=t;if(s)return{data:null,error:s};let{data:a,error:l}=await K(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(t){if(z(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;let{data:i,error:s}=t;return s?{data:null,error:s}:await K(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(z(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){let{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let n=(e==null?void 0:e.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;let{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let a=this._decodeJWT(i.access_token),l=null;a.aal&&(l=a.aal);let u=l;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");let f=a.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:f},error:null}}))}};qr.nextInstanceID=0;var lC=qr,$h=lC;var Ga=class extends $h{constructor(e){super(e)}};var uC=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(f){try{h(n.next(f))}catch(m){a(m)}}function u(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(l,u)}h((n=n.apply(r,e||[])).next())})},As=class{constructor(e,t,n){var i,s,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");let l=Z_(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;let u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:Q_,realtime:Y_,auth:Object.assign(Object.assign({},J_),{storageKey:u}),global:W_},f=ew(n!=null?n:{},h);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=X_(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new O_(`${l}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new ns(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ps(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return uC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:l,debug:u},h,f){let m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ga({url:this.authUrl,headers:Object.assign(Object.assign({},m),h),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:a,lock:l,debug:u,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Hn(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Tw=(r,e,t)=>new As(r,e,t);function cC(r,e){return Object.fromEntries(Object.entries(r).sort(e||void 0).map(([t,n])=>[t,n]))}function Ka(r,e){return Array.isArray(r)?r.map(t=>Ka(t,e)):typeof r=="object"?Object.fromEntries(Object.entries(cC(r,e)).map(([t,n])=>[t,Ka(n,e)])):r}var Ew={id:"~date",test:r=>r instanceof Date,serialize:r=>({_:"~date",v:r.toISOString()}),deserialize:r=>new Date(r.v)};var Iw={id:"~function",test:r=>typeof r=="function",serialize:r=>({_:"~function",v:r.toString()}),deserialize:v=>eval(v.v.toString())};var Aw={id:"~infinity",test:r=>r===1/0||r===-1/0,serialize:r=>({_:"~infinity",v:r===1/0?1:0}),deserialize:r=>r.v==1?1/0:-1/0};var xw={id:"~nan",test:r=>Number.isNaN(r),serialize:r=>({_:"~nan"}),deserialize:r=>NaN};var Sw={id:"~regexp",test:r=>r instanceof RegExp,serialize:r=>({_:"~regexp",v:r.source,f:r.flags}),deserialize:r=>new RegExp(r.v,r.f)};var Rw={id:"~set",test:r=>r instanceof Set,serialize:r=>({_:"~set",v:Array.from(r)}),deserialize:r=>new Set(r.v)};var Pw={id:"~undefined",test:r=>r===void 0,serialize:r=>({_:"~undefined"}),deserialize:r=>{}};var ei={settings:{stringify:!0,destringify:!0,clone:!1,depth:0,modules:[Ew,Iw,Aw,xw,Sw,Rw,Pw],circular:!0,symetric:!1},loadedModules:{},loadModules(r){return r.map(e=>{if(Z(e)){if(!e.id)throw new Error("Provided custom module does not expose an `id` property");return ei.loadedModules[e.id]=e}else throw new Error("Unknown module type")})},serialize(r,e){let t=wo(e,ei.settings),n=ei.loadModules(t.modules),i=t.symetric?Ka(r):t.clone?Zt(r):r,s=new Map,a=(l,u)=>{let h=Z(l);if(h&&t.circular){let g=s.get(l);if(g)return er(i,u,{_:"~circular",p:g.join(".")});s.set(l,u)}let f=n.find(g=>g.test(l)),m=(!t.depth||u.length<t.depth)&&h;if(f){let g=f.serialize(l);if(f.recursive&&m){let E=Pe(l);t.symetric&&E.sort(),er(i,u,g),E.forEach(P=>a(l[P],u.concat(P)))}else u.length?er(i,u,g):i=g}else if(m){let g=Pe(l);t.symetric&&g.sort(),g.forEach(E=>a(l[E],u.concat(E)))}};return a(i,[]),t.stringify?JSON.stringify(i):i},deserialize(r,e){let t=wo(e,ei.settings),n=ei.loadModules(t.modules),i=Ol(n,"id"),s=t.destringify?JSON.parse(r):t.clone?Zt(r):r,a=(l,u)=>{if(Z(l)&&l._&&typeof l._=="string"&&l._.startsWith("~")&&i[l._]){let h=i[l._].deserialize(l);u.length?i[l._].recursive&&Z(h)?(er(s,u,h),Pe(h).forEach(f=>a(l[f],[...u,f]))):er(s,u,h):s=h}else t.circular&&Z(l)&&l._&&l._=="~circular"?er(s,u,xi(s,l.p)):(!t.depth||u.length<t.depth)&&Z(l)&&Pe(l).forEach(h=>a(l[h],u.concat(h)))};return a(s,[]),s}},xs=ei;var Cw="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var qh=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r|=0));for(;r--;)e+=Cw[t[r]&63];return e};var ti={csv:{id:"csv",title:"Comma Seperated Values",titleShort:"CSV",ext:[".csv"],canRead:!1,canWrite:!1},endnoteXml:{id:"endnoteXml",title:"EndNoteXML",titleShort:"EndNoteXML",ext:[".xml"],canRead:!0,canWrite:!0},json:{id:"json",title:"JSON",titleShort:"JSON",ext:[".json"],canRead:!0,canWrite:!0},medline:{id:"medline",title:"MEDLINE / PubMed",titleShort:"MEDLINE",ext:[".nbib"],canRead:!0,canWrite:!0},ris:{id:"ris",title:"RIS",titleShort:"RIS",ext:[".ris",".txt",".cgi"],canRead:!0,canWrite:!0},tsv:{id:"tsv",title:"Tab Seperated Values",titleShort:"TSV",ext:[".tsv"],canRead:!1,canWrite:!1}};function ri(r){var t;let e=(t=/^.*(?<ext>\..+?)$/.exec(r))==null?void 0:t.groups.ext.toLowerCase();return e?Object.values(ti).find(n=>n.ext.includes(e)):null}var Kh={};Wr(Kh,{endnoteXml:()=>Qa,json:()=>Ha,medline:()=>Ja,ris:()=>Ya});var Ha={};Wr(Ha,{readStream:()=>hC,writeStream:()=>dC});function kw(r){return{all:r=r||new Map,on:function(e,t){var n=r.get(e);n?n.push(t):r.set(e,[t])},off:function(e,t){var n=r.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):r.set(e,[]))},emit:function(e,t){var n=r.get(e);n&&n.slice().map(function(i){i(t)}),(n=r.get("*"))&&n.slice().map(function(i){i(e,t)})}}}function Le(){let r=kw();return r.mitt={},["on","off","emit"].forEach(e=>{r.mitt[e]=r[e],r[e]=(...t)=>(r.mitt[e](...t),r)}),r}var Ss=class r{constructor(){this.text="",this.emitter=Le(),this.recNumber=1}write(e){this.text+=e}end(){try{let e=JSON.parse(this.text);this.text="",Array.isArray(e)&&e.forEach(t=>{this.emitter.emit("data",t)}),this.emitter.emit("end")}catch(e){console.error("Error parsing final JSON:",e),this.emitter.emit("error",e)}}on(e,t){this.emitter.on(e,t)}static parse(){return new r}};function hC(r){let e=1,t=Le();return setTimeout(()=>{if(r.on("data",()=>t.emit("progress",r.bytesRead)),typeof r.pipe=="function"){let n=Ss.parse("*");n.on("data",i=>t.emit("ref",{recNumber:e++,...i})),n.on("end",()=>t.emit("end")),n.on("error",t.emit.bind("error")),r.pipe(n)}else console.error('Error with stream, check "streamEmitter.js" if on browser')}),t}function dC(r,e){let t={lineSuffix:`
`,...e},n;return{start:()=>(r.write(`[
`),Promise.resolve()),write:i=>(n&&r.write(n+","+t.lineSuffix),n=JSON.stringify(i),Promise.resolve()),end:()=>(n&&r.write(n+t.lineSuffix),r.write("]"),new Promise((i,s)=>r.end(a=>a?s(a):i())))}}var Qa={};Wr(Qa,{readStream:()=>fC,setup:()=>mC,translateRawToRef:()=>Ow,translations:()=>dr,writeStream:()=>pC,xmlEscape:()=>Me,xmlUnescape:()=>Mt});function Dw(r){return r.split(/[\s-]/).map((e,t)=>t==0?e.toLowerCase():e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase()).join("")}var Rs=(...r)=>{},Ps=class{constructor(e){oe(this,"settings",{collect:!0,keyText:"text",keyAttrs:"attrs",keyChildren:"children",ignoreOrphanedPrefixes:!0,flattenText:!0,flattenChildren:!0,flattenChildrenSquish:!0,flattenAttrs:!0,reNextSegment:/(?<text>.*?)<(?<isClose>\/?)(?<tag>[a-z0-9-\.\_]+?)(?:\s+(?<attrs>.*?))?>/ig,reAttrSegment:/(?<key>[a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?<escape>["'])(?<val>.*?)\k<escape>)?/ig,onRoot:e=>Rs("> ROOT",e.tag),onAttr:(e,t,n)=>({[e]:isFinite(t)?+t:t==="true"||t===void 0?!0:t==="false"?!1:t}),onTagOpen:e=>Rs("> TAG OPEN",e.tag),onTagClose:e=>Rs("> TAG CLOSE",e.tag),onTagCloseMismatch:(e,t)=>Rs("TAG CLOSE",e,"(but expected",t,")")});oe(this,"buffer","");oe(this,"collected");oe(this,"stack",[]);e&&Object.assign(this.settings,e)}append(e){if(!e)throw new Error("No input to append");return this.buffer+=e.toString(),this}exec(){let e,t;for(;e=this.settings.reNextSegment.exec(this.buffer);){if(t=e.index+e[0].length,e.groups.text&&!(this.stack.length==0&&this.settings.ignoreOrphanedPrefixes)){if(this.stack.length==0)throw new Error("Attempt to set value on empty stack!");this.stack.at(-1)[this.settings.keyText]=(this.stack.at(-1)[this.settings.keyText]||"")+e.groups.text}let n=e.groups.attrs?this.parseAttrString(e.groups.attrs):null;if(e.groups.isClose==""){let i={tag:e.groups.tag,...n!==null&&{[this.settings.keyAttrs]:n}};this.stack.length==0?(this.settings.onRoot(i),this.settings.collect&&(this.collected=i)):this.stack.at(-1)[this.settings.keyChildren]?this.stack.at(-1)[this.settings.keyChildren].push(i):this.stack.at(-1)[this.settings.keyChildren]=[i],this.settings.onTagOpen(i),this.stack.push(i)}else if(e.groups.isClose=="/"){if(this.stack.length==0)throw new Error("Smashed stack!");this.settings.onTagClose(this.stack.at(-1)),this.stack.pop()}else Rs("OUT OF BAND",{match:e})}return t>0&&(this.buffer=this.buffer.slice(t)),this}parseAttrString(e){let t,n={};for(;t=this.settings.reAttrSegment.exec(e);)n={...n,...this.settings.onAttr(t.groups.key,t.groups.val,t.groups)};return n}flatten(e){let t=n=>{if(Array.isArray(n))return n.map(i=>t(i));if(typeof n=="object"&&n.tag){if(this.settings.flattenText&&n[this.settings.keyText]&&!n[this.settings.keyChildren]&&!n[this.settings.keyAttrs])return{[n.tag]:n[this.settings.keyText]};if(this.settings.flattenChildren&&n[this.settings.keyChildren]&&!n[this.settings.keyText]&&!n[this.settings.keyAttrs]){let i=t(n[this.settings.keyChildren]);return this.settings.flattenChildrenSquish&&i.length==1&&(i=i[0]),{[n.tag]:i}}else return this.settings.flattenAttrs&&n[this.settings.keyAttrs]&&!n[this.settings.keyChildren]&&!n[this.settings.keyText]?{[n.tag]:n[this.settings.keyAttrs]}:{[n.tag]:{...n[this.settings.keyText]&&{[this.settings.keyText]:n[this.settings.keyText]},...n[this.settings.keyAttrs]&&{[this.settings.keyAttrs]:n[this.settings.keyAttrs]},...n[this.settings.keyChildren]&&{[this.settings.keyChildren]:n[this.settings.keyChildren]}}}}};return e?t(e):(this.collected=t(this.collected),this)}value(){if(!this.settings.collect)throw new Error("Collect mode disabled, enable this if you want the final parsed output object");return this.settings.flatten&&this.flatten(),this.collected}};var Wa=class{constructor(e){this.emitter=Le(),this.parser=new Ps({collect:!1,reAttrSegment:/(?<key>[a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?<escape>["'])(?<val>.*?)\k<escape>)?/ig,onTagOpen:t=>{let n=t.tag,i=t.attrs||{};this.emitter.emit("opentag",n,i)},onTagClose:t=>{let n=t.tag;t.text&&t.text.trim()&&this.emitter.emit("text",t.text.trim()),this.emitter.emit("closetag",n)},flattenText:!1,keyText:"text",keyAttrs:"attrs"}),this.emitter.on("opentag",e.onopentag),this.emitter.on("closetag",e.onclosetag),this.emitter.on("text",e.ontext),this.emitter.on("end",e.onend)}write(e){this.parser.append(e).exec()}end(){this.parser.exec();let e=this.parser.stack.at(-1);e&&e.text&&e.text.trim()&&this.emitter.emit("text",e.text.trim()),this.emitter.emit("end")}};function fC(r){let e=Le(),t={},n=[],i=!1,s={xmlMode:!0,decodeEntities:!1,onopentag(a,l){i=!1,n.push({name:Dw(a),attrs:l})},onclosetag(a){a=="record"?(t.title&&(t.title=t.title.replace(/^.*<style.*>(.*)<\/style>.*$/m,"$1").replace(/^\s+/,"").replace(/\s+$/,"")),e.emit("ref",Ow(t)),n=[],t={}):n.pop()},ontext(a){var h,f;let l=(h=n[n.length-1])==null?void 0:h.name,u=(f=n[n.length-2])==null?void 0:f.name;l=="title"?i?t.title+=a:t.title=a:l=="style"&&u=="author"?(t.authors||(t.authors=[]),i?t.authors[t.authors.length-1]+=Mt(a):t.authors.push(Mt(a))):l=="style"&&u=="keyword"?(t.keywords||(t.keywords=[]),i?t.keywords[t.keywords.length-1]+=Mt(a):t.keywords.push(Mt(a))):l=="style"?i||t[u]?t[u]+=Mt(a):t[u]=Mt(a):["recNumber","refType"].includes(l)&&(i||t[l]?t[l]+=Mt(a):t[l]=Mt(a)),i=!0},onend(){e.emit("end")}};return setTimeout(()=>{if(typeof r.pipe=="function"){let a=new Wa(s);r.on("data",()=>e.emit("progress",r.bytesRead)),r.pipe(a);return}else console.error('Error with stream, check "streamEmitter.js" if on browser')}),e}function pC(r,e){let t={defaultType:"journalArticle",filePath:"c:\\",fileName:"EndNote.enl",formatDate:s=>s instanceof Date?s.toISOString().substr(0,10):s,...e},n=Me(t.fileName),i=0;return{start:()=>(r.write('<?xml version="1.0" encoding="UTF-8" ?><xml><records>'),Promise.resolve()),write:s=>{let a=dr.types.rlMap.get(s.type||t.defaultType);a||(console.warn(`Invalid reference type: "${s.type}", defaulting to journal article`),a=dr.types.rlMap.get("journalArticle")),i++;let l=s.recNumber||i;return r.write(`<record><database name="${t.fileName}" path="${t.filePath}${t.fileName}">${n}</database><source-app name="EndNote" version="16.0">EndNote</source-app><rec-number>${l}</rec-number><foreign-keys><key app="EN" db-id="s55prpsswfsepue0xz25pxai2p909xtzszzv">${l}</key></foreign-keys><ref-type name="${a.rawText}">${a.rawId}</ref-type><contributors><authors>`+(s.authors||[]).map(u=>`<author><style face="normal" font="default" size="100%">${Me(u)}</style></author>`)+"</authors></contributors><titles>"+(s.title?`<title><style face="normal" font="default" size="100%">${Me(s.title)}</style></title>`:"")+(s.journal?`<secondary-title><style face="normal" font="default" size="100%">${Me(s.journal)}</style></secondary-title>`:"")+(s.titleShort?`<short-title><style face="normal" font="default" size="100%">${Me(s.titleShort)}</style></short-title>`:"")+(s.journalAlt?`<alt-title><style face="normal" font="default" size="100%">${Me(s.journalAlt)}</style></alt-title>`:"")+"</titles>"+(s.periodical?`<periodical><full-title><style face="normal" font="default" size="100%">${Me(s.periodical)}</style></full-title></periodical>`:"")+[["abstract","abstract"],["accessDate","access-date"],["accession","accession-num"],["address","auth-address"],["caption","caption"],["databaseProvider","remote-database-provider"],["database","remote-database-name"],["doi","electronic-resource-num"],["isbn","isbn"],["accessionNum","accession-num"],["label","label"],["language","language"],["notes","notes"],["number","number"],["pages","pages"],["researchNotes","research-notes"],["section","section"],["volume","volume"],["workType","work-type"],["custom1","custom1"],["custom2","custom2"],["custom3","custom3"],["custom4","custom4"],["custom5","custom5"],["custom6","custom6"],["custom7","custom7"]].filter(([u])=>s[u]).map(([u,h])=>`<${h}><style face="normal" font="default" size="100%">${Me(s[u])}</style></${h}>`).join("")+(s.date&&s.year&&s.date instanceof Date?`<dates><year><style face="normal" font="default" size="100%">${Me(s.year)}</style></year><pub-dates><date><style face="normal" font="default" size="100%">${t.formatDate(s.date)}</style></date></pub-dates></dates>`:s.date&&s.year?`<dates><year><style face="normal" font="default" size="100%">${Me(s.year)}</style></year><pub-dates><date><style face="normal" font="default" size="100%">${s.date}</style></date></pub-dates></dates>`:s.date?`<dates><pub-dates><date><style face="normal" font="default" size="100%">${Me(s.date)}</style></date></pub-dates></dates>`:s.year?`<dates><year><style face="normal" font="default" size="100%">${Me(s.year)}</style></year></dates>`:"")+(s.urls?"<urls><related-urls>"+(s.urls||[]).map(u=>`<url><style face="normal" font="default" size="100%">${Me(u)}</style></url>`).join("")+"</related-urls></urls>":"")+(s.keywords?"<keywords>"+(s.keywords||[]).map(u=>`<keyword><style face="normal" font="default" size="100%">${Me(u)}</style></keyword>`).join("")+"</keywords>":"")+"</record>"),Promise.resolve()},end:()=>(r.write("</records></xml>"),new Promise((s,a)=>r.end(l=>l?a(l):s())))}}function Ow(r){var t;return{...Object.fromEntries(dr.fields.collection.filter(n=>r[n.raw]).map(n=>[n.rl,r[n.raw]])),type:(t=dr.types.rawMap.get(+r.refType||17))==null?void 0:t.rl}}function Me(r){return(""+r).replace(/&/g,"&amp;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Mt(r){return(""+r).replace(/&amp;/g,"&").replace(/&#xD;/g,"\r").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'")}var dr={fields:{collection:[{rl:"recNumber",raw:"recNumber"},{rl:"title",raw:"title"},{rl:"journal",raw:"secondaryTitle"},{rl:"address",raw:"authAddress"},{rl:"researchNotes",raw:"researchNotes"},{rl:"type",raw:"FIXME"},{rl:"authors",raw:"authors"},{rl:"pages",raw:"pages"},{rl:"volume",raw:"volume"},{rl:"number",raw:"number"},{rl:"isbn",raw:"isbn"},{rl:"accessionNum",raw:"accessionNum"},{rl:"abstract",raw:"abstract"},{rl:"label",raw:"label"},{rl:"caption",raw:"caption"},{rl:"notes",raw:"notes"},{rl:"custom1",raw:"custom1"},{rl:"custom2",raw:"custom2"},{rl:"custom3",raw:"custom3"},{rl:"custom4",raw:"custom4"},{rl:"custom5",raw:"custom5"},{rl:"custom6",raw:"custom6"},{rl:"custom7",raw:"custom7"},{rl:"doi",raw:"electronicResourceNum"},{rl:"year",raw:"year"},{rl:"date",raw:"date"},{rl:"keywords",raw:"keywords"},{rl:"urls",raw:"urls"}]},types:{collection:[{rl:"aggregatedDatabase",rawText:"Aggregated Database",rawId:55},{rl:"ancientText",rawText:"Ancient Text",rawId:51},{rl:"artwork",rawText:"Artwork",rawId:2},{rl:"audioVisualMaterial",rawText:"Audiovisual Material",rawId:3},{rl:"bill",rawText:"Bill",rawId:4},{rl:"blog",rawText:"Blog",rawId:56},{rl:"book",rawText:"Book",rawId:6},{rl:"bookSection",rawText:"Book Section",rawId:5},{rl:"case",rawText:"Case",rawId:7},{rl:"catalog",rawText:"Catalog",rawId:8},{rl:"chartOrTable",rawText:"Chart or Table",rawId:38},{rl:"classicalWork",rawText:"Classical Work",rawId:49},{rl:"computerProgram",rawText:"Computer Program",rawId:9},{rl:"conferencePaper",rawText:"Conference Paper",rawId:47},{rl:"conferenceProceedings",rawText:"Conference Proceedings",rawId:10},{rl:"dataset",rawText:"Dataset",rawId:59},{rl:"dictionary",rawText:"Dictionary",rawId:52},{rl:"editedBook",rawText:"Edited Book",rawId:28},{rl:"electronicArticle",rawText:"Electronic Article",rawId:43},{rl:"electronicBook",rawText:"Electronic Book",rawId:44},{rl:"electronicBookSection",rawText:"Electronic Book Section",rawId:60},{rl:"encyclopedia",rawText:"Encyclopedia",rawId:53},{rl:"equation",rawText:"Equation",rawId:39},{rl:"figure",rawText:"Figure",rawId:37},{rl:"filmOrBroadcast",rawText:"Film or Broadcast",rawId:21},{rl:"generic",rawText:"Generic",rawId:13},{rl:"governmentDocument",rawText:"Government Document",rawId:46},{rl:"grant",rawText:"Grant",rawId:54},{rl:"hearing",rawText:"Hearing",rawId:14},{rl:"journalArticle",rawText:"Journal Article",rawId:17},{rl:"legalRuleOrRegulation",rawText:"Legal Rule or Regulation",rawId:50},{rl:"magazineArticle",rawText:"Magazine Article",rawId:19},{rl:"manuscript",rawText:"Manuscript",rawId:36},{rl:"map",rawText:"Map",rawId:20},{rl:"music",rawText:"Music",rawId:61},{rl:"newspaperArticle",rawText:"Newspaper Article",rawId:23},{rl:"onlineDatabase",rawText:"Online Database",rawId:45},{rl:"onlineMultimedia",rawText:"Online Multimedia",rawId:48},{rl:"pamphlet",rawText:"Pamphlet",rawId:24},{rl:"patent",rawText:"Patent",rawId:25},{rl:"personalCommunication",rawText:"Personal Communication",rawId:26},{rl:"report",rawText:"Report",rawId:27},{rl:"serial",rawText:"Serial",rawId:57},{rl:"standard",rawText:"Standard",rawId:58},{rl:"statute",rawText:"Statute",rawId:31},{rl:"thesis",rawText:"Thesis",rawId:32},{rl:"unpublished",rawText:"Unpublished Work",rawId:34},{rl:"web",rawText:"Web Page",rawId:12}],rlMap:new Map,rawMap:new Map}};function mC(){dr.types.collection.forEach(r=>{dr.types.rlMap.set(r.rl,r),dr.types.rawMap.set(r.rawId,r)})}var Ja={};Wr(Ja,{parseRef:()=>zh,readStream:()=>gC,setup:()=>_C,translations:()=>$e,writeStream:()=>yC});function gC(r,e){let t={defaultType:"journalArticle",delimeter:"\r",reformatAuthors:!0,journal:"long",parseAddress:!0,parseDoi:!0,parseYear:!0,fieldsReplace:[],...e};t.fieldsReplace.push({from:"type",to:"type",delete:!1,reformat:s=>$e.types.rawMap[s]||t.defaultType}),t.fieldsReplace.push({to:"authors",reformat:(s,a)=>(a.medlineAuthorsShort||a.medlineAuthorsFull||[]).map(l=>l.replace(/^(?<last>[\w-]+?) (?<initials>\w+)$/,(u,h,f)=>h&&f?h+", "+f.split("").map(m=>`${m}.`).join(" "):h||u))}),t.fieldsReplace.push({to:"journal",reformat:t.journal.long?(s,a)=>a.medlineJournalFull||a.medlineJournalShort:(s,a)=>a.medlineJournalShort||a.medlineJournalLong}),t.parseAddress&&t.fieldsReplace.push({from:"medlineAuthorsAffiliation",to:"address",delete:!1,reformat:s=>s?s.join(t.delimeter):!1}),t.parseDoi&&t.fieldsReplace.push({from:"medlineArticleID",to:"doi",delete:!1,reformat:s=>{var a;return((a=/(?<doi>[\w\.\/_]+) \[doi\]/.exec(s))==null?void 0:a.groups.doi)||!1}}),t.parseYear&&t.fieldsReplace.push({from:"date",to:"year",delete:!1,reformat:s=>{var a;return((a=/(?<year>\d{4}\b)/.exec(s))==null?void 0:a.groups.year)||!1}});let n=Le(),i="";return setTimeout(()=>{r.on("data",s=>{n.emit("progress",r.bytesRead),i+=s.toString();let a=0,l=/(\r\n|\n){2,}/g,u;for(;u=l.exec(i);){let h=zh(i.substring(a,u.index),t);n.emit("ref",h),a=u.index+u[0].length}i=i.substring(a)}).on("error",s=>n.emit("error",s)).on("end",()=>{i.replace(/\s+/,"")&&n.emit("ref",zh(i,t)),n.emit("end")})}),n}function yC(r,e){let t={defaultType:"journalArticle",delimeter:"\r",...e};return{start(){return Promise.resolve()},write:n=>{let i={type:t.defaultType,title:"<NO TITLE>",...n};return r.write($e.fields.collectionOutput.filter(s=>i[s.rl]).flatMap(s=>s.rl=="type"?"TY  - "+($e.types.rlMap.get(i.type)||$e.types.rlMap.get(t.defaultType)).raw:s.rl=="title"?["TI  - "+i.title,...(i.authors||[]).flatMap((a,l)=>{var u,h,f,m;return[(u=i.medlineAuthorsFull)!=null&&u[l]?`FAU - ${i.medlineAuthorsFull[l]}`:`FAU - ${i.authors[l]}`,((h=i.medlineAuthorsShort)==null?void 0:h[l])&&`AU  - ${i.medlineAuthorsShort[l]}`,((f=i.medlineAuthorsAffiliation)==null?void 0:f[l])&&`AD  - ${i.medlineAuthorsAffiliation[l]}`,((m=i.medlineAuthorsId)==null?void 0:m[l])&&`AUID- ${i.medlineAuthorsId[l]}`].filter(Boolean)})]:s.outputSkip?[]:s.outputRepeat&&Array.isArray(i[s.rl])?i[s.rl].map(a=>s.raw.padEnd(4," ")+"- "+a):Array.isArray(i[s.rl])?s.raw.padEnd(4," ")+"- "+i[s.rl].join(t.delimeter):s.raw.padEnd(4," ")+"- "+i[s.rl]).concat([`
`]).join(`
`)),Promise.resolve()},end(){return new Promise((n,i)=>r.end(s=>s?i(s):n()))}}}function zh(r,e){var i;let t={},n;return r.split(/[\r\n|\n]/).forEach(s=>{var u;let a=(u=/^\s*(?<key>[A-Z]+?)\s*-\s+(?<value>.*)$/s.exec(s))==null?void 0:u.groups;if(!a){s=s.trimStart(),s.replace(/\s+/,"")&&n&&(n.inputArray?t[n.rl].push(s):t[n.rl]+=" "+s);return}let l=$e.fields.rawMap.get(a.key);if(n!=null&&n.trimDotSuffix&&(t[n.rl]=t[n.rl].replace(/\.$/,"")),l)l.inputArray?(t[l.rl]?t[l.rl].push(a.value):t[l.rl]=[a.value],n=l):(t[l.rl]=a.value,n=l);else{n=null;return}}),((i=e.fieldsReplace)==null?void 0:i.length)>0&&e.fieldsReplace.forEach(s=>{var l;let a=s.from?t[s.from]:null;s.reformat&&(a=s.reformat(a,t),a===!1)||(t[s.to]=a,s.from&&((l=s.delete)==null||l)&&delete t[s.from])}),t}var $e={fields:{collection:[{rl:"medlinePMID",raw:"PMID",sort:0},{rl:"medlineOwner",raw:"OWN",sort:1},{rl:"medlineStatus",raw:"STAT",sort:2},{rl:"medlineDateRevised",raw:"DR",sort:3},{rl:"medlineISSN",raw:"IS",outputRepeat:!0,inputArray:!0,sort:4},{rl:"date",raw:"DP",sort:5},{rl:"title",raw:"TI",sort:6,trimDotSuffix:!0},{rl:"doi",raw:"LID",sort:7},{rl:"abstract",raw:"AB",sort:8},{rl:"medlineCopyright",raw:"CI",sort:7},{rl:"medlineAuthorsFull",raw:"FAU",sort:10,outputSkip:!0,inputArray:!0},{rl:"medlineAuthorsShort",raw:"AU",sort:10,outputSkip:!0,inputArray:!0},{rl:"medlineAuthorsAffiliation",raw:"AD",sort:10,outputSkip:!0,inputArray:!0},{rl:"medlineAuthorsId",raw:"AUID",sort:10,outputSkip:!0,inputArray:!0},{rl:"language",raw:"LA",sort:11},{rl:"medlineGrantNumber",raw:"GR",sort:12},{rl:"type",raw:"PT",sort:14},{rl:"medlineTypeSecondary",raw:"PTX"},{rl:"medlineDateElectronicPublication",raw:"DEP",sort:15},{rl:"address",raw:"PL",sort:16},{rl:"medlineJournalShort",raw:"TA",sort:17},{rl:"medlineJournalFull",raw:"JT",sort:18},{rl:"medlineNLMID",raw:"JID",sort:19},{rl:"medlineSubset",raw:"SB",sort:20},{rl:"medlineOwnerOtherTerm",raw:"OTO",sort:21},{rl:"keywords",raw:"OT",outputRepeat:!0,inputArray:!0,sort:22},{rl:"medlineEntrezDate",raw:"EDAT",sort:23},{rl:"medlineDateMesh",raw:"MHDA",sort:24},{rl:"medlinePublicationHistoryStatus",raw:"PHST",outputRepeat:!0,inputArray:!0,sort:25},{rl:"medlineArticleID",raw:"AID",sort:26},{rl:"medlineStatusPublication",raw:"PST",sort:27},{rl:"medlineSource",raw:"SO",sort:27},{rl:"notes",raw:"GN",inputArray:!0,outputRepeat:!0,sort:28},{rl:"isbn",raw:"ISBN"},{rl:"volume",raw:"VI"},{rl:"medlineVolumeTitle",raw:"VTI"},{rl:"pages",raw:"PG"},{rl:"medlineInvestigatorAffiliation",raw:"IRAD"},{rl:"medlineInvestigatorName",raw:"IR"},{rl:"medlineInvestigatorNameFull",raw:"FIR"},{rl:"medlineTitleBook",raw:"BTI"},{rl:"medlineTitleCollection",raw:"CTI"},{rl:"medlineConflictOfInterestStatement",raw:"COIS"},{rl:"medlineCorporateAuthor",raw:"CN"},{rl:"medlineDateCreate",raw:"CRDT"},{rl:"medlineDateCreated",raw:"DA"},{rl:"medlineDateCompleted",raw:"DCOM"},{rl:"medlineEdition",raw:"EN"},{rl:"medlineEditor",raw:"ED"},{rl:"medlineEditorFull",raw:"FED"},{rl:"medlineGeneSymbol",raw:"GS"},{rl:"medlineISSN",raw:"IS"},{rl:"number",raw:"IP"},{rl:"medlineManuscriptID",raw:"MID"},{rl:"medlineMeshTerms",raw:"MH",outputRepeat:!0,inputArray:!0},{rl:"medlineReferenceCount",raw:"RF"},{rl:"medlineAbstractOther",raw:"OAB"},{rl:"medlineCopyrightOther",raw:"OCI"},{rl:"medlineIDOther",raw:"OID"},{rl:"medlinePersonalName",raw:"PS"},{rl:"medlinePersonalNameFull",raw:"FPS"},{rl:"medlinePublishingModel",raw:"PUBM"},{rl:"medlinePubMedCentralID",raw:"PMC"},{rl:"medlinePubMedCentralRelease",raw:"PMCR"},{rl:"medlineRegistryNumber",raw:"RN"},{rl:"medlineSubstanceName",raw:"NM"},{rl:"medlineSecondarySource",raw:"SI"},{rl:"medlineSpaceFlightMission",raw:"SFM"},{rl:"medlineSubset",raw:"SB"},{rl:"medlineTitleTransliterated",raw:"TT",sort:6}],collectionOutput:[],rawMap:new Map,rlMap:new Map},types:{collection:[{raw:"Blog",rl:"blog"},{raw:"Case Reports",rl:"case"},{raw:"Catalog",rl:"catalog"},{raw:"Chart",rl:"chartOrTable"},{raw:"Database",rl:"aggregatedDatabase"},{raw:"Dataset",rl:"dataset"},{raw:"Dictionary",rl:"dictionary"},{raw:"Encyclopedia",rl:"encyclopedia"},{raw:"Journal Article",rl:"journalArticle"},{raw:"Legal Case",rl:"legalRuleOrRegulation"},{raw:"Manuscript",rl:"manuscript"},{raw:"Map",rl:"map"},{raw:"Newspaper Article",rl:"newspaperArticle"},{raw:"Patent",rl:"patent"},{raw:"Preprint",rl:"unpublished"},{raw:"Tables",rl:"chartOrTable"},{raw:"Technical Report",rl:"report"},{raw:"unknown",rl:"unknown"},{raw:"Unpublished Work",rl:"unpublished"},{raw:"Video-Audio Media",rl:"audioVisualMaterial"},{raw:"Web Archive",rl:"web"},{raw:"Address",rl:"personalCommunication"},{raw:"Advertisement",rl:"audioVisualMaterial"},{raw:"Almanac",rl:"book"},{raw:"Anecdotes",rl:"blog"},{raw:"Animation",rl:"filmOrBroadcast"},{raw:"Annual Report",rl:"report"},{raw:"Aphorisms and Proverbs",rl:"pamphlet"},{raw:"Architectural Drawing",rl:"figure"},{raw:"Autobiography",rl:"book"},{raw:"Bibliography",rl:"catalog"},{raw:"Biobibliography",rl:"book"},{raw:"Biography",rl:"book"},{raw:"Book Illustrations",rl:"audioVisualMaterial"},{raw:"Book Review",rl:"magazineArticle"},{raw:"Caricature",rl:"artwork"},{raw:"Cartoon",rl:"audioVisualMaterial"},{raw:"Catalog, Bookseller",rl:"catalog"},{raw:"Catalog, Commercial",rl:"catalog"},{raw:"Catalog, Drug",rl:"catalog"},{raw:"Catalog, Publisher",rl:"catalog"},{raw:"Catalog, Union",rl:"catalog"},{raw:"Chronology",rl:"book"},{raw:"Classical Article",rl:"classicalWork"},{raw:"Clinical Conference",rl:"conferenceProceedings"},{raw:"Clinical Study",rl:"dataset"},{raw:"Clinical Trial, Phase III",rl:"dataset"},{raw:"Clinical Trial, Phase II",rl:"dataset"},{raw:"Clinical Trial, Phase I",rl:"dataset"},{raw:"Clinical Trial, Phase IV",rl:"dataset"},{raw:"Clinical Trial Protocol",rl:"dataset"},{raw:"Clinical Trial",rl:"dataset"},{raw:"Clinical Trial, Veterinary",rl:"dataset"},{raw:"Consensus Development Conference, NIH",rl:"conferenceProceedings"},{raw:"Consensus Development Conference",rl:"conferenceProceedings"},{raw:"Corrected and Republished Article",rl:"journalArticle"},{raw:"Database",rl:"onlineDatabase"},{raw:"Dictionary, Chemical",rl:"dictionary"},{raw:"Dictionary, Classical",rl:"dictionary"},{raw:"Dictionary, Dental",rl:"dictionary"},{raw:"Dictionary, Medical",rl:"dictionary"},{raw:"Dictionary, Pharmaceutic",rl:"dictionary"},{raw:"Dictionary, Polyglot",rl:"dictionary"},{raw:"Documentaries and Factual Films",rl:"filmOrBroadcast"},{raw:"Drawing",rl:"audioVisualMaterial"},{raw:"Ephemera",rl:"artwork"},{raw:"Eulogy",rl:"personalCommunication"},{raw:"Formulary, Dental",rl:"dataset"},{raw:"Formulary, Homeopathic",rl:"dataset"},{raw:"Formulary, Hospital",rl:"dataset"},{raw:"Formulary",rl:"dataset"},{raw:"Funeral Sermon",rl:"personalCommunication"},{raw:"Government Publication",rl:"governmentDocument"},{raw:"Graphic Novel",rl:"artwork"},{raw:"Historical Article",rl:"ancientText"},{raw:"Incunabula",rl:"ancientText"},{raw:"Incunabula",rl:"ancientText"},{raw:"Instructional Film and Video",rl:"filmOrBroadcast"},{raw:"Introductory Journal Article",rl:"journalArticle"},{raw:"Legislation",rl:"statute"},{raw:"Letter",rl:"personalCommunication"},{raw:"Manuscript, Medical",rl:"manuscript"},{raw:"Movable Books",rl:"books"},{raw:"News",rl:"newspaperArticle"},{raw:"Pharmacopoeia, Homeopathic",rl:"book"},{raw:"Pharmacopoeia",rl:"book"},{raw:"Photograph",rl:"audioVisualMaterial"},{raw:"Pictorial Work",rl:"audioVisualMaterial"},{raw:"Poetry",rl:"artwork"},{raw:"Portrait",rl:"artwork"},{raw:"Postcard",rl:"audioVisualMaterial"},{raw:"Poster",rl:"audioVisualMaterial"},{raw:"Public Service Announcement",rl:"governmentDocument"},{raw:"Research Support, N.I.H., Extramural",rl:"grant"},{raw:"Research Support, N.I.H., Intramural",rl:"grant"},{raw:"Research Support, Non-U.S. Gov't",rl:"grant"},{raw:"Research Support, U.S. Government",rl:"grant"},{raw:"Research Support, U.S. Gov't, Non-P.H.S.",rl:"grant"},{raw:"Research Support, U.S. Gov't, P.H.S.",rl:"grant"},{raw:"Resource Guide",rl:"standard"},{raw:"Retracted Publication",rl:"journalArticle"},{raw:"Retraction of Publication",rl:"journalArticle"},{raw:"Sermon",rl:"journalArticle"},{raw:"Statistics",rl:"chartOrTable"},{raw:"Study Guide",rl:"standard"},{raw:"Terminology",rl:"catalog"},{raw:"Textbook",rl:"book"},{raw:"Unedited Footage",rl:"audioVisualMaterial"},{raw:"Webcast",rl:"web"},{raw:"Wit and Humor",rl:"artwork"},{rl:"",raw:"Abbreviations"},{rl:"",raw:"Abstracts"},{rl:"",raw:"Academic Dissertation"},{rl:"",raw:"Account Book"},{rl:"",raw:"Adaptive Clinical Trial"},{rl:"",raw:"Atlas"},{rl:"",raw:"Bookplate"},{rl:"",raw:"Broadside"},{rl:"",raw:"Calendar"},{rl:"",raw:"Collected Correspondence"},{rl:"",raw:"Collected Work"},{rl:"",raw:"Collection"},{rl:"",raw:"Comment"},{rl:"",raw:"Comparative Study"},{rl:"",raw:"Congress"},{rl:"",raw:"Controlled Clinical Trial"},{rl:"",raw:"Cookbook"},{rl:"",raw:"Diary"},{rl:"",raw:"Directory"},{rl:"",raw:"Dispensatory"},{rl:"",raw:"Duplicate Publication"},{rl:"",raw:"Editorial"},{rl:"",raw:"Electronic Supplementary Materials"},{rl:"",raw:"English Abstract"},{rl:"",raw:"Equivalence Trial"},{rl:"",raw:"Essay"},{rl:"",raw:"Evaluation Study"},{rl:"",raw:"Examination Questions"},{rl:"",raw:"Exhibition"},{rl:"",raw:"Expression of Concern"},{rl:"",raw:"Festschrift"},{rl:"",raw:"Fictional Work"},{rl:"",raw:"Form"},{rl:"",raw:"legalRuleOrRegulation"},{rl:"",raw:"Guidebook"},{rl:"",raw:"Guideline"},{rl:"",raw:"Handbook"},{rl:"",raw:"Herbal"},{rl:"",raw:"Index"},{rl:"",raw:"Interactive Tutorial"},{rl:"",raw:"Interview"},{rl:"",raw:"Juvenile Literature"},{rl:"",raw:"Laboratory Manual"},{rl:"",raw:"Lecture Note"},{rl:"",raw:"Meeting Abstract"},{rl:"",raw:"Meta-Analysis"},{rl:"",raw:"Monograph"},{rl:"",raw:"Multicenter Study"},{rl:"",raw:"Nurses Instruction"},{rl:"",raw:"Observational Study"},{rl:"",raw:"Observational Study, Veterinary"},{rl:"",raw:"Outline"},{rl:"",raw:"Overall"},{rl:"",raw:"Patient Education Handout"},{rl:"",raw:"Periodical"},{rl:"",raw:"Periodical Index"},{rl:"",raw:"Personal Narrative"},{rl:"",raw:"Phrases"},{rl:"",raw:"Popular Work"},{rl:"",raw:"Practice Guideline"},{rl:"",raw:"Pragmatic Clinical Trial"},{rl:"",raw:"Price List"},{rl:"",raw:"Problems and Exercises"},{rl:"",raw:"Program"},{rl:"",raw:"Programmed Instruction"},{rl:"",raw:"Prospectus"},{rl:"",raw:"Publication Components"},{rl:"",raw:"Publication Formats"},{rl:"",raw:"Published Erratum"},{rl:"",raw:"Randomized Controlled Trial"},{rl:"",raw:"Randomized Controlled Trial, Veterinary"},{rl:"",raw:"Research Support, American Recovery and Reinvestment Act"},{rl:"",raw:"Review"},{rl:"",raw:"Scientific Integrity Review"},{rl:"",raw:"Study Characteristics"},{rl:"",raw:"Support of Research"},{rl:"",raw:"Systematic Review"},{rl:"",raw:"Twin Study"},{rl:"",raw:"Union List"},{rl:"",raw:"Validation Study"}],rawMap:new Map,rlMap:new Map}};function _C(){$e.fields.collectionOutput=$e.fields.collection.filter(r=>r.sort!==!1).sort((r,e)=>{var t,n,i,s;return((t=r.sort)!=null?t:1e3)==((n=e.sort)!=null?n:1e3)?0:((i=r.sort)!=null?i:1e3)<((s=e.sort)!=null?s:1e3)?-1:1}),$e.fields.collection.forEach(r=>{$e.fields.rlMap.set(r.rl,r),$e.fields.rawMap.set(r.raw,r)}),$e.types.collection.forEach(r=>{$e.types.rlMap.set(r.rl,r),$e.types.rawMap.set(r.raw,r)})}var Ya={};Wr(Ya,{parseRef:()=>Gh,readStream:()=>wC,setup:()=>bC,translations:()=>He,writeStream:()=>vC});function wC(r,e){let t={defaultType:"journalArticle",delimeter:"\r",...e},n=Le(),i="";return setTimeout(()=>{r.on("data",s=>{n.emit("progress",r.bytesRead),i+=s.toString();let a=0,l=/(\r\n|\n)ER\s+-\s*(\r\n|\n)/g,u;for(;u=l.exec(i);){let h=Gh(i.substring(a,u.index),t);n.emit("ref",h),a=u.index+u[0].length}i=i.substring(a)}).on("error",s=>n.emit("error",s)).on("end",()=>{i.replace(/\s+/,"")&&n.emit("ref",Gh(i,t)),n.emit("end")})}),n}function vC(r,e){let t={defaultType:"journalArticle",delimeter:"\r",...e};return{start(){return Promise.resolve()},write:n=>{var a;let i={type:t.defaultType,title:"<NO TITLE>",...n};if(n.pages){var s=(a=/^(?<_pageStart>.+?)(-(?<_pageEnd>.+))?$/.exec(n.pages))==null?void 0:a.groups;Object.assign(i,s),delete i.pages}return r.write(He.fields.collectionOutput.filter(l=>i[l.rl]).flatMap(l=>l.rl=="type"?"TY  - "+(He.types.rlMap[i.type]||"JOUR"):l.outputRepeat&&Array.isArray(i[l.rl])?i[l.rl].map(u=>`${l.raw}  - ${u}`):Array.isArray(i[l.rl])?`${l.raw}  - ${i[l.rl].join(t.delimeter)}`:`${l.raw}  - ${i[l.rl]}`).concat([`ER  - 

`]).join(`
`)),Promise.resolve()},end(){return new Promise((n,i)=>r.end(s=>s?i(s):n()))}}}function Gh(r,e){let t={},n;return r.split(/[\r\n|\n]/).forEach(i=>{var l,u;let s=(l=/^\s*(?<key>[A-Z0-9]+?)\s+-\s+(?<value>.*)$/s.exec(i))==null?void 0:l.groups;if(!s){i.replace(/\s+/,"")&&n&&(n.inputArray?t[n.rl].push(i):t[n.rl]+=e.delimeter+i);return}if(s.key=="ER")return;let a=He.fields.rawMap.get(s.key);if(a)a.rl=="type"?(t[a.rl]=((u=He.types.rawMap.get(s.value))==null?void 0:u.rl)||e.defaultType,n=a):a.inputArray?(!t[a.rl]||!Array.isArray(t[a.rl])?t[a.rl]=[s.value]:t[a.rl].push(s.value),n=a):(t[a.rl]=s.value,n=a);else{n=null;return}}),(t._pageStart||t._pageEnd)&&(t.pages=[t._pageStart,t._pageEnd].filter(Boolean).join("-"),delete t._pageStart,delete t._pageEnd),t}var He={fields:{collection:[{rl:"authors",raw:"A1",sort:!1,inputArray:!0},{rl:"authors",raw:"A2",sort:!1,inputArray:!0},{rl:"authors",raw:"A3",sort:!1,inputArray:!0},{rl:"authors",raw:"A4",sort:!1,inputArray:!0},{rl:"abstract",raw:"AB"},{rl:"address",raw:"AD"},{rl:"accessionNum",raw:"AN"},{rl:"authors",raw:"AU",sort:4,outputRepeat:!0,inputArray:!0},{rl:"custom1",raw:"C1"},{rl:"custom2",raw:"C2"},{rl:"custom3",raw:"C3"},{rl:"custom4",raw:"C4"},{rl:"custom5",raw:"C5"},{rl:"custom6",raw:"C6"},{rl:"custom7",raw:"C7"},{rl:"custom8",raw:"C8"},{rl:"caption",raw:"CA"},{rl:"fallbackCity",raw:"CY"},{rl:"date",raw:"DA"},{rl:"database",raw:"DB"},{rl:"doi",raw:"DO"},{rl:"databaseProvider",raw:"DP"},{rl:"_pageEnd",raw:"EP",sort:6},{rl:"edition",raw:"ET",sort:7},{rl:"number",raw:"IS",sort:8},{rl:"journal",raw:"J1",sort:!1},{rl:"journal",raw:"JF",sort:3},{rl:"keywords",raw:"KW",outputRepeat:!0,inputArray:!0},{rl:"urls",raw:"L1",sort:!1,inputArray:!0},{rl:"urls",raw:"L2",sort:!1,inputArray:!0},{rl:"urls",raw:"L3",sort:!1,inputArray:!0},{rl:"urls",raw:"L4",sort:!1,inputArray:!0},{rl:"language",raw:"LA"},{rl:"label",raw:"LB"},{rl:"urls",raw:"LK"},{rl:"notes",raw:"N1"},{rl:"fallbackAbstract",raw:"N2"},{rl:"publisher",raw:"PB"},{rl:"year",raw:"PY"},{rl:"isbn",raw:"SN"},{rl:"_pageStart",raw:"SP",sort:5},{rl:"title",raw:"T1",sort:!1},{rl:"journal",raw:"T2",sort:!1},{rl:"title",raw:"TI",sort:1},{rl:"type",raw:"TY",sort:0},{rl:"urls",raw:"UR",outputRepeat:!0,inputArray:!0},{rl:"volume",raw:"VL"},{rl:"date",raw:"Y1"},{rl:"accessDate",raw:"Y2"},{rl:"RISID",raw:"ID"},{rl:"RISShortTitle",raw:"ST"},{rl:"RISOriginalPublication",raw:"OP"}],collectionOutput:[],rawMap:new Map,rlMap:new Map},types:{collection:[{rl:"audioVisualMaterial",raw:"ADVS"},{rl:"journalArticle",raw:"JOUR"},{rl:"personalCommunication",raw:"PCOMM"},{rl:"filmOrBroadcast",raw:"VIDEO"},{rl:"unknown",raw:"ABST"},{rl:"aggregatedDatabase",raw:"AGGR"},{rl:"ancientText",raw:"ANCIENT"},{rl:"artwork",raw:"ART"},{rl:"bill",raw:"BILL"},{rl:"blog",raw:"BLOG"},{rl:"book",raw:"BOOK"},{rl:"case",raw:"CASE"},{rl:"bookSection",raw:"CHAP"},{rl:"chartOrTable",raw:"CHART"},{rl:"classicalWork",raw:"CLSWK"},{rl:"computerProgram",raw:"COMP"},{rl:"conferenceProceedings",raw:"CONF"},{rl:"conferencePaper",raw:"CPAPER"},{rl:"catalog",raw:"CTLG"},{rl:"dataset",raw:"DATA"},{rl:"onlineDatabase",raw:"DBASE"},{rl:"dictionary",raw:"DICT"},{rl:"electronicBook",raw:"EBOOK"},{rl:"electronicBookSection",raw:"ECHAP"},{rl:"editedBook",raw:"EDBOOK"},{rl:"electronicArticle",raw:"EJOUR"},{rl:"web",raw:"ELEC"},{rl:"encyclopedia",raw:"ENCYC"},{rl:"equation",raw:"EQUA"},{rl:"figure",raw:"FIGURE"},{rl:"generic",raw:"GEN"},{rl:"governmentDocument",raw:"GOVDOC"},{rl:"grant",raw:"GRANT"},{rl:"hearing",raw:"HEARING"},{rl:"personalCommunication",raw:"ICOMM"},{rl:"newspaperArticle",raw:"INPR"},{rl:"journalArticle",raw:"JFULL"},{rl:"legalRuleOrRegulation",raw:"LEGAL"},{rl:"manuscript",raw:"MANSCPT"},{rl:"map",raw:"MAP"},{rl:"magazineArticle",raw:"MGZN"},{rl:"filmOrBroadcast",raw:"MPCT"},{rl:"onlineMultimedia",raw:"MULTI"},{rl:"music",raw:"MUSIC"},{rl:"newspaperArticle",raw:"NEWS"},{rl:"pamphlet",raw:"PAMP"},{rl:"patent",raw:"PAT"},{rl:"report",raw:"RPRT"},{rl:"serial",raw:"SER"},{rl:"audioVisualMaterial",raw:"SLIDE"},{rl:"audioVisualMaterial",raw:"SOUND"},{rl:"standard",raw:"STAND"},{rl:"statute",raw:"STAT"},{rl:"thesis",raw:"THES"},{rl:"unpublished",raw:"UNPB"}],rawMap:new Map,rlMap:new Map}};function bC(){He.fields.collectionOutput=He.fields.collection.filter(r=>r.sort!==!1).sort((r,e)=>{var t,n,i,s;return((t=r.sort)!=null?t:1e3)==((n=e.sort)!=null?n:1e3)?0:((i=r.sort)!=null?i:1e3)<((s=e.sort)!=null?s:1e3)?-1:1}),He.fields.collection.forEach(r=>{He.fields.rlMap.set(r.rl,r),He.fields.rawMap.set(r.raw,r)}),He.types.collection.forEach(r=>{He.types.rlMap.set(r.rl,r),He.types.rawMap.set(r.raw,r)})}var Nw=new Set;function ni(r,e){if(!r)throw new Error("No module provided");let t={setup:!0,...e},n=Kh[r];if(!n)throw new Error(`Unknown module "${r}"`);return n.setup&&t.setup&&!Nw.has(r)&&(Nw.add(r),n.setup()),n}function Xa(r,e,t){if(!r)throw new Error("No module provided to parse with");if(!e)throw new Error("No stream provided to parse");return ni(r).writeStream(e,t)}function Vw(r,e){let t={filename:"References.xml",writeStreamOptions:{},promptDownload:!0,...e};return Promise.resolve().then(()=>{let n=ri(t.filename);if(!n)throw new Error(`Unsupported Reflib filename "${t.filename}"`);return n}).then(async n=>{let i=[],a=new WritableStream({write(u){i.push(u)}}).getWriter();a.end=async u=>{await a.close(),u()};let l=await Xa(n.id,a,t.writeStreamOptions);return{blobData:i,streamer:l}}).then(async({blobData:n,streamer:i})=>(await i.start(),await r.reduce((s,a)=>s.then(()=>i.write(a)),Promise.resolve()),await i.end(),n)).then(n=>new Blob(n)).then(n=>{if(!t.promptDownload)return n;let i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t.filename,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)})}function Za(r,e,t){if(!r)throw new Error("No module provided to parse with");if(!e)throw new Error("No stream provided to parse");return ni(r).readStream(e,t)}function Hh(r){if(r.getReader){let e=new Le;return Object.assign(e,{isBrowser:!0,bytesRead:0,reader:r.getReader(),textDecoder:new TextDecoder("utf-8"),read(){this.reader.read().then(({done:t,value:n})=>{if(t)e.emit("end"),this.pipeTarget&&this.pipeTarget.end();else if(n){let i=this.textDecoder.decode(n);this.bytesRead+=i.length,e.emit("data",i),this.pipeTarget&&this.pipeTarget.write(i),setTimeout(this.read.bind(this))}}).catch(t=>this.emit("error",t))},pipeTarget:null,pipe(t){return this.pipeTarget=t,this}}),setTimeout(()=>e.read()),e}else return r}function Wh(r){let e={...r};if(e.file){if(!(e.file instanceof File))throw new Error('Expected "file" setting to uploadFile() to be a File type');let t=ri(e.file.name);if(!t)throw new Error(`Unidenfified file format from filename "${e.file.name}"`);let n=[];return Promise.resolve().then(()=>e.onStart&&e.onStart(e.file)).then(()=>new Promise((i,s)=>{let a=Za(t.id,Hh(e.file.stream()),{...e,size:e.file.size}).on("end",()=>i(n)).on("error",l=>s(l)).on("ref",l=>n.push(l));e.onProgress&&a.on("progress",e.onProgress)})).then(()=>e.onEnd&&e.onEnd()).then(()=>n)}else return new Promise(t=>{let n=document.createElement("div");n.style.display="none",document.body.appendChild(n);let i=document.createElement("input");i.type="file",i.accept=Object.values(ti).flatMap(s=>s.ext).join(","),i.addEventListener("change",s=>{document.body.removeChild(n),t(Wh({file:s.target.files[0],...r}))}),n.appendChild(i),i.dispatchEvent(new MouseEvent("click"))})}function Lw(r){if(r.doi){let e="https://dx.doi.org/";return r.doi.startsWith(e)&&(r.doi=r.doi.slice(e.length)),r.doi}return null}var Mw={downloadFile:Vw,formats:ti,getModule:ni,identifyFormat:ri,readStream:Za,uploadFile:Wh,writeStream:Xa,getRefDoi:Lw};var Ie=[];for(let r=0;r<256;++r)Ie.push((r+256).toString(16).slice(1));function Fw(r,e=0){return(Ie[r[e+0]]+Ie[r[e+1]]+Ie[r[e+2]]+Ie[r[e+3]]+"-"+Ie[r[e+4]]+Ie[r[e+5]]+"-"+Ie[r[e+6]]+Ie[r[e+7]]+"-"+Ie[r[e+8]]+Ie[r[e+9]]+"-"+Ie[r[e+10]]+Ie[r[e+11]]+Ie[r[e+12]]+Ie[r[e+13]]+Ie[r[e+14]]+Ie[r[e+15]]).toLowerCase()}var Qh,TC=new Uint8Array(16);function Jh(){if(!Qh){if(typeof crypto=="undefined"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Qh=crypto.getRandomValues.bind(crypto)}return Qh(TC)}var EC=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yh={randomUUID:EC};function IC(r,e,t){var i,s,a;if(Yh.randomUUID&&!e&&!r)return Yh.randomUUID();r=r||{};let n=(a=(s=r.random)!=null?s:(i=r.rng)==null?void 0:i.call(r))!=null?a:Jh();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let l=0;l<16;++l)e[t+l]=n[l];return e}return Fw(n)}var Xh=IC;var le=class le{constructor(e,t){oe(this,"path");oe(this,"docRef");oe(this,"value");oe(this,"throttle",250);oe(this,"config",{heartbeatInterval:5e4,syncWorkerUrl:"https://tera-tools.com/api/sync",context:{}});oe(this,"isDirty",!1);oe(this,"_destroyActions",[]);oe(this,"_heartbeatTimer");this.path=e,Object.assign(this,{...t,config:{...this.config,...t==null?void 0:t.config}}),le.session||(le.session=`syncro_${qh()}`)}debug(...e){}destroy(){return this.debug("Destroy!"),Promise.all(this._destroyActions.map(e=>e())).then(()=>this._destroyActions=[])}getReactive(e){console.warn("Syncro.getReactive has not been subclassed, assuming a POJO response");let t={...e};return{doc:t,setState(n){Object.entries(n||{}).forEach(([i,s])=>t[i]=s)},getState(){return Zt(t)},watch(n){}}}static pathSplit(e,t){var a;let n={allowAsterisk:!1,...t},s={...(a=new RegExp("^(?<entity>\\w+?)::(?<id>[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:::(?<relation>[\\w\\-"+(n.allowAsterisk?"\\*":"")+"]+?))?$").exec(e))==null?void 0:a.groups};if(!s)throw new Error(`Invalid session path syntax "${e}"`);if(!(s.entity in Zh))throw new Error(`Unsupported entity "${e}" -> Entity="${s.entity}"`);return{...s,fsCollection:s.entity,fsId:s.relation?`${s.id}::${s.relation}`:s.id}}static toFirestore(e={}){return xs.serialize(e,{circular:!1,clone:!0,modules:[jw,...xs.settings.modules],stringify:!1})}static fromFirestore(e={}){return xs.deserialize(e,{circular:!1,clone:!0,modules:[jw,...xs.settings.modules],destringify:!1})}static fromFirestoreFields(e={}){let t={};for(let n in e){let i=e[n];if(["stringValue","booleanValue","doubleValue","integerValue","timestampValue","mapValue","arrayValue"].find(a=>a===n)){if(["stringValue","booleanValue","doubleValue","integerValue","timestampValue"].find(l=>l===n))return i;if(n=="mapValue")return le.fromFirestoreFields(i.fields||{});if(n=="arrayValue"){let l=i.values;return l?l.map(u=>le.fromFirestoreFields(u)):[]}}else t[n]=le.fromFirestoreFields(i)}return t}static getSnapshot(e){let{fsCollection:t,fsId:n}=le.pathSplit(e);return Promise.resolve().then(async()=>ph(Ia(le.firestore,t,n))).then(i=>i?le.fromFirestore(i.data()):null)}static setSnapshot(e,t,n){let i={method:"merge",...n},{fsCollection:s,fsId:a}=le.pathSplit(e);return Promise.resolve().then(()=>(i.method=="merge"?"FirestoreUpdateDoc":"FirestoreSetDoc")(Ia(le.firestore,s,a),le.toFirestore(t))).then(()=>t)}static wrapSupabase(e){return Promise.resolve(e).then(t=>{var n,i;if(t!=null&&t.error)throw/JSON object requested, multiple \(or no\) rows returned$/.test(t.error.message)?(console.warn("Supabase query threw record not found against query",e.url.search),console.warn("Supabase raw error",t),new Error("NOT-FOUND")):(console.warn("Supabase query threw",t.error.message),new Error(`${((n=t.error)==null?void 0:n.code)||"UnknownError"}: ${((i=t.error)==null?void 0:i.message)||"Unknown Supabase error"}`));if(t.data)return t.data})}mount(e){let t={initialState:null,...e},{fsCollection:n,fsId:i,entity:s,id:a,relation:l}=le.pathSplit(this.path),u,h;return Promise.resolve().then(()=>this.setHeartbeat(!1)).then(async()=>{this.docRef=Ia(le.firestore,n,i);let f=await this.getFirestoreState();if(u=this.getReactive(f),!u.doc||!u.setState||!u.getState||!u.watch)throw new Error("Syncro.getReactive() requires a returned `doc`, `setState()`, `getState()` + `watch()`");this.value=h=u.doc,this.debug("Initial state",{doc:h}),this._destroyActions.push(g_(this.docRef,m=>{let g=le.fromFirestore(m.data());this.debug("Incoming snapshot",{snapshotData:g}),u.setState(g)}))}).then(()=>{if(kl(h))return t.initialState?(this.debug("Populate initial Syncro state (from provided initialState)"),this.setFirestoreState(t.initialState,{method:"set"})):(this.debug(`Populate initial Syncro state (from "${s}" entity)`),Promise.resolve().then(()=>Zh[s]||Promise.reject(`Unknown Sync entity "${s}"`)).then(()=>Zh[s].initState({supabase:le.supabase,fsCollection:n,fsId:i,entity:s,id:a,relation:l,...this.config.context})).then(f=>this.setFirestoreState(f,{method:"set"})))}).then(()=>{u.watch(Nl(f=>{this.debug("Local change",{newState:f}),this.markDirty(),this.setFirestoreState(f,{method:"merge"})},this.throttle))}).then(()=>this.setHeartbeat(!0,{immediate:!0})).then(()=>this)}setHeartbeat(e=!0,t){let n={immediate:!0,...t};clearTimeout(this._heartbeatTimer),e&&(this._heartbeatTimer=setTimeout(async()=>{await this.heartbeat(),e&&this.setHeartbeat(!0)},this.config.heartbeatInterval),n.immediate&&this.heartbeat())}async heartbeat(){this.debug("heartbeat!"),await fetch(`${this.config.syncWorkerUrl}/${this.path}/heartbeat`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:le.session,...this.isDirty&&{dirty:!0}})}).then(e=>e.ok?null:console.warn(this.path,`Heartbeat failed - ${e.statusText}`,{response:e})).then(()=>this.isDirty=!1)}setFirestoreState(e,t){let n={method:"merge",...t};if(!this.docRef)throw new Error("mount() must be called before setting Firestore state");return(n.method=="set"?p_:m_)(this.docRef,le.toFirestore(e))}getFirestoreState(){if(!this.docRef)throw new Error("mount() must be called before getting Firestore state");return ph(this.docRef).then(e=>le.fromFirestore(e.data()))}markDirty(){return this.isDirty=!0,this}flush(e){let t={destroy:!1,...e};return fetch(`${this.config.syncWorkerUrl}/${this.path}/flush`+(t.destroy?"?destroy=1":"")).then(n=>n.ok?null:Promise.reject(n.statusText||"An error occured"))}};oe(le,"firebase"),oe(le,"firestore"),oe(le,"supabase"),oe(le,"session");var _e=le;var Zh={projects:{singular:"project",async initState({supabase:r,id:e,tera:t}){if(!t)throw new Error("initState() for projects requires `{tera:Object}`");let n=await _e.wrapSupabase(r.from("projects").select("data").limit(1).eq("id",e));if(n.length!==1)throw new Error(`Syncro project "${e}" not found`);let i=n[0].data;if(console.log("[MIGRATION] State of temp at start:",i.temp),!i.temp)return i;let s=!1;for(let a in i.temp){if(typeof i.temp[a]!="object"){console.log(`[MIGRATION] Skipping conversion of ${a}, not an object:`,i.temp[a]);return}s||(s=!0,console.log("[MIGRATION] showing alert"),alert("Data found that will be migrated to new TERA file storage system. This may take a few minutes, please do not close your browser or refresh."));let u=`data-${a.split("-")[0]}-${qh()}.json`;console.log("[MIGRATION] Creating filename:",u);let h=await t.createProjectFile(u);console.log("[MIGRATION] Setting file contents:",h,"to:",i.temp[a]),await h.setContents(i.temp[a]),console.log("[MIGRATION] Overwriting temp key with filepath:",u),i.temp[a]=u}return console.log("[MIGRATION] State of temp at end:",i.temp),i},flushState({supabase:r,state:e,fsId:t}){return _e.wrapSupabase(r.rpc("syncro_merge_data",{table_name:"projects",entity_id:t,new_data:e}))}},project_libraries:{singular:"project library",initState({supabase:r,id:e,relation:t}){if(!t||!/_\*$/.test(t))throw new Error('Project library relation missing, path should resemble "project_library::${PROJECT}::${LIBRARY_FILE_ID}_*"');let n=t.replace(/_\*$/,"");return Promise.resolve().then(()=>_e.wrapSupabase(r.storage.from("projects").list(e))).then(i=>i.find(s=>s.id==n)).then(i=>i||Promise.reject(`Invalid file ID "${n}"`)).then(i=>_e.wrapSupabase(r.storage.from("projects").download(`${e}/${i.name}`)).then(s=>({blob:s,file:i}))).then(({blob:i,file:s})=>Mw.uploadFile({file:new File([i],s.name.replace(/^.*[/\\]/,""))})).then(i=>Object.fromEntries(i.map(s=>[Xh(),s])))},flushState({supabase:r,id:e,relation:t}){throw new Error("Flushing project_libraries::* namespace is not yet supported")}},project_namespaces:{singular:"project namespace",initState({supabase:r,id:e,relation:t}){if(!t)throw new Error('Project namespace relation missing, path should resemble "project_namespaces::${PROJECT}::${RELATION}"');return _e.wrapSupabase(r.from("project_namespaces").select("data").limit(1).eq("project",e).eq("name",t)).then(n=>n.length==1?n[0]:_e.wrapSupabase(r.from("project_namespaces").insert({project:e,name:t,data:{}}).select("data"))).then(n=>n.data)},flushState({supabase:r,state:e,id:t,relation:n}){return _e.wrapSupabase(r.from("project_namespaces").update({edited_at:new Date,data:e}).eq("project",t).eq("name",n))}},test:{singular:"test",initState({supabase:r,id:e}){return _e.wrapSupabase(r.from("test").select("data").limit(1).eq("id",e)).then(t=>t.length==1?t[0]:Promise.reject(`Syncro test item "${e}" not found`)).then(t=>t.data)},flushState({supabase:r,state:e,fsId:t}){return _e.wrapSupabase(r.rpc("syncro_merge_data",{table_name:"test",entity_id:t,new_data:e}))}},users:{singular:"user",initState({supabase:r,id:e}){return _e.wrapSupabase(r.from("users").select("data").limit(1).eq("id",e)).then(t=>t.length==1?t[0]:Promise.reject(`Syncro user "${e}" not found`)).then(t=>t.data)},flushState({supabase:r,state:e,fsId:t}){return _e.wrapSupabase(r.rpc("syncro_merge_data",{table_name:"users",entity_id:t,new_data:e}))}}},jw={id:"~array",recursive:!0,test:r=>Array.isArray(r),serialize:r=>({_:"~array",...r}),deserialize:r=>{let e=Array.from({length:Object.keys(r).length-1});return Object.entries(r).filter(([t])=>t!=="_").forEach(([t,n])=>e[+t]=n),e}};var Cs=class{init(){}constructor(e,t){}};var ks=class extends Cs{constructor(){super(...arguments);oe(this,"syncros",{})}async init(t){let n={firebaseApiKey:null,firebaseAuthDomain:null,firebaseProjectId:null,firebaseAppId:null,supabaseUrl:null,supabaseKey:null,...await this.getCredentials(),...t},i=Object.keys(n).filter(s=>s===null);if(i.length>0)throw new Error("Firebase plugin requires mandatory options: "+i.join(", "));_e.firebase=Zl({apiKey:n.firebaseApiKey,authDomain:n.firebaseAuthDomain,projectId:n.firebaseProjectId,appId:n.firebaseAppId}),_e.firestore=a_(this.firebase),_e.supabase=Tw(n.supabaseUrl,n.supabaseKey)}_mountNamespace(t){let n;return Promise.resolve().then(()=>this.requireProject()).then(i=>{let s=t=="_PROJECT"?`projects::${i.id}`:`project_namespaces::${i.id}::${t}`;return n=this.syncros[t]=new _e(s,{debug:(...a)=>this.debug(`SYNCRO://${s}`,...a),getReactive:this.getReactive}),n.mount()}).then(()=>{this.namespaces[t]=n.value})}_unmountNamespace(t){let n=this.syncros[t];return delete this.namespaces[t],delete this.syncros[t],n.destroy()}};var ed=class extends ks{constructor(){super(...arguments);oe(this,"Vue");oe(this,"project",null);oe(this,"reactiveId",1001)}async init(t){let n={app:null,Vue:null,globalName:"$tera",...t};if(!n.Vue)throw new Error("Vue instance to use must be specified in init options as `Vue`");if(this.Vue=n.Vue,!n.app)throw new Error("Vue Root / App instance to use must be specified in init options as `app`");this.app=n.app,n.globalName&&(this.Vue.prototype[n.globalName]=this),await super.init(n),this.project=await this.mountNamespace("_PROJECT")}getReactive(t){let n=this.Vue.observable(t),i=`_teraFy_${this.reactiveId++}`;return this.app[i]=n,{doc:n,setState(s){Object.entries(s||{}).filter(([a])=>!Dl(n[a],s[a])).forEach(([a,l])=>n[a]=l)},getState(){return Zt(n)},watch:s=>{this.app.$watch(i,s,{deep:!0})}}}};export{ed as default};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/component/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/logger/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/webchannel-wrapper/dist/bloom-blob/esm/bloom_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/webchannel-wrapper/dist/webchannel-blob/esm/webchannel_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law | agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
