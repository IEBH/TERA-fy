var fr=Object.defineProperty;var sr=(t,e,r)=>e in t?fr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var H=(t,e,r)=>(sr(t,typeof e!="symbol"?e+"":e,r),r);var pr=typeof global=="object"&&global&&global.Object===Object&&global,$=pr;var ir=typeof self=="object"&&self&&self.Object===Object&&self,nr=$||ir||Function("return this")(),u=nr;var ur=u.Symbol,h=ur;var Ot=Object.prototype,mr=Ot.hasOwnProperty,lr=Ot.toString,K=h?h.toStringTag:void 0;function dr(t){var e=mr.call(t,K),r=t[K];try{t[K]=void 0;var o=!0}catch{}var a=lr.call(t);return o&&(e?t[K]=r:delete t[K]),a}var At=dr;var cr=Object.prototype,xr=cr.toString;function gr(t){return xr.call(t)}var wt=gr;var hr="[object Null]",yr="[object Undefined]",St=h?h.toStringTag:void 0;function br(t){return t==null?t===void 0?yr:hr:St&&St in Object(t)?At(t):wt(t)}var y=br;function jr(t){return t!=null&&typeof t=="object"}var x=jr;var vr=Array.isArray,E=vr;function Tr(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var g=Tr;var _r="[object AsyncFunction]",Or="[object Function]",Ar="[object GeneratorFunction]",wr="[object Proxy]";function Sr(t){if(!g(t))return!1;var e=y(t);return e==Or||e==Ar||e==_r||e==wr}var k=Sr;var Ir=u["__core-js_shared__"],J=Ir;var It=function(){var t=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Pr(t){return!!It&&It in t}var Pt=Pr;var Cr=Function.prototype,Er=Cr.toString;function Br(t){if(t!=null){try{return Er.call(t)}catch{}try{return t+""}catch{}}return""}var b=Br;var Lr=/[\\^$.*+?()[\]{}|]/g,Mr=/^\[object .+?Constructor\]$/,Dr=Function.prototype,Nr=Object.prototype,Fr=Dr.toString,Ur=Nr.hasOwnProperty,Rr=RegExp("^"+Fr.call(Ur).replace(Lr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Vr(t){if(!g(t)||Pt(t))return!1;var e=k(t)?Rr:Mr;return e.test(b(t))}var Ct=Vr;function Gr(t,e){return t==null?void 0:t[e]}var Et=Gr;function Wr(t,e){var r=Et(t,e);return Ct(r)?r:void 0}var d=Wr;var Kr=d(u,"WeakMap"),Y=Kr;var Bt=Object.create,zr=function(){function t(){}return function(e){if(!g(e))return{};if(Bt)return Bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Lt=zr;function qr(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var Mt=qr;var Hr=function(){try{var t=d(Object,"defineProperty");return t({},"",{}),t}catch{}}(),xt=Hr;function $r(t,e){for(var r=-1,o=t==null?0:t.length;++r<o&&e(t[r],r,t)!==!1;);return t}var Dt=$r;var kr=9007199254740991,Jr=/^(?:0|[1-9]\d*)$/;function Yr(t,e){var r=typeof t;return e=e==null?kr:e,!!e&&(r=="number"||r!="symbol"&&Jr.test(t))&&t>-1&&t%1==0&&t<e}var Nt=Yr;function Xr(t,e,r){e=="__proto__"&&xt?xt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var X=Xr;function Zr(t,e){return t===e||t!==t&&e!==e}var Z=Zr;var Qr=Object.prototype,to=Qr.hasOwnProperty;function eo(t,e,r){var o=t[e];(!(to.call(t,e)&&Z(o,r))||r===void 0&&!(e in t))&&X(t,e,r)}var Q=eo;function ro(t,e,r,o){var a=!r;r||(r={});for(var p=-1,s=e.length;++p<s;){var f=e[p],m=o?o(r[f],t[f],f,r,t):void 0;m===void 0&&(m=t[f]),a?X(r,f,m):Q(r,f,m)}return r}var O=ro;var oo=9007199254740991;function ao(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=oo}var tt=ao;function fo(t){return t!=null&&tt(t.length)&&!k(t)}var et=fo;var so=Object.prototype;function po(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||so;return t===r}var B=po;function io(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var Ft=io;var no="[object Arguments]";function uo(t){return x(t)&&y(t)==no}var gt=uo;var Ut=Object.prototype,mo=Ut.hasOwnProperty,lo=Ut.propertyIsEnumerable,co=gt(function(){return arguments}())?gt:function(t){return x(t)&&mo.call(t,"callee")&&!lo.call(t,"callee")},Rt=co;function xo(){return!1}var Vt=xo;var Kt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gt=Kt&&typeof module=="object"&&module&&!module.nodeType&&module,go=Gt&&Gt.exports===Kt,Wt=go?u.Buffer:void 0,ho=Wt?Wt.isBuffer:void 0,yo=ho||Vt,rt=yo;var bo="[object Arguments]",jo="[object Array]",vo="[object Boolean]",To="[object Date]",_o="[object Error]",Oo="[object Function]",Ao="[object Map]",wo="[object Number]",So="[object Object]",Io="[object RegExp]",Po="[object Set]",Co="[object String]",Eo="[object WeakMap]",Bo="[object ArrayBuffer]",Lo="[object DataView]",Mo="[object Float32Array]",Do="[object Float64Array]",No="[object Int8Array]",Fo="[object Int16Array]",Uo="[object Int32Array]",Ro="[object Uint8Array]",Vo="[object Uint8ClampedArray]",Go="[object Uint16Array]",Wo="[object Uint32Array]",n={};n[Mo]=n[Do]=n[No]=n[Fo]=n[Uo]=n[Ro]=n[Vo]=n[Go]=n[Wo]=!0;n[bo]=n[jo]=n[Bo]=n[vo]=n[Lo]=n[To]=n[_o]=n[Oo]=n[Ao]=n[wo]=n[So]=n[Io]=n[Po]=n[Co]=n[Eo]=!1;function Ko(t){return x(t)&&tt(t.length)&&!!n[y(t)]}var zt=Ko;function zo(t){return function(e){return t(e)}}var L=zo;var qt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,z=qt&&typeof module=="object"&&module&&!module.nodeType&&module,qo=z&&z.exports===qt,ht=qo&&$.process,Ho=function(){try{var t=z&&z.require&&z.require("util").types;return t||ht&&ht.binding&&ht.binding("util")}catch{}}(),j=Ho;var Ht=j&&j.isTypedArray,$o=Ht?L(Ht):zt,$t=$o;var ko=Object.prototype,Jo=ko.hasOwnProperty;function Yo(t,e){var r=E(t),o=!r&&Rt(t),a=!r&&!o&&rt(t),p=!r&&!o&&!a&&$t(t),s=r||o||a||p,f=s?Ft(t.length,String):[],m=f.length;for(var l in t)(e||Jo.call(t,l))&&!(s&&(l=="length"||a&&(l=="offset"||l=="parent")||p&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Nt(l,m)))&&f.push(l);return f}var ot=Yo;function Xo(t,e){return function(r){return t(e(r))}}var at=Xo;var Zo=at(Object.keys,Object),kt=Zo;var Qo=Object.prototype,ta=Qo.hasOwnProperty;function ea(t){if(!B(t))return kt(t);var e=[];for(var r in Object(t))ta.call(t,r)&&r!="constructor"&&e.push(r);return e}var Jt=ea;function ra(t){return et(t)?ot(t):Jt(t)}var M=ra;function oa(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Yt=oa;var aa=Object.prototype,fa=aa.hasOwnProperty;function sa(t){if(!g(t))return Yt(t);var e=B(t),r=[];for(var o in t)o=="constructor"&&(e||!fa.call(t,o))||r.push(o);return r}var Xt=sa;function pa(t){return et(t)?ot(t,!0):Xt(t)}var D=pa;var ia=d(Object,"create"),v=ia;function na(){this.__data__=v?v(null):{},this.size=0}var Zt=na;function ua(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Qt=ua;var ma="__lodash_hash_undefined__",la=Object.prototype,da=la.hasOwnProperty;function ca(t){var e=this.__data__;if(v){var r=e[t];return r===ma?void 0:r}return da.call(e,t)?e[t]:void 0}var te=ca;var xa=Object.prototype,ga=xa.hasOwnProperty;function ha(t){var e=this.__data__;return v?e[t]!==void 0:ga.call(e,t)}var ee=ha;var ya="__lodash_hash_undefined__";function ba(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=v&&e===void 0?ya:e,this}var re=ba;function N(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}N.prototype.clear=Zt;N.prototype.delete=Qt;N.prototype.get=te;N.prototype.has=ee;N.prototype.set=re;var yt=N;function ja(){this.__data__=[],this.size=0}var oe=ja;function va(t,e){for(var r=t.length;r--;)if(Z(t[r][0],e))return r;return-1}var A=va;var Ta=Array.prototype,_a=Ta.splice;function Oa(t){var e=this.__data__,r=A(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():_a.call(e,r,1),--this.size,!0}var ae=Oa;function Aa(t){var e=this.__data__,r=A(e,t);return r<0?void 0:e[r][1]}var fe=Aa;function wa(t){return A(this.__data__,t)>-1}var se=wa;function Sa(t,e){var r=this.__data__,o=A(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var pe=Sa;function F(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}F.prototype.clear=oe;F.prototype.delete=ae;F.prototype.get=fe;F.prototype.has=se;F.prototype.set=pe;var w=F;var Ia=d(u,"Map"),S=Ia;function Pa(){this.size=0,this.__data__={hash:new yt,map:new(S||w),string:new yt}}var ie=Pa;function Ca(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var ne=Ca;function Ea(t,e){var r=t.__data__;return ne(e)?r[typeof e=="string"?"string":"hash"]:r.map}var I=Ea;function Ba(t){var e=I(this,t).delete(t);return this.size-=e?1:0,e}var ue=Ba;function La(t){return I(this,t).get(t)}var me=La;function Ma(t){return I(this,t).has(t)}var le=Ma;function Da(t,e){var r=I(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var de=Da;function U(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}U.prototype.clear=ie;U.prototype.delete=ue;U.prototype.get=me;U.prototype.has=le;U.prototype.set=de;var ce=U;function Na(t,e){for(var r=-1,o=e.length,a=t.length;++r<o;)t[a+r]=e[r];return t}var ft=Na;var Fa=at(Object.getPrototypeOf,Object),st=Fa;function Ua(){this.__data__=new w,this.size=0}var xe=Ua;function Ra(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ge=Ra;function Va(t){return this.__data__.get(t)}var he=Va;function Ga(t){return this.__data__.has(t)}var ye=Ga;var Wa=200;function Ka(t,e){var r=this.__data__;if(r instanceof w){var o=r.__data__;if(!S||o.length<Wa-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new ce(o)}return r.set(t,e),this.size=r.size,this}var be=Ka;function R(t){var e=this.__data__=new w(t);this.size=e.size}R.prototype.clear=xe;R.prototype.delete=ge;R.prototype.get=he;R.prototype.has=ye;R.prototype.set=be;var je=R;function za(t,e){return t&&O(e,M(e),t)}var ve=za;function qa(t,e){return t&&O(e,D(e),t)}var Te=qa;var we=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_e=we&&typeof module=="object"&&module&&!module.nodeType&&module,Ha=_e&&_e.exports===we,Oe=Ha?u.Buffer:void 0,Ae=Oe?Oe.allocUnsafe:void 0;function $a(t,e){if(e)return t.slice();var r=t.length,o=Ae?Ae(r):new t.constructor(r);return t.copy(o),o}var Se=$a;function ka(t,e){for(var r=-1,o=t==null?0:t.length,a=0,p=[];++r<o;){var s=t[r];e(s,r,t)&&(p[a++]=s)}return p}var Ie=ka;function Ja(){return[]}var pt=Ja;var Ya=Object.prototype,Xa=Ya.propertyIsEnumerable,Pe=Object.getOwnPropertySymbols,Za=Pe?function(t){return t==null?[]:(t=Object(t),Ie(Pe(t),function(e){return Xa.call(t,e)}))}:pt,V=Za;function Qa(t,e){return O(t,V(t),e)}var Ce=Qa;var tf=Object.getOwnPropertySymbols,ef=tf?function(t){for(var e=[];t;)ft(e,V(t)),t=st(t);return e}:pt,it=ef;function rf(t,e){return O(t,it(t),e)}var Ee=rf;function of(t,e,r){var o=e(t);return E(t)?o:ft(o,r(t))}var nt=of;function af(t){return nt(t,M,V)}var Be=af;function ff(t){return nt(t,D,it)}var Le=ff;var sf=d(u,"DataView"),ut=sf;var pf=d(u,"Promise"),mt=pf;var nf=d(u,"Set"),lt=nf;var Me="[object Map]",uf="[object Object]",De="[object Promise]",Ne="[object Set]",Fe="[object WeakMap]",Ue="[object DataView]",mf=b(ut),lf=b(S),df=b(mt),cf=b(lt),xf=b(Y),C=y;(ut&&C(new ut(new ArrayBuffer(1)))!=Ue||S&&C(new S)!=Me||mt&&C(mt.resolve())!=De||lt&&C(new lt)!=Ne||Y&&C(new Y)!=Fe)&&(C=function(t){var e=y(t),r=e==uf?t.constructor:void 0,o=r?b(r):"";if(o)switch(o){case mf:return Ue;case lf:return Me;case df:return De;case cf:return Ne;case xf:return Fe}return e});var G=C;var gf=Object.prototype,hf=gf.hasOwnProperty;function yf(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&hf.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Re=yf;var bf=u.Uint8Array,bt=bf;function jf(t){var e=new t.constructor(t.byteLength);return new bt(e).set(new bt(t)),e}var W=jf;function vf(t,e){var r=e?W(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Ve=vf;var Tf=/\w*$/;function _f(t){var e=new t.constructor(t.source,Tf.exec(t));return e.lastIndex=t.lastIndex,e}var Ge=_f;var We=h?h.prototype:void 0,Ke=We?We.valueOf:void 0;function Of(t){return Ke?Object(Ke.call(t)):{}}var ze=Of;function Af(t,e){var r=e?W(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var qe=Af;var wf="[object Boolean]",Sf="[object Date]",If="[object Map]",Pf="[object Number]",Cf="[object RegExp]",Ef="[object Set]",Bf="[object String]",Lf="[object Symbol]",Mf="[object ArrayBuffer]",Df="[object DataView]",Nf="[object Float32Array]",Ff="[object Float64Array]",Uf="[object Int8Array]",Rf="[object Int16Array]",Vf="[object Int32Array]",Gf="[object Uint8Array]",Wf="[object Uint8ClampedArray]",Kf="[object Uint16Array]",zf="[object Uint32Array]";function qf(t,e,r){var o=t.constructor;switch(e){case Mf:return W(t);case wf:case Sf:return new o(+t);case Df:return Ve(t,r);case Nf:case Ff:case Uf:case Rf:case Vf:case Gf:case Wf:case Kf:case zf:return qe(t,r);case If:return new o;case Pf:case Bf:return new o(t);case Cf:return Ge(t);case Ef:return new o;case Lf:return ze(t)}}var He=qf;function Hf(t){return typeof t.constructor=="function"&&!B(t)?Lt(st(t)):{}}var $e=Hf;var $f="[object Map]";function kf(t){return x(t)&&G(t)==$f}var ke=kf;var Je=j&&j.isMap,Jf=Je?L(Je):ke,Ye=Jf;var Yf="[object Set]";function Xf(t){return x(t)&&G(t)==Yf}var Xe=Xf;var Ze=j&&j.isSet,Zf=Ze?L(Ze):Xe,Qe=Zf;var Qf=1,ts=2,es=4,tr="[object Arguments]",rs="[object Array]",os="[object Boolean]",as="[object Date]",fs="[object Error]",er="[object Function]",ss="[object GeneratorFunction]",ps="[object Map]",is="[object Number]",rr="[object Object]",ns="[object RegExp]",us="[object Set]",ms="[object String]",ls="[object Symbol]",ds="[object WeakMap]",cs="[object ArrayBuffer]",xs="[object DataView]",gs="[object Float32Array]",hs="[object Float64Array]",ys="[object Int8Array]",bs="[object Int16Array]",js="[object Int32Array]",vs="[object Uint8Array]",Ts="[object Uint8ClampedArray]",_s="[object Uint16Array]",Os="[object Uint32Array]",i={};i[tr]=i[rs]=i[cs]=i[xs]=i[os]=i[as]=i[gs]=i[hs]=i[ys]=i[bs]=i[js]=i[ps]=i[is]=i[rr]=i[ns]=i[us]=i[ms]=i[ls]=i[vs]=i[Ts]=i[_s]=i[Os]=!0;i[fs]=i[er]=i[ds]=!1;function dt(t,e,r,o,a,p){var s,f=e&Qf,m=e&ts,l=e&es;if(r&&(s=a?r(t,o,a,p):r(t)),s!==void 0)return s;if(!g(t))return t;var T=E(t);if(T){if(s=Re(t),!f)return Mt(t,s)}else{var c=G(t),vt=c==er||c==ss;if(rt(t))return Se(t,f);if(c==rr||c==tr||vt&&!a){if(s=m||vt?{}:$e(t),!f)return m?Ee(t,Te(s,t)):Ce(t,ve(s,t))}else{if(!i[c])return a?t:{};s=He(t,c,f)}}p||(p=new je);var Tt=p.get(t);if(Tt)return Tt;p.set(t,s),Qe(t)?t.forEach(function(_){s.add(dt(_,e,r,_,t,p))}):Ye(t)&&t.forEach(function(_,P){s.set(P,dt(_,e,r,P,t,p))});var ar=l?m?Le:Be:m?D:M,_t=T?void 0:ar(t);return Dt(_t||t,function(_,P){_t&&(P=_,_=t[P]),Q(s,P,dt(_,e,r,P,t,p))}),s}var or=dt;var As=1,ws=4;function Ss(t){return or(t,As|ws)}var ct=Ss;var q=class{init(){}constructor(e,r){}};var jt=class extends q{constructor(){super(...arguments);H(this,"Vue");H(this,"projects");H(this,"state",null)}bindProjectState(r){let o={component:null,componentKey:null,autoRequire:!0,write:!0,...r};return Promise.resolve().then(()=>Promise.all([this.getProjectState({autoRequire:o.autoRequire}),(()=>{if(!o.componentKey){for(let a=0;a<50;a++){let p=`terafy_${a}`;if(!Object.hasOwnProperty(o.component,p)){o.componentKey=p;return}}throw new Error("Unable to find unique key to allocate against Vue2 component")}})()])).then(([a])=>{this.debug("Got project snapshot",a);let p=this.Vue.observable(a);o.component[o.componentKey]=p;let s=0;if(o.read&&this.events.on(`update:projects/${p.id}`,f=>{s++,Object.assign(p,f)}),o.write){if(!o.component)throw new Error("bindProjectState requires a VueComponent specified as `component`");let f=ct(a);o.component.$watch(o.componentKey,m=>{if(s>0){s--;return}this.createProjectStatePatch(m,f),f=ct(a)},{deep:!0})}return p})}init(r){let o={app:null,Vue:null,globalName:"$tera",requireProject:!0,subscribeState:!0,subscribeProjects:!0,stateOptions:{read:!0,write:!0},...r};if(!o.Vue)throw new Error("Vue instance to use must be specified in init options as `Vue`");if(this.Vue=r.Vue,!this.settings.app)throw new Error("Need to specify the root level Vue2 app during init");return o.stateOptions.app=this.settings.app,this.projects=this.Vue.observable([]),o.globalName&&(this.Vue.prototype[o.globalName]=this),this.state=null,Promise.resolve().then(()=>o.requireProject&&this.requireProject()).then(()=>Promise.all([o.subscribeState&&this.bindProjectState({...o.stateOptions,component:this.settings.app.$root}).then(a=>this.state=a).then(()=>this.debug("INFO","Loaded project state",this.state)),o.subscribeProjects&&this.getProjects().then(a=>this.projects=this.Vue.observable(a)).then(()=>this.debug("INFO","Loaded projects",this.projects))]))}_pathSet(r,o,a,p){if(typeof r!="object")throw new Error("Cannot use _pathSet on non-object target");let s={arrayNumeric:!0,debug:!1,removeUndefined:!0,...p};s.debug&&console.log("[_pathSet]",o,"=",a,{target:r,options:p});let f=r;if(!o)throw new Error("Cannot _pathSet with undefined path");return(typeof o=="string"?o.split("."):o).some((m,l,T)=>{if(l==T.length-1)s.removeUndefined&&a===void 0?this.Vue.$delete(f,m):this.Vue.set(f,m,a);else return f[m]===void 0?(T.slice(l,T.length-1).forEach(c=>{s.arrayNumeric&&isFinite(c)?this.Vue.set(f,c,[]):this.Vue.set(f,c,{}),f=f[c]}),this.Vue.set(f,T[T.length-1],a),!0):(f=f[m],!1)}),a}};export{jt as default};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
