var Se=typeof global=="object"&&global&&global.Object===Object&&global,N=Se;var Pe=typeof self=="object"&&self&&self.Object===Object&&self,Ee=N||Pe||Function("return this")(),d=Ee;var Me=d.Symbol,_=Me;var ft=Object.prototype,De=ft.hasOwnProperty,Re=ft.toString,M=_?_.toStringTag:void 0;function Be(t){var e=De.call(t,M),r=t[M];try{t[M]=void 0;var o=!0}catch{}var a=Re.call(t);return o&&(e?t[M]=r:delete t[M]),a}var st=Be;var Le=Object.prototype,Fe=Le.toString;function Ne(t){return Fe.call(t)}var pt=Ne;var ze="[object Null]",We="[object Undefined]",it=_?_.toStringTag:void 0;function Ue(t){return t==null?t===void 0?We:ze:it&&it in Object(t)?st(t):pt(t)}var h=Ue;function Ge(t){return t!=null&&typeof t=="object"}var x=Ge;var He=Array.isArray,D=He;function qe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var u=qe;function $e(t){return t}var z=$e;var Ke="[object AsyncFunction]",Ve="[object Function]",ke="[object GeneratorFunction]",Ye="[object Proxy]";function Je(t){if(!u(t))return!1;var e=h(t);return e==Ve||e==ke||e==Ke||e==Ye}var O=Je;var Xe=d["__core-js_shared__"],W=Xe;var nt=function(){var t=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ze(t){return!!nt&&nt in t}var ut=Ze;var Qe=Function.prototype,tr=Qe.toString;function er(t){if(t!=null){try{return tr.call(t)}catch{}try{return t+""}catch{}}return""}var lt=er;var rr=/[\\^$.*+?()[\]{}|]/g,or=/^\[object .+?Constructor\]$/,ar=Function.prototype,fr=Object.prototype,sr=ar.toString,pr=fr.hasOwnProperty,ir=RegExp("^"+sr.call(pr).replace(rr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function nr(t){if(!u(t)||ut(t))return!1;var e=O(t)?ir:or;return e.test(lt(t))}var mt=nr;function ur(t,e){return t?.[e]}var dt=ur;function lr(t,e){var r=dt(t,e);return mt(r)?r:void 0}var T=lr;var xt=Object.create,mr=function(){function t(){}return function(e){if(!u(e))return{};if(xt)return xt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),ct=mr;function dr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var ht=dr;function xr(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var gt=xr;var cr=800,hr=16,gr=Date.now;function yr(t){var e=0,r=0;return function(){var o=gr(),a=hr-(o-r);if(r=o,a>0){if(++e>=cr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var yt=yr;function br(t){return function(){return t}}var bt=br;var vr=function(){try{var t=T(Object,"defineProperty");return t({},"",{}),t}catch{}}(),j=vr;var _r=j?function(t,e){return j(t,"toString",{configurable:!0,enumerable:!1,value:bt(e),writable:!0})}:z,vt=_r;var Or=yt(vt),_t=Or;var Tr=9007199254740991,jr=/^(?:0|[1-9]\d*)$/;function wr(t,e){var r=typeof t;return e=e??Tr,!!e&&(r=="number"||r!="symbol"&&jr.test(t))&&t>-1&&t%1==0&&t<e}var U=wr;function Ar(t,e,r){e=="__proto__"&&j?j(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var w=Ar;function Ir(t,e){return t===e||t!==t&&e!==e}var g=Ir;var Cr=Object.prototype,Sr=Cr.hasOwnProperty;function Pr(t,e,r){var o=t[e];(!(Sr.call(t,e)&&g(o,r))||r===void 0&&!(e in t))&&w(t,e,r)}var Ot=Pr;function Er(t,e,r,o){var a=!r;r||(r={});for(var s=-1,p=e.length;++s<p;){var f=e[s],n=o?o(r[f],t[f],f,r,t):void 0;n===void 0&&(n=t[f]),a?w(r,f,n):Ot(r,f,n)}return r}var Tt=Er;var jt=Math.max;function Mr(t,e,r){return e=jt(e===void 0?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=jt(o.length-e,0),p=Array(s);++a<s;)p[a]=o[e+a];a=-1;for(var f=Array(e+1);++a<e;)f[a]=o[a];return f[e]=r(p),ht(t,this,f)}}var wt=Mr;function Dr(t,e){return _t(wt(t,e,z),t+"")}var At=Dr;var Rr=9007199254740991;function Br(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Rr}var G=Br;function Lr(t){return t!=null&&G(t.length)&&!O(t)}var A=Lr;function Fr(t,e,r){if(!u(r))return!1;var o=typeof e;return(o=="number"?A(r)&&U(e,r.length):o=="string"&&e in r)?g(r[e],t):!1}var It=Fr;function Nr(t){return At(function(e,r){var o=-1,a=r.length,s=a>1?r[a-1]:void 0,p=a>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(a--,s):void 0,p&&It(r[0],r[1],p)&&(s=a<3?void 0:s,a=1),e=Object(e);++o<a;){var f=r[o];f&&t(e,f,o,s)}return e})}var Ct=Nr;var zr=Object.prototype;function Wr(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||zr;return t===r}var H=Wr;function Ur(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var St=Ur;var Gr="[object Arguments]";function Hr(t){return x(t)&&h(t)==Gr}var Z=Hr;var Pt=Object.prototype,qr=Pt.hasOwnProperty,$r=Pt.propertyIsEnumerable,Kr=Z(function(){return arguments}())?Z:function(t){return x(t)&&qr.call(t,"callee")&&!$r.call(t,"callee")},R=Kr;function Vr(){return!1}var Et=Vr;var Rt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mt=Rt&&typeof module=="object"&&module&&!module.nodeType&&module,kr=Mt&&Mt.exports===Rt,Dt=kr?d.Buffer:void 0,Yr=Dt?Dt.isBuffer:void 0,Jr=Yr||Et,q=Jr;var Xr="[object Arguments]",Zr="[object Array]",Qr="[object Boolean]",to="[object Date]",eo="[object Error]",ro="[object Function]",oo="[object Map]",ao="[object Number]",fo="[object Object]",so="[object RegExp]",po="[object Set]",io="[object String]",no="[object WeakMap]",uo="[object ArrayBuffer]",lo="[object DataView]",mo="[object Float32Array]",xo="[object Float64Array]",co="[object Int8Array]",ho="[object Int16Array]",go="[object Int32Array]",yo="[object Uint8Array]",bo="[object Uint8ClampedArray]",vo="[object Uint16Array]",_o="[object Uint32Array]",i={};i[mo]=i[xo]=i[co]=i[ho]=i[go]=i[yo]=i[bo]=i[vo]=i[_o]=!0;i[Xr]=i[Zr]=i[uo]=i[Qr]=i[lo]=i[to]=i[eo]=i[ro]=i[oo]=i[ao]=i[fo]=i[so]=i[po]=i[io]=i[no]=!1;function Oo(t){return x(t)&&G(t.length)&&!!i[h(t)]}var Bt=Oo;function To(t){return function(e){return t(e)}}var Lt=To;var Ft=typeof exports=="object"&&exports&&!exports.nodeType&&exports,B=Ft&&typeof module=="object"&&module&&!module.nodeType&&module,jo=B&&B.exports===Ft,Q=jo&&N.process,wo=function(){try{var t=B&&B.require&&B.require("util").types;return t||Q&&Q.binding&&Q.binding("util")}catch{}}(),tt=wo;var Nt=tt&&tt.isTypedArray,Ao=Nt?Lt(Nt):Bt,$=Ao;var Io=Object.prototype,Co=Io.hasOwnProperty;function So(t,e){var r=D(t),o=!r&&R(t),a=!r&&!o&&q(t),s=!r&&!o&&!a&&$(t),p=r||o||a||s,f=p?St(t.length,String):[],n=f.length;for(var m in t)(e||Co.call(t,m))&&!(p&&(m=="length"||a&&(m=="offset"||m=="parent")||s&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||U(m,n)))&&f.push(m);return f}var zt=So;function Po(t,e){return function(r){return t(e(r))}}var Wt=Po;function Eo(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Ut=Eo;var Mo=Object.prototype,Do=Mo.hasOwnProperty;function Ro(t){if(!u(t))return Ut(t);var e=H(t),r=[];for(var o in t)o=="constructor"&&(e||!Do.call(t,o))||r.push(o);return r}var Gt=Ro;function Bo(t){return A(t)?zt(t,!0):Gt(t)}var K=Bo;var Lo=T(Object,"create"),c=Lo;function Fo(){this.__data__=c?c(null):{},this.size=0}var Ht=Fo;function No(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var qt=No;var zo="__lodash_hash_undefined__",Wo=Object.prototype,Uo=Wo.hasOwnProperty;function Go(t){var e=this.__data__;if(c){var r=e[t];return r===zo?void 0:r}return Uo.call(e,t)?e[t]:void 0}var $t=Go;var Ho=Object.prototype,qo=Ho.hasOwnProperty;function $o(t){var e=this.__data__;return c?e[t]!==void 0:qo.call(e,t)}var Kt=$o;var Ko="__lodash_hash_undefined__";function Vo(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=c&&e===void 0?Ko:e,this}var Vt=Vo;function I(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}I.prototype.clear=Ht;I.prototype.delete=qt;I.prototype.get=$t;I.prototype.has=Kt;I.prototype.set=Vt;var et=I;function ko(){this.__data__=[],this.size=0}var kt=ko;function Yo(t,e){for(var r=t.length;r--;)if(g(t[r][0],e))return r;return-1}var y=Yo;var Jo=Array.prototype,Xo=Jo.splice;function Zo(t){var e=this.__data__,r=y(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():Xo.call(e,r,1),--this.size,!0}var Yt=Zo;function Qo(t){var e=this.__data__,r=y(e,t);return r<0?void 0:e[r][1]}var Jt=Qo;function ta(t){return y(this.__data__,t)>-1}var Xt=ta;function ea(t,e){var r=this.__data__,o=y(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var Zt=ea;function C(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}C.prototype.clear=kt;C.prototype.delete=Yt;C.prototype.get=Jt;C.prototype.has=Xt;C.prototype.set=Zt;var b=C;var ra=T(d,"Map"),V=ra;function oa(){this.size=0,this.__data__={hash:new et,map:new(V||b),string:new et}}var Qt=oa;function aa(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var te=aa;function fa(t,e){var r=t.__data__;return te(e)?r[typeof e=="string"?"string":"hash"]:r.map}var v=fa;function sa(t){var e=v(this,t).delete(t);return this.size-=e?1:0,e}var ee=sa;function pa(t){return v(this,t).get(t)}var re=pa;function ia(t){return v(this,t).has(t)}var oe=ia;function na(t,e){var r=v(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var ae=na;function S(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}S.prototype.clear=Qt;S.prototype.delete=ee;S.prototype.get=re;S.prototype.has=oe;S.prototype.set=ae;var fe=S;var ua=Wt(Object.getPrototypeOf,Object),k=ua;var la="[object Object]",ma=Function.prototype,da=Object.prototype,se=ma.toString,xa=da.hasOwnProperty,ca=se.call(Object);function ha(t){if(!x(t)||h(t)!=la)return!1;var e=k(t);if(e===null)return!0;var r=xa.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&se.call(r)==ca}var pe=ha;function ga(){this.__data__=new b,this.size=0}var ie=ga;function ya(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ne=ya;function ba(t){return this.__data__.get(t)}var ue=ba;function va(t){return this.__data__.has(t)}var le=va;var _a=200;function Oa(t,e){var r=this.__data__;if(r instanceof b){var o=r.__data__;if(!V||o.length<_a-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new fe(o)}return r.set(t,e),this.size=r.size,this}var me=Oa;function P(t){var e=this.__data__=new b(t);this.size=e.size}P.prototype.clear=ie;P.prototype.delete=ne;P.prototype.get=ue;P.prototype.has=le;P.prototype.set=me;var de=P;var ge=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xe=ge&&typeof module=="object"&&module&&!module.nodeType&&module,Ta=xe&&xe.exports===ge,ce=Ta?d.Buffer:void 0,he=ce?ce.allocUnsafe:void 0;function ja(t,e){if(e)return t.slice();var r=t.length,o=he?he(r):new t.constructor(r);return t.copy(o),o}var ye=ja;var wa=d.Uint8Array,rt=wa;function Aa(t){var e=new t.constructor(t.byteLength);return new rt(e).set(new rt(t)),e}var be=Aa;function Ia(t,e){var r=e?be(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var ve=Ia;function Ca(t){return typeof t.constructor=="function"&&!H(t)?ct(k(t)):{}}var _e=Ca;function Sa(t){return function(e,r,o){for(var a=-1,s=Object(e),p=o(e),f=p.length;f--;){var n=p[t?f:++a];if(r(s[n],n,s)===!1)break}return e}}var Oe=Sa;var Pa=Oe(),Te=Pa;function Ea(t,e,r){(r!==void 0&&!g(t[e],r)||r===void 0&&!(e in t))&&w(t,e,r)}var L=Ea;function Ma(t){return x(t)&&A(t)}var je=Ma;function Da(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var F=Da;function Ra(t){return Tt(t,K(t))}var we=Ra;function Ba(t,e,r,o,a,s,p){var f=F(t,r),n=F(e,r),m=p.get(n);if(m){L(t,r,m);return}var l=s?s(f,n,r+"",t,e,p):void 0,E=l===void 0;if(E){var J=D(n),X=!J&&q(n),at=!J&&!X&&$(n);l=n,J||X||at?D(f)?l=f:je(f)?l=gt(f):X?(E=!1,l=ye(n,!0)):at?(E=!1,l=ve(n,!0)):l=[]:pe(n)||R(n)?(l=f,R(f)?l=we(f):(!u(f)||O(f))&&(l=_e(n))):E=!1}E&&(p.set(n,l),a(l,n,o,s,p),p.delete(n)),L(t,r,l)}var Ae=Ba;function Ie(t,e,r,o,a){t!==e&&Te(e,function(s,p){if(a||(a=new de),u(s))Ae(t,e,p,r,Ie,o,a);else{var f=o?o(F(t,p),s,p+"",t,e,a):void 0;f===void 0&&(f=s),L(t,p,f)}},K)}var Ce=Ie;var La=Ct(function(t,e,r){Ce(t,e,r)}),Y=La;var ot=class{settings={client:"tera-fy",clientType:"esm"};init(e){let r=o=>`https://dev.tera-tools.com/api/tera-fy/${o}.js`;return Promise.resolve().then(()=>this.settings.clientType=="esm"?this.bootstrapperImport(r(this.settings.client)).then(o=>typeof o=="function"?o:Promise.reject("Tera-fy import didn't return a class")):Promise.reject(`Unsupported TERA-fy clientType "${this.settings.clientType}"`)).then(o=>{let a=new o;if(!a.mixin)throw new Error("TERA-fy client doesnt expose a mixin() method");a.mixin(this,a),Y(this.settings,a.settings,this.settings)}).then(()=>{if(console.log("IAM",this),!this.init||typeof this.init!="function")throw new Error("Newly mixed-in TERA-fy client doesnt expose a init() method");if(!this.detectMode||typeof this.detectMode!="function")throw new Error("Newly mixed-in TERA-fy client doesnt expose a detectMode() method")}).then(()=>this.bootstrapperDeferredMethods.reduce((o,a)=>a.method=="use"&&typeof a.args[0]=="string"?(console.log("TERA-FY DEFERRED-USE",a.args[0]),this.bootstrapperImport(r(a.args[0])).then(s=>typeof s=="function"?s:Promise.reject("Tera-fy plugin import didn't return a class")).then(s=>this.use(s,...a.args.slice(1)))):(console.log("TERA-FY DEFERRED-METHOD",a),this[a.method].apply(this,a.args))),Promise.resolve()).then(()=>delete this.bootstrapperDeferredMethods).then(()=>console.log("TYBS","Init")).then(()=>this.init.call(this,e))}bootstrapperDeferredMethods=[];bootstrapperImport(e){return new Promise((r,o)=>{let a=`installTFyBS${Math.random().toString(36).slice(2)}`,s=document.createElement("script");s.type="module",s.textContent=`
				import mod from '${e}';
				window['installMod${a}'](mod);
			`;let p=()=>console.warn("CLEANUP",a);window[`installMod${a}`]=f=>{console.log("Accept module from",e,"=",f),r(f),p()},s.onerror=f=>{console.log("post onerror",window[a]),o(new Error(`Failed to load module from ${e}`)),p()},document.head.appendChild(s)})}constructor(e){e&&Y(this.settings,e),["set","setIfDev","use"].forEach(r=>{this[r]=(...o)=>(this.bootstrapperDeferredMethods.push({method:r,args:o}),this)})}};export{ot as default};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
